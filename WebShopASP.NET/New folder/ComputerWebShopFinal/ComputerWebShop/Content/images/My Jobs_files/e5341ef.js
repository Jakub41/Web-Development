EOL.namespace("myjobs.panel");EOL.myjobs.panel.isRunning=false;EOL.myjobs.panel.open=function(e,c,b){if(EOL.myjobs.panel.isRunning){return}if($("panelProjectId").value){if($("panelAddNewTag")&&$("panelAddNewTag").value){EOL.myjobs.panel.addTagProcess($("panelProjectId").value)}}if(e){var a=$("projectCard"+e);$("panelTitle").set("text",a.getElement("a.title").get("title"));$("panelTitle").set("href",a.getElement("a.title").get("href"));$("panelProjectId").value=e;$("panelProjectType").value=c;$$("#myjobs-results .dashboard-card").each(function(f){if($(f).hasClass("selected")){EOL.dashboard.card.unselect($(f))}});EOL.dashboard.card.select(a);if(a.get("haspmb")=="no"){$("pmbPanelTab").hide()}else{$("pmbPanelTab").show()}if(!b){if(a.get("haspmb")=="yes"){b="pmb"}else{b="summary"}}EOL.myjobs.panel.load(b)}if(b=="broadcast"){EOL.myjobs.panel.load(b)}if($("dashboard-panel").isDisplayed()){return}if($("bulkMsgPanel").isDisplayed()){$("broadcastToggle").hide();$("broadcastToggleInactive").show()}else{$("broadcastToggle").show();$("broadcastToggleInactive").hide()}document.body.style.overflowX="hidden";$("dashboard-panel").setStyle("left",window.getSize().x+"px");$("dashboard-panel").show();EOL.myjobs.panel.resize();var d=new Fx.Tween("dashboard-panel",{duration:500,transition:Fx.Transitions.Expo.easeOut,onComplete:function(){document.body.style.overflowX="auto";window.addEvent("scroll",EOL.myjobs.panel.resize);$$(".widget").each(function(f){f.hide()});EOL.myjobs.panel.isRunning=false}});EOL.myjobs.panel.isRunning=true;d.start("left",($("dashboard-header").offsetLeft-20)+590)};EOL.myjobs.panel.resize=function(){if($("dashboard-header").style.position=="fixed"){var a=0}else{var a=window.getScroll().y}var b=a+window.getSize().y-$("dashboard-panel").getPosition().y-30-10;$("dashboard-panel").setStyle("height",b+"px");var c=$("dashboard-panel").getSize().y-$("jobPanelTop").getSize().y-40;if(c>0){$("dashboard-panel-content").setStyle("height",c+"px");$("bulkMsgPanel").setStyle("height",c+"px")}};EOL.myjobs.panel.close=function(){if(EOL.myjobs.panel.isRunning){return}$$(".widget").each(function(b){b.show()});document.body.style.overflowX="hidden";var a=new Fx.Tween("dashboard-panel",{duration:500,onComplete:function(){$("dashboard-panel").hide();document.body.style.overflowX="auto";window.removeEvent("scroll",EOL.myjobs.panel.resize);EOL.myjobs.panel.isRunning=false}});EOL.myjobs.panel.isRunning=true;a.start("left",window.getSize().x);$$("#myjobs-results .dashboard-card").each(function(b){EOL.dashboard.card.unselect($(b))});$("multi-toggle").removeClass("checked");$("broadcastToggle").removeClass("broadcastOpen");$("panelProjectId").value="";$("panelProjectType").value="";$("broadcastToggle").show();$("broadcastToggleInactive").hide()};EOL.myjobs.panel.req=null;EOL.myjobs.panel.load=function(d){if(EOL.myjobs.panel.req&&EOL.myjobs.panel.req.isRunning()){EOL.myjobs.panel.req.cancel()}$("dashboard-panel-content").setStyle("opacity",0);$("dashboard-panel-loader").show();$("jobPanel").show();$("bulkPanel").hide();$("broadcastPanel").hide();var a=$("panelProjectId").value;var e=$("panelProjectType").value;switch(d){case"pmb":var b="/sf/dashboard/pmb?bidid="+a;var c="pmbPanelTab";$el("send","useraction","VIEW","jobInfoPanelMessages",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{bidid:a}});break;case"tag":var b="/sf/myjobs/panel/tag?projectid="+a+"&projecttype="+e;var c="tagPanelTab";$el("send","useraction","VIEW","jobInfoPanelTags",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{bidid:a}});break;case"broadcast":break;default:d="summary";var b="/sf/myjobs/panel/summary?projectid="+a+"&projecttype="+e;var c="summaryPanelTab";$el("send","useraction","VIEW","jobInfoPanelOverview",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{bidid:a}});break}if(d=="broadcast"){$("jobPanel").hide();$("broadcastPanel").show();$("bulkMsgPanel").hide();return}$$("#panelTabs li").each(function(f){if(f.id==c){f.addClass("selected")}else{f.removeClass("selected")}});$$("#panelTabsFilter > div").each(function(f){f.hide()});EOL.myjobs.panel.req=new Request({url:b,method:"GET",noCache:true,onSuccess:function(f){f=JSON.decode(f);$("dashboard-panel-loader").hide();$("dashboard-panel-content").getChildren().destroy();$("dashboard-panel-content").innerHTML=f.html;new Fx.Tween("dashboard-panel-content",{duration:200}).start("opacity",1);$(d+"PanelFilter").show();if(d=="summary"){EOL.myjobs.panel.pageTracker=1;$("summary-status").set("html",f.status);$("summaryActionMenu").set("html",$(a+"ActionMenu").get("html"));$("dashboard-panel-content").getElements(".eol-select").each(function(g){var h=g.id;new EOL.dashboard.select(g.id,function(j){var k="mode=ChangeProjectValue";k+="&type="+$("panelProjectType").value;k+="&projectId="+$("panelProjectId").value;k+="&valueId="+j;k+="&id="+h;var i=new Request({url:"/php/preferences/main/udfAHR.php?"+k,method:"GET",noCache:true}).send()})})}else{if(d=="tag"){$("tagCount").set("html",f.tagCount);if($("tagCount").get("text")==1){$("tagOrTags").set("text","tag")}else{$("tagOrTags").set("text","tags")}if(f.tags&&f.tags.length>0){EOL.myjobs.panel.loadTags(f.tags);$("panelTags").style.display=""}else{$("noTagsState").style.display=""}}else{if(d=="pmb"){$$(".messageText").each(function(g){EOL.myjobs.panel.formatPmbMessage(g)});if($("projectCard"+a).getElement(".pmbCount")){$("projectCard"+a).getElement(".pmbCount").hide()}EOL.dashboard.collab.index=1}}}}});EOL.myjobs.panel.req.send()};EOL.myjobs.panel.formatPmbMessage=function(a){var b=a.getProperty("elancemessage");var c=a.get("html");a.set("html",c.collabHtmlEnc(b=="Y"))};EOL.myjobs.panel.loadTags=function(a){a.each(function(b){EOL.myjobs.panel.loadTag(b.id,b.text)})};EOL.myjobs.panel.loadTag=function(e,d){d=d.trim();if(!EOL.myjobs.panel.verifyNewTag(d)){return}var b=$("tagTemplate").clone(true,true);b.id=e;var a=b.getChildren("ul")[0].getChildren("li")[0];a.innerHTML+=d;a.set("text",d.truncate(30,"..."));a.set("tagid",e);a.id="w-"+e;a.inject($("panelTags"),"top");a.addEvent("click",function(f){EOL.myjobs.results.showJobsByTag(f.target.get("tagid"))});var c=new Element("a",{id:e+"l",href:"javascript:void(0);","class":"textboxlist-bit-box-deletebutton",events:{click:function(){EOL.myjobs.panel.deleteTag(e)}},title:"Remove tag"});c.inject(a);$("panelAddNewTag").value="";$("panelAddNewTagLi").style.display="none";$("panelAddTag").style.display=""};EOL.myjobs.panel.deleteTag=function(id){if($(id+"l").hasClass("deleting")){return}$(id+"l").addClass("deleting");var handleTagRemoveSuccess=function(req){var response=eval("("+req+")");if(response.status=="success"){$("w-"+id).style.display="none";if($("display"+$("panelProjectId").value+id)){$("display"+$("panelProjectId").value+id).style.display="none"}var tagNo=$("tagCount").get("html")-1;$("tagCount").set("html",(tagNo>=0)?tagNo:0);if($("tagCount").get("text")==1){$("tagOrTags").set("text","tag")}else{$("tagOrTags").set("text","tags")}}else{var form=new EOL.framework.form.async();form.showErrors(response,"Please correct the following")}};var mode;var params;switch($("panelProjectType").value){case"job":mode="RemoveJobTags";params="&jobIds="+$("panelProjectId").value;break;case"bid":mode="RemoveBidTags";params="&bidIds="+$("panelProjectId").value;break}var url="/php/myelance/main/dashboardAHR.php?mode="+mode+"&t="+getDateTime()+"&tagId="+id+params;var options={url:url,method:"post",onSuccess:handleTagRemoveSuccess,onComplete:function(){EOL.cloud.asyncProcessingInsert=false},onFailure:function(){alert("There was an error processing your request. Please refresh and try again.")}};curAsyncReq=new Request(options);curAsyncReq.send()};EOL.myjobs.panel.addTagProcess=function(projectId){var newTag=$("panelAddNewTag").get("value").trim();if(EOL.myjobs.panel.verifyNewTag(newTag)){if(!projectId){projectId=$("panelProjectId").value}var projectType=$("projectCard"+projectId)?$("projectCard"+projectId).get("projecttype"):$("panelProjectType").value;$("panelAddNewTag").set("value","");$("panelAddNewTagLi").style.display="none";$("panelAddTag").style.display="block";var handleTagSubmitSuccess=function(req){var response=eval("("+req+")");if(response.status=="success"){var tagNo=$("tagCount").get("html");$("tagCount").set("html",parseInt(tagNo)+1);if($("tagCount").get("text")==1){$("tagOrTags").set("text","tag")}else{$("tagOrTags").set("text","tags")}if(!response.data){var form=new EOL.framework.form.async();response.errorMsgs=Array("This project already has same tag assigned.");form.showErrors(response,"Please correct the following")}else{if(response.data.text){EOL.cloud.tag.displayTag(projectType,projectId,response.data.id,response.data.text);EOL.myjobs.panel.loadTag(response.data.id,response.data.text);EOL.cloud.tag.displayTag("user","user",response.data.id,response.data.text);EOL.myjobs.setTagViewMode(false);if(!EOL.myjobs.tagListCotains(response.data.text)){EOL.cloud.tagList.push({identifier:response.data.id,value:response.data.text})}$("noToolbarTags").hide();$("cloudlist").show()}}}else{var form=new EOL.framework.form.async();form.showErrors(response,"Please correct the following")}};var params="";switch(projectType){case"job":params="&jobIds="+projectId;break;case"bid":params="&bidIds="+projectId;break}var url="/php/myelance/main/dashboardAHR.php?mode=CreateTags&t="+getDateTime()+params+"&text="+encodeURIComponent(newTag);var options={url:url,method:"post",onSuccess:handleTagSubmitSuccess,onComplete:function(){EOL.cloud.asyncProcessingInsert=false},onFailure:function(){alert("There was an error processing your request. Please refresh and try again.")}};curAsyncReq=new Request(options);curAsyncReq.send()}};EOL.myjobs.panel.multiselect=function(b){while(!b.hasClass("dashboard-card")){b=b.getParent()}if(EOL.dashboard.card.isSelected(b)){EOL.dashboard.card.unselect(b);EOL.myjobs.panel.showBulk();var a=$$("#myjobs-results .dashboard-card.selected");if(!a.length){EOL.myjobs.panel.close();return}if(a.length==1&&a.get("projecttype")!="folders"){if(EOL.myjobs.results.curStatusFilter=="draft"){EOL.myjobs.panel.showBulk();return}EOL.myjobs.panel.open(a.get("projectid"),a.get("projecttype"));$("jobPanel").show();$("bulkPanel").hide();$("broadcastPanel").hide()}else{$el("send","useraction","CLICK","bulkSelect",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{items:a.length}})}return}EOL.dashboard.card.select(b);$el("send","useraction","CLICK","bulkSelect",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{items:$$("#myjobs-results .dashboard-card.selected").length}});EOL.myjobs.panel.showBulk()};EOL.myjobs.panel.showBulk=function(){EOL.myjobs.actions.resetErrors();var d=$$("#myjobs-results .dashboard-card.selected");var b=d.length;b+=(b==1)?" Item Selected":" Items Selected";var a=false;var c=false;d.each(function(e){if(e.get("projecttype")=="folders"){a=true}if(e.get("archive")=="yes"){c=true}});$("bulkPanelTitle").set("html",b);if(EOL.myjobs.results.curStatusFilter=="archived"){$("bulkarchive").hide();if(folderEditable){$("bulkunarchive").show("inline-block");$("bulkdelete").show("inline-block")}else{$("bulkunarchive").hide();$("bulkdelete").hide()}$("bulkmessage").hide();$("bulkfolder").hide()}else{if(EOL.myjobs.results.curStatusFilter=="draft"){$("bulkarchive").hide();$("bulkunarchive").hide();if(folderEditable){$("bulkdelete").show("inline-block")}else{$("bulkdelete").hide()}$("bulkmessage").hide();$("bulkfolder").hide()}else{if(folderEditable||(!folderEditable&&c)){$("bulkarchive").show("inline-block")}else{$("bulkarchive").hide()}if(draggable){$("bulkfolder").show("inline-block")}else{$("bulkfolder").hide()}$("bulkunarchive").hide();$("bulkdelete").hide();$("bulkmessage").show("inline-block")}}if(!$("bulkPanel").isDisplayed()){$("bulkPanelButtons").style.display="";$("bulkMsgPanel").style.display="none";$("bulkMsgTitle").style.display="none";$("bulkPanelTitle").removeClass("smallerTitle")}$("bulkPanelButtons").style.display="";$("bulkMsgPanel").style.display="none";$("bulkMsgTitle").style.display="none";$("bulkPanelTitle").removeClass("smallerTitle");$("jobPanel").hide();$("bulkPanel").show();$("broadcastPanel").hide();$el("send","useraction","VIEW","bulkPanel",{userId:getCookie("userid"),pageName:"MyJobs"})};EOL.myjobs.panel.displayAdd=function(){$("panelAddNewTagLi").style.display="block";$("panelAddTag").style.display="none";window.addEvent("select",EOL.cloud.tag.panelSuggest($("panelProjectId").get("html")));setTimeout("$('panelAddNewTag').focus()",200)};EOL.myjobs.panel.verifyNewTag=function(b){b=b.trim();if(!b&&!b.length){return}var a=$("panelTags").getElements(".tag-item").get("text");if(a.contains(b)){return}return true};EOL.myjobs.panel.clickUserTagHandler=function(b){var a=$("panelAddNewTag").get("value").trim();if(EOL.myjobs.panel.verifyNewTag(a)){EOL.cloud.tag.panelAdd(b)}};EOL.myjobs.panel.pageTracker=1;EOL.myjobs.panel.page=function(page){if(EOL.myjobs.panel.isRunning){return}if(!EOL.myjobs.panel.pageTracker){EOL.myjobs.panel.pageTracker=1}if(EOL.myjobs.panel.pageTracker==page){return}var maxPage=$("summaryMilestonePages").value;var width=302;var elem=$("summary-milestonelist");var curPos=elem.getStyle("left");curPos=curPos.substr(0,curPos.indexOf("px"));var offset,newPage;if(page=="next"){offset=parseInt(curPos)-width;newPage=EOL.myjobs.panel.pageTracker+1}else{if(page=="prev"){offset=parseInt(curPos)+width;newPage=EOL.myjobs.panel.pageTracker-1}else{offset=(page-1)*width*-1;newPage=page}}if(offset>0||newPage>maxPage){return}var pageElem=$("milestones-pagination");if(newPage>1){pageElem.getElement(".arrowLeft").removeClass("disabled")}else{if(newPage<=1){pageElem.getElement(".arrowLeft").addClass("disabled")}}if(newPage<maxPage){pageElem.getElement(".arrowRight").removeClass("disabled")}else{if(newPage>=maxPage){pageElem.getElement(".arrowRight").addClass("disabled")}}pageElem.getElements(".milestone-page").each(function(pElem,index){if(index+1==newPage){pElem.addClass("activeTab")}else{pElem.removeClass("activeTab")}});EOL.myjobs.panel.pageTracker=newPage;EOL.myjobs.panel.isRunning=true;new Fx.Tween("summary-milestonelist",{duration:200,onComplete:function(){EOL.myjobs.panel.isRunning=false}}).start("left",offset);var activePage=$$(".milestonepage")[newPage-1];if(!activePage.get("loaded")){var projectid=$("panelProjectId").value;var url="/sf/myjobs/milestones?projectid="+projectid+"&page="+newPage;var request=new Request({url:url,method:"GET",noCache:true,onSuccess:function(result){result=eval("("+result+")");if(result.html){activePage.set("html",result.html);activePage.set("loaded",1)}},onFailure:function(){alert("There was an error processing your request. Please refresh and try again.")}});request.send()}};EOL.namespace("myjobs.results");EOL.myjobs.results.curPage=1;EOL.myjobs.results.curStatusFilter="";EOL.myjobs.results.curContextFilter="";EOL.myjobs.results.curKeywords="";EOL.myjobs.results.curFolder="";EOL.myjobs.results.request=null;EOL.myjobs.results.numDisplayed=0;EOL.myjobs.results.numTotal=0;EOL.myjobs.results.numNext=0;EOL.myjobs.results.callback=null;EOL.myjobs.results.get=function(d,g,c,b,f){if(EOL.myjobs.results.request!=null&&EOL.myjobs.results.request.isRunning()){return}if(!d){d=1}if(!g){g=""}if(!c){c=""}if(!b){b=""}if(!f){f=""}if(d==1){window.scrollTo(0,0);$("myjobs-loader").show();$("myjobs-loadmore").hide();$("myjobs-results").empty();EOL.myjobs.panel.close();if(g=="draft"){$("dashboard-header-content").getElement(".search").fade("out");$("tagsToggle").fade("out")}else{if($("dashboard-header-content").getElement(".search").getStyle("opacity")==0){$("dashboard-header-content").getElement(".search").fade("in");$("tagsToggle").fade("in")}}}$("loadmore-loading").show();var e="page="+d;e+="&statusFilter="+g;e+="&contextFilter="+c;e+="&keywords="+encodeURIComponent(b);e+="&folderid="+f;e+="&listStyle="+$$("input[name=listStyleChoice]:checked").get("value");var a=(g=="draft")?"/sf/myjobs/results/draft?":"/sf/myjobs/results?";EOL.myjobs.results.request=new Request({url:a+e,method:"GET",noCache:true,onSuccess:function(h){var h=JSON.decode(h);EOL.myjobs.results.curPage=d;EOL.myjobs.results.curStatusFilter=g;EOL.myjobs.results.curContextFilter=c;EOL.myjobs.results.curKeywords=b;EOL.myjobs.results.curFolder=f;$("myjobs-loader").hide();if(h.numNext<=0){$("myjobs-loadmore").hide()}else{if(d==1){$("myjobs-loadmore").show();$("myjobs-loader").hide()}var i=h.numDisplayed+" of "+h.totalResults.format()+' items | <a href="javascript:void(0);">Load more</a>';$("loadmore-text").set("html",i);$("loadmore-loading").hide()}EOL.myjobs.results.numDisplayed=h.numDisplayed;EOL.myjobs.results.numNext=h.numNext;EOL.myjobs.results.numTotal=h.totalResults;EOL.myjobs.results.create(d,h.html);EOL.myjobs.results.checkOnboardingEventMessage(h.onboardingJobs);if(EOL.myjobs.results.numTotal){if($("mjSearchCloudBtn")){$("mjSearchCloudBtn").addEvent("click",function(){_gaq.push(["_trackEvent","PTC_MyJobs","ClickBtn","SearchCloudExperienced"])})}}else{if($("mjSearchCloudBtn")){$("mjSearchCloudBtn").addEvent("click",function(){_gaq.push(["_trackEvent","PTC_MyJobs","ClickBtn","SearchCloudNewUser"])})}}if(f){if(d==1&&h.folder){$("folder-title").set("html",h.folder.folderName.truncate(80,"..."));$("myjobs-folder-info").show()}}else{$("myjobs-folder-info").hide()}if(EOL.myjobs.results.callback){EOL.myjobs.results.callback.apply();EOL.myjobs.results.callback=null}}});EOL.myjobs.results.request.send();EOL.myjobs.resizeSearchBar()};EOL.myjobs.results.checkOnboardingEventMessage=function(a){a.each(function(h){var b=h.jobId;var d=h.freelancerId;var i=h.userType;var f=h.bidId;var c="/sf/onboarding/"+b+"/pendingTasks/"+d;var g={userType:i,bidId:f};var e=new Request.JSON({method:"get",url:c,data:g,onSuccess:function(k){if(k.showMsg){if($("projectCard"+f)){var j=$("projectCard"+f).getElement("div.alerts");if(!j){var j=new Element("div.alerts");$("projectCard"+f).getElement("div.info").grab(j)}Elements.from(k.html).inject(j)}}}}).send()})};EOL.myjobs.results.create=function(f,b){var d="";var e=new Element("div",{id:"page-"+f});e.set("html",b);e.setStyle("opacity",0);e.getElements(".dashboard-card").each(function(g){$(g).addEvent("click",function(i){var h=$(i.target);while(!h.hasClass("dashboard-card")){h=h.getParent()}if($(i.target).hasClass("checkbox")||$(i.target).hasClass("bulk")){if(EOL.myjobs.panel.isRunning){return}if($$("#myjobs-results .dashboard-card.selected").length||h.get("hasPanel")=="no"){if(!$("dashboard-panel").isDisplayed()){EOL.myjobs.panel.open()}EOL.myjobs.panel.multiselect($(i.target));return}}else{if($(i.target).tagName.toLowerCase()=="a"||$(i.target).hasClass("actions")||$(i.target).getParent().hasClass("btn-small")){return}}if(h.get("hasPanel")=="no"){return}if(h.get("projectid")==$("panelProjectId").value){EOL.myjobs.panel.close()}else{EOL.myjobs.panel.open(h.get("projectid"),h.get("projecttype"))}});if(g.get("projecttype")=="folders"&&g.get("projectCount")>0){if(d){d+=","}d+=g.get("projectid")}if(draggable&&Modernizr.draganddrop){$(g).getElements("a").each(function(h){h.set("draggable",false)});if(g.get("projecttype")=="folders"){if(g.addEventListener){g.addEventListener("drop",EOL.folders.drag.drop,false);g.addEventListener("dragover",EOL.folders.drag.over,false);g.addEventListener("dragenter",EOL.folders.drag.enter,false);g.addEventListener("dragleave",EOL.folders.drag.leave,false)}else{if(g.attachEvent){g.attachEvent("ondrop",EOL.folders.drag.drop);g.attachEvent("ondragover",EOL.folders.drag.over);g.attachEvent("dragenter",EOL.folders.drag.enter);g.attachEvent("dragleave",EOL.folders.drag.leave)}}}else{if(g.get("draggable")=="true"){if(g.addEventListener){g.addEventListener("dragstart",EOL.folders.drag.start,false);g.addEventListener("dragend",EOL.folders.drag.end,false)}else{if(g.attachEvent){g.attachEvent("ondragstart",EOL.folders.drag.start);g.attachEvent("ondragend",EOL.folders.drag.end)}}}}}else{g.set("draggable","false")}});e.inject($("myjobs-results"));new Fx.Tween(e,{duration:200}).start("opacity",1);if(d){params="folderIds="+d;params+="&statusFilter="+EOL.myjobs.results.curStatusFilter;params+="&contextFilter="+EOL.myjobs.results.curContextFilter;params+="&keywords="+encodeURIComponent(EOL.myjobs.results.curKeywords);var a="/sf/folders/alertCount?"+params;var c=new Request({url:a,method:"GET",onSuccess:function(g){g=JSON.decode(g);for(folderid in g.counts){var h=$("projectCard"+folderid).getElement(".actionable");if(g.counts[folderid]["actionable"]>0){var i='<div class="alertCountText">'+g.counts[folderid]["actionable"]+"</div>";var j=(g.counts[folderid]["actionable"]==1)?"Alert":"Alerts";i+='<div class="actionableIcon">'+j+"</div>";h.getElement(".actionableCount").set("html",i);h.getElement(".actionableCount").show();h.show()}}}}).send()}};EOL.myjobs.results.search=function(){$el("send","useraction","CLICK","myJobsSearch",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{SearchWords:$("myjobs-search-input").value}});var a="";if(!$("myjobs-search-input").value&&EOL.myjobs.results.curFolder){a=EOL.myjobs.results.curFolder}EOL.myjobs.results.get(1,EOL.myjobs.results.curStatusFilter,EOL.myjobs.results.curContextFilter,$("myjobs-search-input").value,a)};EOL.myjobs.results.checkSearchInput=function(){if($("myjobs-search-input").value){$("myjobs-search-clear").show()}else{$("myjobs-search-clear").hide()}};EOL.myjobs.results.clearSearch=function(){$("myjobs-search-input").value="";$("myjobs-search-suggest").value="";$("myjobs-search-clear").hide();EOL.myjobs.results.search();EOL.myjobs.unselectTag()};EOL.myjobs.results.next=function(){EOL.myjobs.results.get(EOL.myjobs.results.curPage+1,EOL.myjobs.results.curStatusFilter,EOL.myjobs.results.curContextFilter,EOL.myjobs.results.curKeywords,EOL.myjobs.results.curFolder)};EOL.myjobs.results.reload=function(){EOL.myjobs.results.get(1,EOL.myjobs.results.curStatusFilter,EOL.myjobs.results.curContextFilter,EOL.myjobs.results.curKeywords,EOL.myjobs.results.curFolder)};EOL.myjobs.results.resetFilters=function(){statusFilter.change("all");if(contextFilter){contextFilter.change("")}EOL.myjobs.results.get(1,"","",EOL.myjobs.results.curKeywords,EOL.myjobs.results.curFolder)};EOL.myjobs.results.openFolder=function(a){EOL.myjobs.results.get(1,EOL.myjobs.results.curStatusFilter,EOL.myjobs.results.curContextFilter,EOL.myjobs.results.curKeywords,a)};EOL.myjobs.results.loadAllJobs=function(){$("myjobs-folder-info").hide();EOL.myjobs.results.get(1,EOL.myjobs.results.curStatusFilter,EOL.myjobs.results.curContextFilter,EOL.myjobs.results.curKeywords,"")};EOL.myjobs.results.showJobsByTag=function(b){EOL.myjobs.unselectTag();var a="";if($("taglist"+b)){a=$("taglist"+b).get("tagvalue");$("taglist"+b).addClass("tag-cloud-selected")}else{if($("user"+b)){a=$("user"+b).get("tagvalue");$("user"+b).addClass("tag-cloud-selected")}}if(a){$("myjobs-search-input").value="tag:"+a;$("myjobs-search-clear").style.display="block";EOL.myjobs.results.search()}};EOL.myjobs.results.suggest=function(){var a=$("myjobs-search-input").value;if(!EOL.myjobs.results.autocomplete){EOL.myjobs.results.autocomplete=new Array();EOL.myjobs.results.autocompleteListSize=new Array();EOL.myjobs.results.autocompleteList=new Meio.Element.List({width:"202px",position:"3"})}EOL.myjobs.results.autocompleteListSize[a]=EOL.cloud.tagList.length;EOL.myjobs.results.autocomplete[a]=new Meio.Autocomplete.Select("myjobs-search-input",EOL.cloud.tagList,{cacheType:"shared",valueField:$("myjobs-search-suggest"),valueFilter:function(b){return b.value},filter:{filter:function(c,b){if(!c){return false}return b.value.test(new RegExp(c.escapeRegExp(),"i"))},formatMatch:function(c,b){return"tag:"+b.value},formatItem:function(d,c,b){return"<div>"+c.value+"</div>"}},listOptions:{width:"140px"},onSelect:function(c,b){$("myjobs-search-input").value="tag:"+b.value}},EOL.myjobs.results.autocompleteList);EOL.myjobs.results.autocomplete[a].setupList()};EOL.namespace("myjobs.card");EOL.myjobs.card.btimer=null;EOL.myjobs.card.showProposalAverage=function(d,a,c,b){EOL.dashboard.btimer=setTimeout("EOL.myjobs.card.displayProposalAverage('"+d+"','"+a+"','"+c+"','"+b+"')",500)};EOL.myjobs.card.displayProposalAverage=function(e,a,d,c){$("lowAmount").innerHTML=(a!=0)?("$"+a):"n/a";$("averageAmount").innerHTML=(d!=0)?("$"+d):"n/a";$("highAmount").innerHTML=(c!=0)?("$"+c):"n/a";var b=$("averageBubble").cloneNode(true);b.setAttribute("id","averageBubble_"+e);$("bubble_context_"+e).appendChild(b);EOL.dashboard.btimer=null};EOL.myjobs.card.hideProposalAverage=function(c){if(EOL.dashboard.btimer){clearTimeout(EOL.dashboard.btimer)}var a=$("bubble_context_"+c);var b=$("averageBubble_"+c);if(b){a.removeChild(b)}};EOL.namespace("myjobs.header");EOL.myjobs.header.toggleAllOff=function(){if($("tagsMenu").isDisplayed()){EOL.myjobs.header.toggleTags()}if($("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}if($("broadcastPanel").isVisible()){EOL.myjobs.broadcastPanel.toggle()}if($("settingsHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleSettings()}};EOL.myjobs.header.toggleTags=function(){if($("tagsMenu").isDisplayed()){if($("productTourDialog")&&$("productTourDialog").getPosition().y>$("tagsMenu").getPosition().y){$("productTourDialog").setStyle("margin-top",$("productTourDialog").getStyle("margin-top").toInt()-$("tagsMenu").getComputedSize().totalHeight)}$("tagsMenu").hide();$("dashboard-header-c").setStyle("margin-bottom","");$("dashboard-panel").setStyle("margin-top","");$("tagsToggle").removeClass("tagsOpen");EOL.myjobs.unselectTag()}else{EOL.myjobs.header.toggleAllOff();$("tagsMenu").show();var a=$("tagsMenu").getSize();$("dashboard-header-c").setStyle("margin-bottom",(a.y+15)+"px");$("tagsToggle").addClass("tagsOpen");$(document.body).addEvent("click",EOL.myjobs.closeOpenTagStates);if($("dashboard-header").hasClass("floating")){$("dashboard-panel").setStyle("margin-top",a.y+"px")}if($("productTourDialog")&&$("productTourDialog").getPosition().y>$("tagsMenu").getPosition().y){$("productTourDialog").setStyle("margin-top",$("productTourDialog").getStyle("margin-top").toInt()+$("tagsMenu").getComputedSize().totalHeight)}}};EOL.myjobs.header.toggleSettings=function(){if($("settingsHeaderMenu").isDisplayed()){$("settingHeaderToggle").removeClass("settingsOpen");$("settingsHeaderMenu").hide();document.removeEvent("mousedown",EOL.myjobs.header.settingsToggleEvent)}else{EOL.myjobs.header.toggleAllOff();$("settingHeaderToggle").addClass("settingsOpen");$("settingsHeaderMenu").show();document.addEvent("mousedown",EOL.myjobs.header.settingsToggleEvent)}};EOL.myjobs.header.settingsToggleEvent=function(b){var a=null;if(window.event){a=window.event.srcElement}else{a=(b.target.tagName)?b.target:b.target.parentNode}do{if(a.id=="settingHeaderToggle"||a.id=="settingsHeaderMenu"){return}}while(a=a.parentNode);EOL.myjobs.header.toggleSettings()};EOL.myjobs.header.toggleFolders=function(){if($("foldersHeaderMenu").isDisplayed()){$("foldersHeaderToggle").removeClass("foldersOpen");$("foldersHeaderMenu").hide();window.removeEvent("scroll",EOL.myjobs.header.resizeFolders)}else{EOL.myjobs.header.toggleAllOff();$("foldersHeaderMenu").set("html",'<img src="/media/images/4.0/ajax-loader-small.gif" style="margin: 50px 115px;">');$("foldersHeaderToggle").addClass("foldersOpen");$("foldersHeaderMenu").show();window.addEvent("scroll",EOL.myjobs.header.resizeFolders);EOL.myjobs.header.loadFolders()}};EOL.myjobs.header.loadFolders=function(){var a=new Request({url:"/sf/folders/panel",method:"GET",onSuccess:function(b){$("foldersHeaderMenu").set("html",b);if(draggable&&Modernizr.draganddrop){$("foldersHeaderMenu").getElements(".folder-list-item").each(function(c){if(c.addEventListener){c.addEventListener("drop",EOL.folders.drag.drop,false);c.addEventListener("dragover",EOL.folders.drag.over,false);c.addEventListener("dragenter",EOL.folders.drag.enter,false);c.addEventListener("dragleave",EOL.folders.drag.leave,false)}else{if(c.attachEvent){c.attachEvent("ondrop",EOL.folders.drag.drop);c.attachEvent("ondragover",EOL.folders.drag.over);c.attachEvent("dragenter",EOL.folders.drag.enter);c.attachEvent("dragleave",EOL.folders.drag.leave)}}})}EOL.myjobs.header.resizeFolders()}}).send()};EOL.myjobs.header.resizeFolders=function(){var b=$("foldersHeaderMenu").getElement(".headermenu-block").getSize().y;var c=window.getSize().y;if($("dashboard-header").style.position=="fixed"){var d=$("dashboard-header").getPosition().y}else{var d=$("dashboard-header").getPosition().y-window.getScroll().y}var a=c-d-40;if(b>a){$("foldersHeaderMenu").setStyle("overflowY","auto");$("foldersHeaderMenu").setStyle("height",a-10)}else{$("foldersHeaderMenu").setStyle("overflowY","");$("foldersHeaderMenu").setStyle("height",b)}};EOL.myjobs.header.prepareDisplayTag=function(a){if($("tag"+a)){var b=$("tag"+a).getElements("div.tag-assigned a").getLast();if(b){var c=b.get("text");b.set("text",c+",")}}};EOL.namespace("myjobs.actions");EOL.myjobs.actions.dialog=null;EOL.myjobs.actions.action=null;EOL.myjobs.actions.id=null;EOL.myjobs.actions.type=null;EOL.myjobs.actions.prompt=function(b,c,a){EOL.myjobs.actions.resetErrors();EOL.myjobs.actions.action=b;if(!c&&!a){EOL.myjobs.actions.id="";EOL.myjobs.actions.type=""}else{EOL.myjobs.actions.id=c;EOL.myjobs.actions.type=a}EOL.myjobs.actions.dialog=new EOL.dialog($(b+"-dialog").get("html"),{position:"fixed",modal:true,width:300,height:90,close:true});EOL.myjobs.actions.dialog.show()};EOL.myjobs.actions.doAction=function(){var h="";var f="";var e="";var a="";var c=new Array();if(!EOL.myjobs.actions.id&&!EOL.myjobs.actions.type){$$("#myjobs-results .dashboard-card .checkbox.checked").each(function(i){while(!i.hasClass("dashboard-card")){i=i.getParent()}if(i.get("projecttype")=="job"){if(h){h+=","}h+=i.get("projectid");c.push(i.get("projectid"))}else{if(i.get("projecttype")=="bid"){if(f){f+=","}f+=i.get("projectid");c.push(i.get("projectid"))}else{if(i.get("projecttype")=="draft"){if(e){e+=","}e+=i.get("projectid");c.push(i.get("projectid"))}else{if(i.get("projecttype")=="folders"){if(a){a+=","}a+=i.get("projectid");c.push(i.get("projectid"))}}}}})}else{if(EOL.myjobs.actions.type=="job"){h=EOL.myjobs.actions.id}else{if(EOL.myjobs.actions.type=="bid"){f=EOL.myjobs.actions.id}else{if(EOL.myjobs.actions.type=="draft"){e=EOL.myjobs.actions.id}else{if(EOL.myjobs.actions.type=="folders"){a=EOL.myjobs.actions.id}}}}c.push(EOL.myjobs.actions.id)}if(!h&&!f&&!e&&!a){return}var g="jobids="+h+"&bidids="+f;if(e){g+="&draftids="+e}if(a){g+="&folderids="+a}switch(EOL.myjobs.actions.action){case"archive":var b="/sf/myjobs/actions/archive";$el("send","useraction","CLICK","bulkArchive",{userId:getCookie("userid"),pageName:"MyJobs"});if(EOL.myjobs.results.curFolder){g+="&curFolderId="+EOL.myjobs.results.curFolder}break;case"unarchive":var b="/sf/myjobs/actions/unarchive";if(EOL.myjobs.results.curFolder){g+="&curFolderId="+EOL.myjobs.results.curFolder}break;case"delete":var b="/sf/myjobs/actions/delete";break}var d=new Request({url:b,data:g,method:"POST",onSuccess:function(i){if(EOL.myjobs.actions.dialog){EOL.myjobs.actions.dialog.hide()}c.each(function(l){if($("projectCard"+l)){$("projectCard"+l).setStyle("overflow","hidden");var m=new Fx.Morph("projectCard"+l,{duration:500,onComplete:function(){if($("projectCard"+l)){$("projectCard"+l).hide();$("projectCard"+l).destroy()}}});m.start({opacity:0,height:0})}});if($("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}if(a&&a==EOL.myjobs.results.curFolder){EOL.myjobs.results.loadAllJobs()}else{if(EOL.myjobs.results.numNext>0){var k="page="+EOL.myjobs.results.curPage;k+="&statusFilter="+EOL.myjobs.results.curStatusFilter;k+="&contextFilter="+EOL.myjobs.results.curContextFilter;k+="&keywords="+EOL.myjobs.results.curKeywords;k+="&folderid="+EOL.myjobs.results.curFolder;k+="&backfill="+c.length;var j="/sf/myjobs/results?";new Request({url:j+k,method:"GET",noCache:true,onSuccess:function(l){var l=JSON.decode(l);EOL.myjobs.results.create("backfill",l.html);if((l.totalResults-EOL.myjobs.results.numDisplayed)<EOL.myjobs.results.numNext){EOL.myjobs.results.numNext=(l.totalResults-EOL.myjobs.results.numDisplayed);if(EOL.myjobs.results.numNext<=0){EOL.myjobs.results.numNext=0;$("myjobs-loadmore").hide()}}EOL.myjobs.results.numTotal=l.totalResults;var m=EOL.myjobs.results.numDisplayed+" of "+EOL.myjobs.results.numTotal.format()+' items | <a href="javascript:void(0);">Load '+EOL.myjobs.results.numNext+" more</a>";$("loadmore-text").set("html",m)}}).send()}else{EOL.myjobs.results.reload()}}if($("dashboard-panel").isDisplayed()){EOL.myjobs.panel.close()}if($("newFolderTooltip")){$("newFolderTooltip").destroy()}}}).send()};EOL.myjobs.actions.resetErrors=function(){var a=document.getElement("#bulkPanel .errorBox-small");a.getElement("li").set("html","");a.hide()};EOL.myjobs.actions.displayError=function(a){var b=document.getElement("#bulkPanel .errorBox-small");b.getElement("li").set("html",a);b.show()};EOL.myjobs.actions.showBuilkMessage=function(){EOL.myjobs.actions.resetErrors();$("bulkPostedMsgs").empty();var b=0,c=0;$$("#myjobs-results .dashboard-card .checkbox.checked").each(function(e){while(!e.hasClass("dashboard-card")){e=e.getParent()}var d=e.get("projecttype");if(e.hasClass("folder")){c=parseInt(e.get("projectCount"));b+=c?c:0}else{b++}});$el("send","useraction","CLICK","bulkBroadcast",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{bids:b,folders:c}});var a="/sf/myjobs/actions/broadcastpanel";new Request({url:a,method:"GET",noCache:true,onSuccess:function(d){var d=JSON.decode(d);$("broadcast-content").innerHTML=d.html;EOL.myjobs.actions.checkBuilkMessageAlert();$("bulkMsgTitle").style.display="";$("bulkMsgPanel").style.display="";$("bulkPanelButtons").style.display="none";$("bulkPanelTitle").addClass("smallerTitle");$el("send","useraction","VIEW","BroadcastPanel",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{bids:b,folders:c}});EOL.uploadW.closeBulkAttach();$("bulkMsgTxt").focus();$("broadcastToggle").hide();$("broadcastToggleInactive").show();$("bulkPanelTitle").set("html",b+" Items Selected")}}).send()};EOL.myjobs.actions.hideBuilkMessageAlert=function(){$("bulkMsgPanleAlert").style.display="none";$$(".caseAlertHiringStatus").each(function(a){a.style.display="none"});$$(".caseClientResponses").each(function(a){a.style.display="none"})};EOL.myjobs.actions.checkBuilkMessageAlert=function(){EOL.myjobs.actions.hideBuilkMessageAlert();var a=$("myjobs-results").getElements(".selected");var b;a.each(function(c){if(c.get("bulkalert")=="hiringStatus"){b="hiringStatus"}});if(!b){a.each(function(c){if(c.get("bulkalert")=="clientResponses"){b="clientResponses"}})}if(b){if(b=="hiringStatus"){$("bulkMsgPanleAlert").style.display="";$$(".caseAlertHiringStatus").each(function(c){c.style.display=""})}else{if(b=="clientResponses"){$("bulkMsgPanleAlert").style.display="";$$(".caseClientResponses").each(function(c){c.style.display=""})}}}};EOL.namespace("myjobs.onboarding");EOL.myjobs.onboarding.get=function(){var a=new Request({url:"/sf/myjobs/onboarding",method:"GET",noCache:true,onSuccess:function(b){$("onboarding").set("html",b)}});a.send()};var statusFilter=null;var contextFilter=null;window.addEvent("domready",function(){EOL.dashboard.collab.postMessageMetricTagSource="MyJobs";var a="";if($("statusFilter_input")){a=$("statusFilter_input").value}var e="";if($("contextFilter_input")){e=$("contextFilter_input").value}var d="";if($("myjobs-search-input").value){d=$("myjobs-search-input").value}EOL.myjobs.results.get(1,a,e,d);EOL.myjobs.onboarding.get();Array.forEach(EOL.dashboard.widgetsToLoad,function(g){g()});var c=new ScrollSpy({min:183-15,onEnter:function(g,i,j){$("dashboard-header").style.position="fixed";$("dashboard-header").style.top="10px";$("dashboard-panel").style.position="fixed";$("dashboard-panel").style.top="65px";$("dashboard-header").addClass("floating");EOL.myjobs.panel.resize();var h=$("tagsMenu").getSize();$("dashboard-panel").setStyle("margin-top",h.y+"px");if($("productTourDialog")){if($("productTourDialog").getStyle("position")=="absolute"){$("productTourDialog").setStyle("margin-top",$("productTourDialog").getStyle("margin-top").toInt()-42)}}},onLeave:function(g,h,i){$("dashboard-header").style.position="";$("dashboard-header").style.top="";$("dashboard-panel").style.position="absolute";$("dashboard-panel").style.top="";$("dashboard-header").removeClass("floating");EOL.myjobs.panel.resize();$("dashboard-panel").setStyle("margin-top","");if($("productTourDialog")){if($("productTourDialog").getStyle("position")=="absolute"){$("productTourDialog").setStyle("margin-top",$("productTourDialog").getStyle("margin-top").toInt()+42)}}},container:window});statusFilter=new EOL.dashboard.select("statusFilter",function(g){$el("send","useraction","CLICK","jobStatusFilter",{userId:getCookie("userid"),pageName:"MyJobs",metricTags:{jobStatus:g}});EOL.myjobs.results.get(1,g,EOL.myjobs.results.curContextFilter,EOL.myjobs.results.curKeywords,EOL.myjobs.results.curFolder)},function(){$el("send","useraction","CLICK","jobStatusFilter",{userId:getCookie("userid"),pageName:"MyJobs"})});if($("contextFilter")){contextFilter=new EOL.dashboard.select("contextFilter",function(g){$el("send","useraction","SELECT","userPersonaFilter",{userId:getCookie("userid"),pageName:"MyJobs",metricTags:{value:g||"both"}});EOL.myjobs.results.get(1,EOL.myjobs.results.curStatusFilter,g,EOL.myjobs.results.curKeywords,EOL.myjobs.results.curFolder)},function(){$el("send","useraction","CLICK","userPersonaFilter",{userId:getCookie("userid"),pageName:"MyJobs"})})}new EOL.dashboard.select("statusFilterPref",function(g){EOL.dashboard.preferences.save("statusFilter",g)});if($("contextFilterPref")){new EOL.select("contextFilterPref",function(g){EOL.dashboard.preferences.save("contextFilter",g)})}if($("homePref")){new EOL.select("homePref",function(g){EOL.dashboard.preferences.save("home",g)})}EOL.myjobs.results.suggest();var b=$("foldersHeaderToggle").getElement(".toggleContainer");if(draggable&&Modernizr.draganddrop){if(b.addEventListener){b.addEventListener("dragover",EOL.folders.drag.over,false);b.addEventListener("dragenter",EOL.folders.drag.menuEnter,false);b.addEventListener("dragleave",function(){},false)}else{if($("foldersHeaderToggle").attachEvent){b.attachEvent("ondragover",EOL.folders.drag.over);b.attachEvent("ondragenter",EOL.folders.drag.menuEnter);b.attachEvent("dragleave",function(){})}}var f=$("myjobs-up");if(f.addEventListener){f.addEventListener("drop",EOL.folders.drag.drop,false);f.addEventListener("dragover",EOL.folders.drag.over,false);f.addEventListener("dragenter",EOL.folders.drag.enter,false);f.addEventListener("dragleave",EOL.folders.drag.leave,false)}else{if(f.attachEvent){f.attachEvent("ondrop",EOL.folders.drag.drop);f.attachEvent("ondragover",EOL.folders.drag.over);f.attachEvent("dragenter",EOL.folders.drag.enter);f.attachEvent("dragleave",EOL.folders.drag.leave)}}}});window.addEvent("resize",function(){if($("dashboard-panel").isDisplayed()){EOL.myjobs.panel.resize();$("dashboard-panel").setStyle("left",(($("dashboard-header").offsetLeft-20)+590)+"px")}});EOL.myjobs.resizeSearchBar=function(){var a=$("dashboard-header-content").getWidth().toInt();var d=0;$("dashboard-header-content").getChildren().each(function(g){if(!g.hasClass("search")){d+=g.getWidth().toInt()}});var b=a-d;var f=document.getElement("li.headeritem.search");var e=f.getComputedSize();var c=b+e.width-e.totalWidth-40;if(c>200){c=200}$("myjobs-search-input").setStyle("width",c)};EOL.myjobs.displayAddTagFromNone=function(){EOL.cloud.tag.displayPanelAdd();$("panelTags").style.display="";$("noTagsState").style.display="none"};EOL.myjobs.setTagViewMode=function(d){var c="block";var b="30px";var a="";if(d){c="none";b="10px";$("tag-cloud-add-section").addClass("displayNone");$("tag-cloud-edit-link").removeClass("displayNone");a="Click to Filter"}else{$(document.body).addEvent("click",EOL.cloud.clickTagCloudViewModeHandler);$("tag-cloud-edit-link").addClass("displayNone");$("tag-cloud-add-section").removeClass("displayNone")}$("cloudlist").getChildren("div").each(function(f,e){if(f.hasClass("tag")){f.getChildren("ul")[0].getChildren("li").each(function(h,g){h.title=a;h.style.paddingRight=b;if(h.id!="addtaguser"){h.removeClass("tag-cloud-selected")}if(d){h.addClass("tag-item")}else{h.removeClass("tag-item")}h.getChildren("a").each(function(i,k){if(i.id!="addednewtag"){i.style.display=c}})})}})};EOL.myjobs.closeOpenTagStates=function(a){if($("tagsToggle").hasClass("tagsOpen")&&(!a.target||!$(a.target).getParents().contains($("tagsToggle")))){EOL.myjobs.header.toggleTags()}if($("panelAddNewTag")&&$("panelAddNewTag").hasClass("addingPanelTag")&&(!a.target||(!$(a.target).getParents().contains($("panelTags"))&&!$(a.target).getParents().contains($("myjobs-results"))))){EOL.myjobs.panel.addTagProcess()}};EOL.myjobs.unselectTag=function(){var a=$("cloudlist").getElements("div ul li.tag-cloud-selected");a.each(function(b){b.removeClass("tag-cloud-selected")})};EOL.myjobs.actionTag=function(a){var b=$("projectCard"+a).get("projecttype");$("projectCard"+a).set("projecttype",b);EOL.myjobs.panel.open(a,b,"tag");EOL.myjobs.panel.actionTagActiveR()};EOL.myjobs.panel.actionTagActiveR=function(){if($("panelAddNewTag")&&!$("panelAddNewTag").hasClass("addingPanelTag")){EOL.myjobs.displayAddTagFromNone();return}else{return setTimeout("EOL.myjobs.panel.actionTagActiveR()",500)}};EOL.myjobs.tagListCotains=function(a){var b=false;EOL.cloud.tagList.each(function(c){if(c.value==a){b=true}});return b};EOL.namespace("myjobs.broadcastPanel");EOL.myjobs.broadcastPanel.toggle=function(){if($("myjobs-results").getElements(".selected").length>1&&EOL.myjobs.results.curStatusFilter!="draft"&&EOL.myjobs.results.curStatusFilter!="archived"){EOL.myjobs.actions.showBuilkMessage()}else{if($("broadcastPanel").isVisible()){EOL.myjobs.panel.close()}else{EOL.myjobs.header.toggleAllOff();$("broadcastToggle").addClass("broadcastOpen");EOL.myjobs.panel.open(null,null,"broadcast");var a=$("myjobs-results").getElements(".selected");if(a.length==1){a.each(function(b){EOL.myjobs.card.unselect($(b))})}}}};EOL.myjobs.showFeaturedUpsellMaxInvitesModal=function(a){EOL.featuredUpsell.showMaxInvitesReachedModal(a)};EOL.myjobs.closeMarketingMessage=function(){$("marketingMessage").dispose();var b="marketingMessage=Y";var a=new Request({url:"/sf/myjobs/prefs/save",data:b,method:"POST",onSuccess:function(c){}}).send()};EOL.myjobs.hasJobs=function(){return $$("#myjobs-results .dashboard-card").some(function(b){var a=b.get("projecttype");if(a=="job"||a=="bid"){return true}else{return b.get("projectCount")>0}})};function startProductTour(a){if(!a){if($("myjobs-results").get("html")){EOL.productTour.init(true)}else{if(!EOL.myjobs.results.callback){EOL.myjobs.results.callback=EOL.productTour.init}}}else{if(a){new Request({url:"/sf/myjobs/tour/load",method:"get",onSuccess:function(b){b=JSON.decode(b);if(b){if($("myjobs-results").get("html")){EOL.productTour.showInvitation()}else{if(!EOL.myjobs.results.callback){EOL.myjobs.results.callback=EOL.productTour.showInvitation}}}}}).send()}}}function getProductTourInvContent(){if(EOL.myjobs.hasJobs()){return $("productTourWithJobInvDialogContent")}else{return $("productTourNoJobInvDialogContent")}}function getProductTourData(){var e,g,f;var a=$("myjobs-results");if(EOL.myjobs.hasJobs()){e=JSON.decode($("productTourWithJobData").get("html"));e[2].title=$("productTourWithJobTitle3").get("html");e[2].text=$("productTourWithJobText3").get("html");var b=$$("#myjobs-results .dashboard-card[haspanel=yes]");var d=b[0];if(d){e[0].elementId=d.get("id");e[0].offsetX=0;e[0].offsetY=10;e[0].beforeLoad=function(){d.setStyles({padding:"14px 14px 14px 9px"})};e[0].beforeUnload=function(){d.setStyles({padding:null})};e[1].elementId=d.get("id");e[1].beforeLoad=function(){EOL.myjobs.panel.open(d.get("projectid"),d.get("projecttype"));d.setStyles({padding:"14px 14px 14px 9px"})};e[1].beforeUnload=function(){EOL.myjobs.panel.close();d.setStyles({padding:null})}}else{g=$("myjobs-results").getElement(".dashboard-card").getCoordinates(a);if(!$("phantom1")){f=new Element("div",{id:"phantom1","class":"eol-tour-phantom",styles:{left:g.left-1,top:g.top-1,width:g.width,height:35}});a.grab(f)}e[0].elementId="phantom1";e[0].offsetX=120;e[0].offsetY=g.height-35;e.splice(1,1)}}else{e=JSON.decode($("productTourNoJobData").get("html"));var c=$("no-results-wrapper");if(c){e[0].offsetY=10;e[0].beforeLoad=function(){c.setStyle("padding","19px 19px 39px")};e[0].beforeUnload=function(){c.setStyle("padding",null)}}else{g=$("myjobs-results").getCoordinates(a);if(!$("phantom1")){f=new Element("div",{id:"phantom1","class":"eol-tour-phantom",styles:{left:g.left-1,top:g.top-1,width:g.width,height:35}});a.grab(f)}e[0].elementId="phantom1";e[0].offsetY=30}e[0].title=$("productTourNoJobTitle1").get("html");e[0].text=$("productTourNoJobText1").get("html");e[1].title=$("productTourNoJobTitle2").get("html");e[1].text=$("productTourNoJobText2").get("html")}e[e.length-1].beforeLoad=function(){$("nav-search-go-btn").removeEvent("click",EOL.productTour.close);$("productTourCustom").removeEvent("click",EOL.productTour.close);EOL.nav.search.select("profiles");EOL.nav.search.toggle();$("nav-search-keywords").set("value","iOS");Cookie.write("showSearchTour","1")};e[e.length-1].beforeUnload=function(){$("nav-search-go-btn").addEvent("click",EOL.productTour.close);$("nav-search-keywords").set("value","");Cookie.dispose("showSearchTour")};return e}function getProductTourId(){if(EOL.myjobs.hasJobs()){return $("productTourWithJobId").get("html")}else{return $("productTourNoJobId").get("html")}}function saveProductTourSeen(c,a){var b="tourId="+c+"&seen="+(a?"Y":"N");new Request({url:"/sf/myjobs/tour/seen",method:"post",data:b}).send()}function correctProductTourPosY(c,f){var e=window.getScrollTop();var a=window.innerHeight||document.documentElement.clientHeight;var d=c.getPosition().y-(a-c.getComputedSize().totalHeight)/2;var b=183-15;if(e<b&&d>=b){f-=42}else{if(e>b&&d<=b){f+=42}}return f};
var ScrollSpy=new Class({Implements:[Options,Events],options:{container:window,max:0,min:0,mode:"vertical"},initialize:function(b){this.setOptions(b);this.container=document.id(this.options.container);this.enters=this.leaves=0;this.inside=false;this.listener=function(e){var a=this.container.getScroll(),f=a[this.options.mode=="vertical"?"y":"x"];if(f>=this.options.min&&(this.options.max==0||f<=this.options.max)){if(!this.inside){this.inside=true;this.enters++;this.fireEvent("enter",[a,this.enters,e])}this.fireEvent("tick",[a,this.inside,this.enters,this.leaves,e])}else{if(this.inside){this.inside=false;this.leaves++;this.fireEvent("leave",[a,this.leaves,e])}}this.fireEvent("scroll",[a,this.inside,this.enters,this.leaves,e])};this.addListener()},start:function(){this.container.addEvent("scroll",this.listener.bind(this))},stop:function(){this.container.removeEvent("scroll",this.listener.bind(this))},addListener:function(){this.start()}});
EOL.namespace("featuredUpsell");EOL.featuredUpsell.setupRelistAsFeaturedModalTrigger=function(b,a){window.addEvent("domready",function(){$(b).addEvent("click",function(){var c=new EOL.featuredUpsell.relistAsFeaturedModal({jobId:a});c.open()})})};EOL.featuredUpsell.setupRelistFeaturedJobModalTrigger=function(b,a){window.addEvent("domready",function(){$(b).addEvent("click",function(){var c=new EOL.featuredUpsell.relistFeaturedJobModal({jobId:a});c.open()})})};EOL.featuredUpsell.setupMaxInvitesModalTrigger=function(b,a){window.addEvent("domready",function(){$(b).addEvent("click",function(){var c=new EOL.featuredUpsell.maxInvitesReachedModal({jobId:a});c.open()})})};EOL.featuredUpsell.setupPotentialMaxInvitesModalTrigger=function(b,a){window.addEvent("domready",function(){$(b).addEvent("click",function(){var c=new EOL.featuredUpsell.potentialMaxInvitesReachedModal({jobId:a});c.open()})})};EOL.featuredUpsell.setupConfirmedFeaturedModalTrigger=function(c,b,a){window.addEvent("domready",function(){$(c).addEvent("click",function(){var d=new EOL.featuredUpsell.confirmedFeaturedModal({jobId:b,paymentId:a});d.open()})})};EOL.featuredUpsell.setupBaseModalTrigger=function(b,a){window.addEvent("domready",function(){$(b).addEvent("click",function(){var c=new EOL.featuredUpsell.genericModal({jobId:a});c.open()})})};EOL.featuredUpsell.setupConfirmedFeaturedOnLoadTrigger=function(b,a){window.addEvent("domready",function(){EOL.featuredUpsell.showConfirmedFeaturedModal(b,a)})};EOL.featuredUpsell.setupAlreadyFeaturedOnLoadTrigger=function(b,a){window.addEvent("domready",function(){EOL.featuredUpsell.showAlreadyFeaturedModal(b,a)})};EOL.featuredUpsell.setupGenericFeaturedOnLoadTrigger=function(b,a){window.addEvent("domready",function(){EOL.featuredUpsell.showGenericFeaturedModal(b,a)})};EOL.featuredUpsell.showMaxInvitesReachedModal=function(a){var b=new EOL.featuredUpsell.maxInvitesReachedModal({jobId:a});b.open()};EOL.featuredUpsell.showPotentialMaxInvitesReachedModal=function(a){var b=new EOL.featuredUpsell.potentialMaxInvitesReachedModal({jobId:a});b.open()};EOL.featuredUpsell.showRelistAsFeaturedModal=function(a){var b=new EOL.featuredUpsell.relistAsFeaturedModal({jobId:a});b.open()};EOL.featuredUpsell.showConfirmedFeaturedModal=function(b,a){var c=new EOL.featuredUpsell.confirmedFeaturedModal({jobId:b,paymentId:a});c.open()};EOL.featuredUpsell.showGenericFeaturedModal=function(a){var b=new EOL.featuredUpsell.genericModal({jobId:a});b.open()};EOL.featuredUpsell.showAlreadyFeaturedModal=function(a){var b=new EOL.featuredUpsell.alreadyFeaturedModal({jobId:a});b.open()};EOL.featuredUpsell.modal=new Class({modalRequest:null,modalRequestParameters:{},dialog:null,jobId:null,modalUrl:null,modalUrlAction:null,height:null,width:null,communicationErrorMessage:"Unable to communicate with Elance, please refresh and try again.",onCommunicationError:function(a){alert(this.communicationErrorMessage)},onConfirm:function(a){window.location.href=$(this.dialog.containerEl).getElement("a.confirm").getAttribute("href")},onCancel:function(a){this.hide()},className:"",redirect:null,optionDefaults:{jobId:null,modalUrl:"/php/post/main/featuredUpsellAHR.php",modalUrlAction:null,height:null,width:null,className:"",redirect:window.location.href},options:{},initialize:function(c){this.options=Object.merge({},this.optionDefaults,this.options,c);var b=this;if(!this.options.jobId){throw"You must supply a jobId option"}if(!this.options.modalUrl){throw"You must supply the url where the modal can be fetched"}if(!this.options.modalUrlAction){throw"You must supply the controller action (i.e. MaxInvitesModal)"}this.setObjectAttributesFromOptions();this.dialog=new EOL.dialog("",{position:"scroll",className:"featuredUpsellDialog "+this.className,width:this.width,height:this.height});var a={url:this.modalUrl,data:Object.merge({},{jobId:this.jobId,action:this.modalUrlAction,redirect:this.redirect},this.modalRequestParameters),method:"get",onSuccess:function(d){b.update(d.data.modalContent)},onFailure:function(d){b.onCommunicationError(d)}};this.modalRequest=new Request.JSON(a)},setObjectAttributesFromOptions:function(){var a=this;Object.each(this.options,function(c,b){a[b]=c})},trackEvent:function(a){if(_gaq&&_gaq.push){_gaq.push(["_trackEvent","feature_upsell",a,this.options.modalUrlAction])}},open:function(){this.trackEvent("open");this.show()},show:function(){this.showLoading();this.modalRequest.send()},hide:function(){this.dialog.hide()},close:function(){this.trackEvent("close");this.hide()},resetCloseButton:function(){var a=this;if($(this.dialog.containerEl)){oldCloseButton=$(this.dialog.containerEl).getElement(".eol-dialog-close");var b=oldCloseButton.clone();b.addEvent("click",function(){a.close()});b.inject(oldCloseButton,"after");oldCloseButton.dispose()}},showLoading:function(){var b=this.width?this.width:"auto";var a=this.height?this.height:"auto";var c='<div class="popup-loading" style="width:'+b+"px; height:"+a+'px;"></div>';this.dialog.update(c);this.dialog.show();this.resetCloseButton()},update:function(c){this.dialog.update(c);var b=this;confirmButton=$(this.dialog.containerEl).getElement("a.confirm");confirmButton&&confirmButton.addEvent("click",function(d){d.stop();b.trackEvent("confirm");b.onConfirm(d)});var a=$(this.dialog.containerEl).getElement("a.cancel");a&&a.addEvent("click",function(d){d.stop();b.trackEvent("cancel");b.onCancel(d)})}});EOL.featuredUpsell.maxInvitesReachedModal=new Class({Extends:EOL.featuredUpsell.modal,options:{modalUrlAction:"MaxInvitesModal",width:548,className:"maxInvitesReachedModal"},onConfirm:function(a){this.parent(a)}});EOL.featuredUpsell.potentialMaxInvitesReachedModal=new Class({Extends:EOL.featuredUpsell.modal,options:{modalUrlAction:"PotentialMaxInvitesModal",width:548,className:"potentialMaxInvitesReachedModal"}});EOL.featuredUpsell.genericModal=new Class({Extends:EOL.featuredUpsell.modal,options:{modalUrlAction:"GenericModal",width:693,height:430,className:"genericModal"}});EOL.featuredUpsell.confirmedFeaturedModal=new Class({Extends:EOL.featuredUpsell.modal,initialize:function(a){this.modalRequestParameters={paymentId:a.paymentId};this.parent(a)},options:{modalUrlAction:"ConfirmedFeaturedModal",width:527,height:285,className:"confirmedFeaturedModal"},onConfirm:function(){this.hide()}});EOL.featuredUpsell.alreadyFeaturedModal=new Class({Extends:EOL.featuredUpsell.modal,options:{modalUrlAction:"AlreadyFeaturedModal",width:548,height:120,className:"AlreadyFeaturedModal"},onConfirm:function(){this.hide()}});EOL.featuredUpsell.relistAsFeaturedModal=new Class({Extends:EOL.featuredUpsell.modal,options:{modalUrlAction:"RelistAsFeaturedModal",width:548,height:460,className:"RelistAsFeaturedModal"}});EOL.featuredUpsell.relistModal=new Class({Extends:EOL.featuredUpsell.modal,relistFailureMessage:"Unfortunatly you job could not be relisted.  Please contact support.",onConfirm:function(d){var c=$(this.dialog.containerEl).getElement("a.confirm").getAttribute("href");var a=this;var b=new Request.JSON({url:c,data:{jobId:a.jobId},method:"post",onSuccess:function(e){if(e.data.relisted){a.trackEvent("relistSuccess");a.onRelistSuccess(e)}else{a.trackEvent("relistFailure");a.onRelistFailure(e)}},onFailure:function(e){a.onCommunicationError(e)}});b.send()},onRelistSuccess:function(a){if(this.options.onRelistSuccess){this.options.onRelistSuccess.call(this,a)}return},onRelistFailure:function(a){if(this.options.onRelistFailure){this.options.onRelistFailure.call(this,a)}else{alert(this.relistFailureMessage)}}});EOL.featuredUpsell.relistFeaturedJobModal=new Class({Extends:EOL.featuredUpsell.relistModal,options:{modalUrlAction:"RelistFeaturedJobModal",width:577,height:187,className:"relistFeaturedJobModal"}});
Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(c,d){this.elements=this.subject=$$(c);this.parent(d)},compute:function(l,k,i){var p={};for(var o in l){var r=l[o],n=k[o],m=p[o]={};for(var q in r){m[q]=this.parent(r[q],n[q],i)}}return p},set:function(e){for(var h in e){if(!this.elements[h]){continue}var f=e[h];for(var g in f){this.render(this.elements[h],g,f[g],this.options.unit)}}return this},start:function(p){if(!this.check(p)){return this}var k={},i={};for(var o in p){if(!this.elements[o]){continue}var m=p[o],r=k[o]={},l=i[o]={};for(var q in m){var n=this.prepare(this.elements[o],q,m[q]);r[q]=n.from;l[q]=n.to}}return this.parent(k,i)}});Fx.Accordion=new Class({Extends:Fx.Elements,options:{fixedHeight:false,fixedWidth:false,display:0,show:false,height:true,width:false,opacity:true,alwaysHide:false,trigger:"click",initialDisplayFx:true,resetHeight:true},initialize:function(){var j=function(a){return a!=null};var k=Array.link(arguments,{container:Type.isElement,options:Type.isObject,togglers:j,elements:j});this.parent(k.elements,k.options);var h=this.options,l=this.togglers=$$(k.togglers);this.previous=-1;this.internalChain=new Chain();if(h.alwaysHide){this.options.link="chain"}if(h.show||this.options.show===0){h.display=false;this.previous=h.show}if(h.start){h.display=false;h.show=false}var m=this.effects={};if(h.opacity){m.opacity="fullOpacity"}if(h.width){m.width=h.fixedWidth?"fullWidth":"offsetWidth"}if(h.height){m.height=h.fixedHeight?"fullHeight":"scrollHeight"}for(var n=0,i=l.length;n<i;n++){this.addSection(l[n],this.elements[n])}this.elements.each(function(b,c){if(h.show===c){this.fireEvent("active",[l[c],b])}else{for(var a in m){b.setStyle(a,0)}}},this);if(h.display||h.display===0||h.initialDisplayFx===false){this.display(h.display,h.initialDisplayFx)}if(h.fixedHeight!==false){h.resetHeight=false}this.addEvent("complete",this.internalChain.callChain.bind(this.internalChain))},addSection:function(l,o){l=document.id(l);o=document.id(o);this.togglers.include(l);this.elements.include(o);var m=this.togglers,p=this.options,k=m.contains(l),j=m.indexOf(l),i=this.display.pass(j,this);l.store("accordion:display",i).addEvent(p.trigger,i);if(p.height){o.setStyles({"padding-top":0,"border-top":"none","padding-bottom":0,"border-bottom":"none"})}if(p.width){o.setStyles({"padding-left":0,"border-left":"none","padding-right":0,"border-right":"none"})}o.fullOpacity=1;if(p.fixedWidth){o.fullWidth=p.fixedWidth}if(p.fixedHeight){o.fullHeight=p.fixedHeight}o.setStyle("overflow","hidden");if(!k){for(var n in this.effects){o.setStyle(n,0)}}return this},removeSection:function(i,g){var j=this.togglers,h=j.indexOf(i),l=this.elements[h];var k=function(){j.erase(i);this.elements.erase(l);this.detach(i)}.bind(this);if(this.now==h||g!=null){this.display(g!=null?g:(h-1>=0?h-1:0)).chain(k)}else{k()}return this},detach:function(c){var d=function(a){a.removeEvent(this.options.trigger,a.retrieve("accordion:display"))}.bind(this);if(!c){this.togglers.each(d)}else{d(c)}return this},display:function(i,p){if(!this.check(i,p)){return this}var k={},l=this.elements,j=this.options,m=this.effects;if(p==null){p=true}if(typeOf(i)=="element"){i=l.indexOf(i)}if(i==this.previous&&!j.alwaysHide){return this}if(j.resetHeight){var n=l[this.previous];if(n&&!this.selfHidden){for(var o in m){n.setStyle(o,n[m[o]])}}}if((this.timer&&j.link=="chain")||(i===this.previous&&!j.alwaysHide)){return this}this.previous=i;this.selfHidden=false;l.each(function(b,c){k[c]={};var d;if(c!=i){d=true}else{if(j.alwaysHide&&((b.offsetHeight>0&&j.height)||b.offsetWidth>0&&j.width)){d=true;this.selfHidden=true}}this.fireEvent(d?"background":"active",[this.togglers[c],b]);for(var a in m){k[c][a]=d?0:b[m[a]]}if(!p&&!d&&j.resetHeight){k[c].height="auto"}},this);this.internalChain.clearChain();this.internalChain.chain(function(){if(j.resetHeight&&!this.selfHidden){var a=l[i];if(a){a.setStyle("height","auto")}}}.bind(this));return p?this.start(k):this.set(k).internalChain.callChain()}});var Accordion=new Class({Extends:Fx.Accordion,initialize:function(){this.parent.apply(this,arguments);var b=Array.link(arguments,{container:Type.isElement});this.container=b.container},addSection:function(j,f,h){j=document.id(j);f=document.id(f);var i=this.togglers.contains(j);var g=this.togglers.length;if(g&&(!i||h)){h=h!=null?h:g-1;j.inject(this.togglers[h],"before");f.inject(j,"after")}else{if(this.container&&!i){j.inject(this.container);f.inject(this.container)}}return this.parent.apply(this,arguments)}});(function(){Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:true},initialize:function(h,a){this.element=this.subject=document.id(h);this.parent(a);if(typeOf(this.element)!="element"){this.element=document.id(this.element.getDocument().body)}if(this.options.wheelStops){var g=this.element,f=this.cancel.pass(false,this);this.addEvent("start",function(){g.addEvent("mousewheel",f)},true);this.addEvent("complete",function(){g.removeEvent("mousewheel",f)},true)}},set:function(){var a=Array.flatten(arguments);if(Browser.firefox){a=[Math.round(a[0]),Math.round(a[1])]}this.element.scrollTo(a[0],a[1]);return this},compute:function(e,f,a){return[0,1].map(function(c){return Fx.compute(e[c],f[c],a)})},start:function(f,e){if(!this.check(f,e)){return this}var a=this.element.getScroll();return this.parent([a.x,a.y],[f,e])},calculateScroll:function(m,n){var p=this.element,r=p.getScrollSize(),l=p.getScroll(),a=p.getSize(),q=this.options.offset,k={x:m,y:n};for(var o in k){if(!k[o]&&k[o]!==0){k[o]=l[o]}if(typeOf(k[o])!="number"){k[o]=r[o]-a[o]}k[o]+=q[o]}return[k.x,k.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(false,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,false))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",false))},toBottom:function(){return this.start.apply(this,this.calculateScroll(false,"bottom"))},toElement:function(g,f){f=f?Array.from(f):["x","y"];var h=b(this.element)?{x:0,y:0}:this.element.getScroll();var a=Object.map(document.id(g).getPosition(this.element),function(c,d){return f.contains(d)?c+h[d]:false});return this.start.apply(this,this.calculateScroll(a.x,a.y))},toElementEdge:function(p,m,o){m=m?Array.from(m):["x","y"];p=document.id(p);var k={},n=p.getPosition(this.element),a=p.getSize(),l=this.element.getScroll(),r=this.element.getSize(),q={x:n.x+a.x,y:n.y+a.y};["x","y"].each(function(c){if(m.contains(c)){if(q[c]>l[c]+r[c]){k[c]=q[c]-r[c]}if(n[c]<l[c]){k[c]=n[c]}}if(k[c]==null){k[c]=l[c]}if(o&&o[c]){k[c]=k[c]+o[c]}},this);if(k.x!=l.x||k.y!=l.y){this.start(k.x,k.y)}return this},toElementCenter:function(n,m,k){m=m?Array.from(m):["x","y"];n=document.id(n);var j={},p=n.getPosition(this.element),o=n.getSize(),a=this.element.getScroll(),l=this.element.getSize();["x","y"].each(function(c){if(m.contains(c)){j[c]=p[c]-(l[c]-o[c])/2}if(j[c]==null){j[c]=a[c]}if(k&&k[c]){j[c]=j[c]+k[c]}},this);if(j.x!=a.x||j.y!=a.y){this.start(j.x,j.y)}return this}});Fx.Scroll.implement({scrollToCenter:function(){return this.toElementCenter.apply(this,arguments)},scrollIntoView:function(){return this.toElementEdge.apply(this,arguments)}});function b(a){return(/^(?:body|html)$/i).test(a.tagName)}})();Fx.Slide=new Class({Extends:Fx,options:{mode:"vertical",wrapper:false,hideOverflow:true,resetHeight:false},initialize:function(e,f){e=this.element=this.subject=document.id(e);this.parent(f);f=this.options;var g=e.retrieve("wrapper"),h=e.getStyles("margin","position","overflow");if(f.hideOverflow){h=Object.append(h,{overflow:"hidden"})}if(f.wrapper){g=document.id(f.wrapper).setStyles(h)}if(!g){g=new Element("div",{styles:h}).wraps(e)}e.store("wrapper",g).setStyle("margin",0);if(e.getStyle("overflow")=="visible"){e.setStyle("overflow","hidden")}this.now=[];this.open=true;this.wrapper=g;this.addEvent("complete",function(){this.open=(g["offset"+this.layout.capitalize()]!=0);if(this.open&&this.options.resetHeight){g.setStyle("height","")}},true)},vertical:function(){this.margin="margin-top";this.layout="height";this.offset=this.element.offsetHeight},horizontal:function(){this.margin="margin-left";this.layout="width";this.offset=this.element.offsetWidth},set:function(b){this.element.setStyle(this.margin,b[0]);this.wrapper.setStyle(this.layout,b[1]);return this},compute:function(f,d,e){return[0,1].map(function(a){return Fx.compute(f[a],d[a],e)})},start:function(h,l){if(!this.check(h,l)){return this}this[l||this.options.mode]();var m=this.element.getStyle(this.margin).toInt(),n=this.wrapper.getStyle(this.layout).toInt(),i=[[m,n],[0,this.offset]],j=[[m,n],[-this.offset,0]],k;switch(h){case"in":k=i;break;case"out":k=j;break;case"toggle":k=(n==0)?i:j}return this.parent(k[0],k[1])},slideIn:function(b){return this.start("in",b)},slideOut:function(b){return this.start("out",b)},hide:function(b){this[b||this.options.mode]();this.open=false;return this.set([-this.offset,0])},show:function(b){this[b||this.options.mode]();this.open=true;return this.set([0,this.offset])},toggle:function(b){return this.start("toggle",b)}});Element.Properties.slide={set:function(b){this.get("slide").cancel().setOptions(b);return this},get:function(){var b=this.retrieve("slide");if(!b){b=new Fx.Slide(this,{link:"cancel"});this.store("slide",b)}return b}};Element.implement({slide:function(i,h){i=i||"toggle";var f=this.get("slide"),g;switch(i){case"hide":f.hide(h);break;case"show":f.show(h);break;case"toggle":var j=this.retrieve("slide:flag",f.open);f[j?"slideOut":"slideIn"](h);this.store("slide:flag",!j);g=true;break;default:f.start(i,h)}if(!g){this.eliminate("slide:flag")}return this}});var Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:false,style:true,limit:false,handle:false,invert:false,preventDefault:false,stopPropagation:false,modifiers:{x:"left",y:"top"}},initialize:function(){var c=Array.link(arguments,{options:Type.isObject,element:function(a){return a!=null}});this.element=document.id(c.element);this.document=this.element.getDocument();this.setOptions(c.options||{});var d=typeOf(this.options.handle);this.handles=((d=="array"||d=="collection")?$$(this.options.handle):document.id(this.options.handle))||this.element;this.mouse={now:{},pos:{}};this.value={start:{},now:{}};this.selection=(Browser.ie)?"selectstart":"mousedown";if(Browser.ie&&!Drag.ondragstartFixed){document.ondragstart=Function.from(false);Drag.ondragstartFixed=true}this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:Function.from(false)};this.attach()},attach:function(){this.handles.addEvent("mousedown",this.bound.start);return this},detach:function(){this.handles.removeEvent("mousedown",this.bound.start);return this},start:function(r){var i=this.options;if(r.rightClick){return}if(i.preventDefault){r.preventDefault()}if(i.stopPropagation){r.stopPropagation()}this.mouse.start=r.page;this.fireEvent("beforeStart",this.element);var p=i.limit;this.limit={x:[],y:[]};var n,l;for(n in i.modifiers){if(!i.modifiers[n]){continue}var q=this.element.getStyle(i.modifiers[n]);if(q&&!q.match(/px$/)){if(!l){l=this.element.getCoordinates(this.element.getOffsetParent())}q=l[i.modifiers[n]]}if(i.style){this.value.now[n]=(q||0).toInt()}else{this.value.now[n]=this.element[i.modifiers[n]]}if(i.invert){this.value.now[n]*=-1}this.mouse.pos[n]=r.page[n]-this.value.now[n];if(p&&p[n]){var o=2;while(o--){var m=p[n][o];if(m||m===0){this.limit[n][o]=(typeof m=="function")?m():m}}}}if(typeOf(this.options.grid)=="number"){this.options.grid={x:this.options.grid,y:this.options.grid}}var k={mousemove:this.bound.check,mouseup:this.bound.cancel};k[this.selection]=this.bound.eventStop;this.document.addEvents(k)},check:function(d){if(this.options.preventDefault){d.preventDefault()}var c=Math.round(Math.sqrt(Math.pow(d.page.x-this.mouse.start.x,2)+Math.pow(d.page.y-this.mouse.start.y,2)));if(c>this.options.snap){this.cancel();this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop});this.fireEvent("start",[this.element,d]).fireEvent("snap",this.element)}},drag:function(d){var e=this.options;if(e.preventDefault){d.preventDefault()}this.mouse.now=d.page;for(var f in e.modifiers){if(!e.modifiers[f]){continue}this.value.now[f]=this.mouse.now[f]-this.mouse.pos[f];if(e.invert){this.value.now[f]*=-1}if(e.limit&&this.limit[f]){if((this.limit[f][1]||this.limit[f][1]===0)&&(this.value.now[f]>this.limit[f][1])){this.value.now[f]=this.limit[f][1]}else{if((this.limit[f][0]||this.limit[f][0]===0)&&(this.value.now[f]<this.limit[f][0])){this.value.now[f]=this.limit[f][0]}}}if(e.grid[f]){this.value.now[f]-=((this.value.now[f]-(this.limit[f][0]||0))%e.grid[f])}if(e.style){this.element.setStyle(e.modifiers[f],this.value.now[f]+e.unit)}else{this.element[e.modifiers[f]]=this.value.now[f]}}this.fireEvent("drag",[this.element,d])},cancel:function(b){this.document.removeEvents({mousemove:this.bound.check,mouseup:this.bound.cancel});if(b){this.document.removeEvent(this.selection,this.bound.eventStop);this.fireEvent("cancel",this.element)}},stop:function(c){var d={mousemove:this.bound.drag,mouseup:this.bound.stop};d[this.selection]=this.bound.eventStop;this.document.removeEvents(d);if(c){this.fireEvent("complete",[this.element,c])}}});Element.implement({makeResizable:function(d){var c=new Drag(this,Object.merge({modifiers:{x:"width",y:"height"}},d));this.store("resizer",c);return c.addEvent("drag",function(){this.fireEvent("resize",c)}.bind(this))}});Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:false,precalculate:false,includeMargins:true,checkDroppables:true},initialize:function(e,f){this.parent(e,f);e=this.element;this.droppables=$$(this.options.droppables);this.container=document.id(this.options.container);if(this.container&&typeOf(this.container)!="element"){this.container=document.id(this.container.getDocument().body)}if(this.options.style){if(this.options.modifiers.x=="left"&&this.options.modifiers.y=="top"){var h=e.getOffsetParent(),g=e.getStyles("left","top");if(h&&(g.left=="auto"||g.top=="auto")){e.setPosition(e.getPosition(h))}}if(e.getStyle("position")=="static"){e.setStyle("position","absolute")}}this.addEvent("start",this.checkDroppables,true);this.overed=null},start:function(b){if(this.container){this.options.limit=this.calculateLimit()}if(this.options.precalculate){this.positions=this.droppables.map(function(a){return a.getCoordinates()})}this.parent(b)},calculateLimit:function(){var w=this.element,B=this.container,C=document.id(w.getOffsetParent())||document.body,y=B.getCoordinates(C),D={},E={},v={},z={},t={};["top","right","bottom","left"].each(function(a){D[a]=w.getStyle("margin-"+a).toInt();E[a]=w.getStyle("border-"+a).toInt();v[a]=B.getStyle("margin-"+a).toInt();z[a]=B.getStyle("border-"+a).toInt();t[a]=C.getStyle("padding-"+a).toInt()},this);var A=w.offsetWidth+D.left+D.right,q=w.offsetHeight+D.top+D.bottom,x=0,u=0,r=y.right-z.right-A,F=y.bottom-z.bottom-q;if(this.options.includeMargins){x+=D.left;u+=D.top}else{r+=D.right;F+=D.bottom}if(w.getStyle("position")=="relative"){var s=w.getCoordinates(C);s.left-=w.getStyle("left").toInt();s.top-=w.getStyle("top").toInt();x-=s.left;u-=s.top;if(B.getStyle("position")!="relative"){x+=z.left;u+=z.top}r+=D.left-s.left;F+=D.top-s.top;if(B!=C){x+=v.left+t.left;u+=((Browser.ie6||Browser.ie7)?0:v.top)+t.top}}else{x-=D.left;u-=D.top;if(B!=C){x+=y.left+z.left;u+=y.top+z.top}}return{x:[x,r],y:[u,F]}},getDroppableCoordinates:function(f){var d=f.getCoordinates();if(f.getStyle("position")=="fixed"){var e=window.getScroll();d.left+=e.x;d.right+=e.x;d.top+=e.y;d.bottom+=e.y}return d},checkDroppables:function(){var b=this.droppables.filter(function(e,f){e=this.positions?this.positions[f]:this.getDroppableCoordinates(e);var a=this.mouse.now;return(a.x>e.left&&a.x<e.right&&a.y<e.bottom&&a.y>e.top)},this).getLast();if(this.overed!=b){if(this.overed){this.fireEvent("leave",[this.element,this.overed])}if(b){this.fireEvent("enter",[this.element,b])}this.overed=b}},drag:function(b){this.parent(b);if(this.options.checkDroppables&&this.droppables.length){this.checkDroppables()}},stop:function(b){this.checkDroppables();this.fireEvent("drop",[this.element,this.overed,b]);this.overed=null;return this.parent(b)}});Element.implement({makeDraggable:function(d){var c=new Drag.Move(this,d);this.store("dragger",c);return c}});(function(){var b=function(e){var a=e.options.hideInputs;if(window.OverText){var f=[null];OverText.each(function(c){f.include("."+c.options.labelClass)});if(f){a+=f.join(", ")}}return(a)?e.element.getElements(a):null};Fx.Reveal=new Class({Extends:Fx.Morph,options:{link:"cancel",styles:["padding","border","margin"],transitionOpacity:!Browser.ie6,mode:"vertical",display:function(){return this.element.get("tag")!="tr"?"block":"table-row"},opacity:1,hideInputs:Browser.ie?"select, input, textarea, object, embed":null},dissolve:function(){if(!this.hiding&&!this.showing){if(this.element.getStyle("display")!="none"){this.hiding=true;this.showing=false;this.hidden=true;this.cssText=this.element.style.cssText;var e=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode});if(this.options.transitionOpacity){e.opacity=this.options.opacity}var f={};Object.each(e,function(c,d){f[d]=[c,0]});this.element.setStyles({display:Function.from(this.options.display).call(this),overflow:"hidden"});var a=b(this);if(a){a.setStyle("visibility","hidden")}this.$chain.unshift(function(){if(this.hidden){this.hiding=false;this.element.style.cssText=this.cssText;this.element.setStyle("display","none");if(a){a.setStyle("visibility","visible")}}this.fireEvent("hide",this.element);this.callChain()}.bind(this));this.start(f)}else{this.callChain.delay(10,this);this.fireEvent("complete",this.element);this.fireEvent("hide",this.element)}}else{if(this.options.link=="chain"){this.chain(this.dissolve.bind(this))}else{if(this.options.link=="cancel"&&!this.hiding){this.cancel();this.dissolve()}}}return this},reveal:function(){if(!this.showing&&!this.hiding){if(this.element.getStyle("display")=="none"){this.hiding=false;this.showing=true;this.hidden=false;this.cssText=this.element.style.cssText;var e;this.element.measure(function(){e=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode})}.bind(this));if(this.options.heightOverride!=null){e.height=this.options.heightOverride.toInt()}if(this.options.widthOverride!=null){e.width=this.options.widthOverride.toInt()}if(this.options.transitionOpacity){this.element.setStyle("opacity",0);e.opacity=this.options.opacity}var f={height:0,display:Function.from(this.options.display).call(this)};Object.each(e,function(c,d){f[d]=0});f.overflow="hidden";this.element.setStyles(f);var a=b(this);if(a){a.setStyle("visibility","hidden")}this.$chain.unshift(function(){this.element.style.cssText=this.cssText;this.element.setStyle("display",Function.from(this.options.display).call(this));if(!this.hidden){this.showing=false}if(a){a.setStyle("visibility","visible")}this.callChain();this.fireEvent("show",this.element)}.bind(this));this.start(e)}else{this.callChain();this.fireEvent("complete",this.element);this.fireEvent("show",this.element)}}else{if(this.options.link=="chain"){this.chain(this.reveal.bind(this))}else{if(this.options.link=="cancel"&&!this.showing){this.cancel();this.reveal()}}}return this},toggle:function(){if(this.element.getStyle("display")=="none"){this.reveal()}else{this.dissolve()}return this},cancel:function(){this.parent.apply(this,arguments);if(this.cssText!=null){this.element.style.cssText=this.cssText}this.hiding=false;this.showing=false;return this}});Element.Properties.reveal={set:function(a){this.get("reveal").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("reveal");if(!a){a=new Fx.Reveal(this);this.store("reveal",a)}return a}};Element.Properties.dissolve=Element.Properties.reveal;Element.implement({reveal:function(a){this.get("reveal").setOptions(a).reveal();return this},dissolve:function(a){this.get("reveal").setOptions(a).dissolve();return this},nix:function(a){var d=Array.link(arguments,{destroy:Type.isBoolean,options:Type.isObject});this.get("reveal").setOptions(a).dissolve().chain(function(){this[d.destroy?"destroy":"dispose"]()}.bind(this));return this},wink:function(){var d=Array.link(arguments,{duration:Type.isNumber,options:Type.isObject});var a=this.get("reveal").setOptions(d.options);a.reveal().chain(function(){(function(){a.dissolve()}).delay(d.duration||2000)})}})})();Fx.Move=new Class({Extends:Fx.Morph,options:{relativeTo:document.body,position:"center",edge:false,offset:{x:0,y:0}},start:function(e){var d=this.element,f=d.getStyles("top","left");if(f.top=="auto"||f.left=="auto"){d.setPosition(d.getPosition(d.getOffsetParent()))}return this.parent(d.position(Object.merge({},this.options,e,{returnPos:true})))}});Element.Properties.move={set:function(b){this.get("move").cancel().setOptions(b);return this},get:function(){var b=this.retrieve("move");if(!b){b=new Fx.Move(this,{link:"cancel"});this.store("move",b)}return b}};Element.implement({move:function(b){this.get("move").start(b);return this}});
EOL.namespace("framework.form");EOL.framework.form.async=function(a,c){this.formEl=a;this.form=$(this.formEl);var d={async:true,hidden:false,errorEl:null,confirmEl:null,mainEl:null,method:"post"};EOL.utility.mergeObjects(d,c);this.options=d;this.loading=false;this.initRequest=false;this.setOptions=function(e){EOL.utility.mergeObjects(this.options,e)};this.beforeError=function(e){};this.afterError=function(e){};if(this.form){var b=this;this.form.onsubmit=function(f){f.preventDefault();b.handleSubmit()}}};EOL.framework.form.async.prototype.validate=function(){return true};EOL.framework.form.async.prototype.handleSubmit=function(){if(this.options.mainEl&&typeof clearFormErrorsAll=="function"){clearFormErrors(this.options.mainEl)}if(this.options.confirmEl){$(this.options.confirmEl).addClass("displayNone")}if(typeof clearFormErrorsAll=="function"&&this.options.errorEl){clearFormErrorsAll(this.options.errorEl)}else{if(this.options.errorEl){$(this.options.errorEl).addClass("displayNone")}}if(!this.validate()){return false}if(!this.options.async){this.form.submit();return true}if(!this.options.hidden){disableElems($(this.options.mainEl))}var b=this;var a={method:this.options.method,onSuccess:function(c){b.handleAjaxSuccess(c)},onFailure:function(c){b.handleAjaxFailure(c)},onComplete:function(c){b.handleAjaxComplete(c)}};if(MooTools.version=="1.11"){this.form.send(a)}else{if(!this.initRequest){this.form.set("send",a);this.initRequest=true}this.form.send()}this.loading=true;return true};EOL.framework.form.async.prototype.handleSubmitHref=function(){this.handleSubmit()};EOL.framework.form.async.prototype.handleAjaxSuccess=function(res){this.responseText=res;this.loading=false;if(!res||res.indexOf("{")==-1){res="{}"}var response=eval("("+res+")");if(!response||!response.status){this.handleFailure();return}if(response.token){EOL.framework.form.resetTokens(response.token)}if(response.status=="success"){this.handleSuccess(response)}else{this.handleError(response)}};EOL.framework.form.async.prototype.handleAjaxFailure=function(a){this.loading=false;if(a.readyState==4&&a.status==0){return}this.handleFailure(a);this.handleAjaxComplete(a)};EOL.framework.form.async.prototype.handleAjaxComplete=function(a){};EOL.framework.form.async.prototype.handleSuccess=function(a){if(a.data&&a.data.confirmURL){window.location.href=a.data.confirmURL}else{if(a.data&&a.data.confirmElemId&&a.data.confirmTitle&&a.data.confirmText){enableElems($(this.options.mainEl));EOL.util.dialog.createConfirmBox(a.data.confirmElemId,a.data.confirmTitle,a.data.confirmText)}else{if(a.data&&a.data.confirmElemId&&a.data.confirmElemId==this.options.confirmEl){enableElems($(this.options.mainEl));$(a.data.confirmElemId).removeClass("displayNone")}else{if(a.data&&a.data.confirmText){enableElems($(this.options.mainEl));if(typeof showInfoDialogText=="function"){showInfoDialogText(a.data.confirmTitle,a.data.confirmText,"INFO")}else{alert(a.data.confirmTitle+": "+a.data.confirmText)}}else{if(!this.options.hidden){enableElems($(this.options.mainEl))}this.handleSuccessDefault(a)}}}}};EOL.framework.form.async.prototype.handleSuccessDefault=function(a){if(!this.options.hidden){window.location.reload(true)}};EOL.framework.form.async.prototype.handleFailure=function(){var b=new Array();b[0]="There was an error communicating with Elance.";var a={errorTitle:"We're Sorry",errorMsgs:b};this.handleError(a)};EOL.framework.form.async.prototype.handleError=function(b){if(this.options.hidden){return}enableElems($(this.options.mainEl));this.beforeError(b);var a=(b.errorTitle?b.errorTitle:"Please correct the following");if(this.options.errorEl&&!b.errorMsgsEl){b.errorMsgsEl=this.options.errorEl}if(typeof flowDisplayErrors=="function"&&b.errorMsgsEl&&$(b.errorMsgsEl)){this.options.errorEl=b.errorMsgsEl;flowDisplayErrors(b)}else{if(typeof flowDisplayErrorsDialogText=="function"){flowDisplayErrorsDialogText(b,a)}else{if(typeof flowDisplayErrorsInfoDialogText=="function"){flowDisplayErrorsInfoDialogText(b,a,"WARN")}else{this.showErrors(b,a)}}}this.afterError(b)};EOL.framework.form.async.prototype.showErrors=function(b,a){var e="";for(var c=0;c<b.errorMsgs.length;c++){e+=(c==0?"":", ")+b.errorMsgs[c]}if(typeof EOL.dialog=="function"){var d={width:"350"};if(this.dialog&&this.dialog.optons&&this.dialog.options.className){d.className=this.dialog.options.className}else{if(this.options&&this.options.dialogClassName){d.className=this.options.dialogClassName}}this.errorDialog=new EOL.dialog([a,e],d);this.errorDialog.show()}else{if(typeof showInfoDialog=="function"){showInfoDialogText(a,e,"WARN")}else{alert(a+": "+e)}}};EOL.framework.form.asyncContent=function(a,b,d){var c=this;var e={loadingEl:null,onComplete:null,mainEl:b};EOL.utility.mergeObjects(e,d);EOL.framework.form.asyncContent.superclass.constructor.call(this,a,e);this.contentEl=b;this.waiting=false;this.handleAjaxSuccess=function(f){this.responseText=f;this.loading=false;this.hideLoading();if(f&&f.replace(/^\s*/,"").indexOf("{")==0){EOL.framework.form.asyncContent.superclass.handleAjaxSuccess.call(this,f);return}if(!f){this.handleFailure();return}this.handleSuccess({data:{html:f}})};this.handleSuccess=function(f){if(f&&f.data&&f.data.html){$(this.contentEl).innerHTML=f.data.html}if(!this.waiting){this.onComplete(f)}};this.showLoading=function(){if(this.options.loadingEl){$(this.options.loadingEl).removeClass("displayNone");$(this.contentEl).addClass("displayNone")}if(!this.options.hidden){disableElems($(this.options.mainEl))}};this.hideLoading=function(){if(this.waiting||this.loading){return false}if(this.options.loadingEl){$(this.options.loadingEl).addClass("displayNone");$(this.contentEl).removeClass("displayNone")}if(!this.options.hidden){enableElems($(this.options.mainEl))}return true};this.onComplete=function(){};if(this.options.onComplete){this.onComplete=this.options.onComplete}};EOL.utility.extend(EOL.framework.form.asyncContent,EOL.framework.form.async);EOL.framework.form.asyncContent.prototype.handleSubmit=function(){if(EOL.framework.form.asyncContent.superclass.handleSubmit.call(this)){this.showLoading()}};EOL.framework.form.dialog=function(d,a,c){var b=this;var e={inlineSuccess:false,inlineErrorEl:false,width:"430",mainEl:d};EOL.utility.mergeObjects(e,c);if(e.inlineErrorEl&&!e.errorEl){e.errorEl=e.inlineErrorEl}EOL.framework.form.dialog.superclass.constructor.call(this,a,e);this.innerElement=$(d);this.beforeShow=function(){};this.afterShow=function(){};this.beforeHide=function(){};this.afterHide=function(){};this.dialog=new EOL.dialog($(d),e);this.dialog.eventHide=function(){b.hide()}};EOL.utility.extend(EOL.framework.form.dialog,EOL.framework.form.async);EOL.framework.form.dialog.prototype.show=function(){this.beforeShow();this.dialog.show();this.afterShow()};EOL.framework.form.dialog.prototype.hide=function(){this.beforeHide();this.dialog.hide();this.afterHide()};EOL.framework.form.dialog.prototype.update=function(){this.beforeShow();this.dialog.update($(this.dialogEl).innerHTML);$(this.dialogEl).innerHTML="";this.afterShow()};EOL.framework.form.dialog.prototype.handleSuccess=function(a){if(!this.options.inlineSuccess){this.dialog.hide()}EOL.framework.form.dialog.superclass.handleSuccess.call(this,a)};EOL.framework.form.dialog.prototype.handleError=function(a){if(this.options.inlineErrorEl){a.errorMsgsEl=this.options.inlineErrorEl}else{this.dialog.hide()}EOL.framework.form.dialog.superclass.handleError.call(this,a)};EOL.framework.form.asyncDialog=function(b,a,d,f,e){var c=this;this.asyncContent=new EOL.framework.form.asyncContent(b,d,a);this.asyncContent.owner=this;this.asyncContent.onComplete=function(g){c.initSelf();c.show();if(a.onComplete){a.onComplete.call(this,g)}};this.dialog=null;this.dialogEl=d;this.dFormEl=f;this.dOpts=e;this.loaded=false;this.initSelf=function(){EOL.framework.form.asyncDialog.superclass.constructor.call(this,this.dialogEl,this.dFormEl,this.dOpts);this.loaded=true;this.afterInitSelf()};this.afterInitSelf=function(){};this.unload=function(){this.loaded=false}};EOL.utility.extend(EOL.framework.form.asyncDialog,EOL.framework.form.dialog);EOL.framework.form.asyncDialog.prototype.show=function(){if(this.loaded){if(this.dOpts.id&&$(this.dOpts.id)){this.update()}else{EOL.framework.form.asyncDialog.superclass.show.call(this)}}else{this.asyncContent.handleSubmit()}};EOL.framework.form.asyncDialog.prototype.hide=function(){if(!this.loaded){return}this.unload();EOL.framework.form.asyncDialog.superclass.hide.call(this)};EOL.framework.form.asyncDialog.prototype.handleSuccess=function(a){this.unload();EOL.framework.form.asyncDialog.superclass.handleSuccess.call(this,a)};EOL.framework.form.resetTokens=function(a){EOL.utility.resetFormTokens(a,"token")};
EOL.namespace("popups");EOL.popups.dialog=null;EOL.popups.open=function(a,c){var b='<div class="popup-loading"></div>';EOL.popups.dialog=new EOL.dialog(b,{position:"fixed"});EOL.popups.dialog.show();new Request.JSONP({url:a,method:"GET",data:{t:new Date().getTime()},onSuccess:function(d){EOL.popups.dialog.update(d.html);if(c){c(d.html)}}}).send();return false};EOL.popups.invite=function(a,b){EOL.popups.invite.redirect=b;EOL.popups.open(a,function(c){if($("popup-invite-opt-elance")){EOL.popups.invite.selectPage($("popup-invite-opt-elance").set("checked",true));EOL.popups.invite.selectTab($$(".popup-invite-tab[rel=other]")[0]);$("popup-invite-message").onchange();EOL.popups.invite.limit=$("elance-invite-limit").get("text");EOL.popups.invite.updateInviteCount(0);EOL.popups.invite.inviteList=null;EOL.popups.invite.checkRequests={}}});return false};EOL.popups.featuredUpsellMaxInvitesReached=function(a){EOL.featuredUpsell.showMaxInvitesReachedModal(a);return false};EOL.popups.featuredUpsellGeneric=function(a){EOL.featuredUpsell.showGenericFeaturedModal(a)};EOL.popups.featuredUpsellRelistFeaturedJob=function(a){var b=new EOL.featuredUpsell.relistFeaturedJobModal({jobId:a,onRelistSuccess:function(d){if(d.data.hasReachedRelistLimit){$$("#jobActionsDropDown .action_relist").addClass("displayNone")}if(!EOL.popups.relistMessage){EOL.popups.relistMessage=EOL.utility.createConfirmMessage({subheaderContent:"Your job has been relisted."});EOL.popups.relistMessage.inject($$(".proposal-page-container")[0],"top")}else{EOL.popups.relistMessage.show()}b.hide();var c=$("proposal-info-details").getElements(".proposal-spr-posted span.smart-info-container");if(c&&c[0]){c[0].set("text","Relisted: Just Now")}var e=$("proposal-info-items").getElements(".proposal-spr-timeleft span.smart-info-container");if(e&&e[0]){e[0].set("text","Time Left: "+d.data.timeLeft)}}});b.open()};EOL.popups.featuredUpsellRelistAsFeatured=function(a){EOL.featuredUpsell.showRelistAsFeaturedModal(a)};EOL.popups.decline=function(a){return EOL.popups.open(a)};EOL.popups.award=function(a){if(EOL.jobTeam&&EOL.jobTeam.addToTeamDialogShown){return false}return EOL.popups.open(a,function(){if($("award-msDate")){new Picker.Date($("award-msDate"),{positionOffset:{x:-5,y:5},pickerClass:"datepicker_elance",toggle:$("award-msDate-calendar"),format:"%m/%d/%Y",startDay:0,onSelect:function(c){EOL.popups.award.prebidCheck(c,"award-msDate")}})}var b=0;while($("award-msDate_"+b)){new Picker.Date($("award-msDate_"+b),{positionOffset:{x:-5,y:5},pickerClass:"datepicker_elance",toggle:$("award-msDate-calendar_"+b),format:"%m/%d/%Y",startDay:0});b++}if($("award-endDate")){new Picker.Date($("award-endDate"),{positionOffset:{x:-5,y:5},pickerClass:"datepicker_elance",toggle:$("award-endDate-calendar"),format:"%m/%d/%Y",startDay:0,minDate:new Date(),onSelect:EOL.popups.award.updateDuration});EOL.popups.award.updateDuration(new Date($("award-endDate").value),"award-terms-form")}if($("award-prebid-form")){if(!$("award-reuse-terms")||!$("award-reuse-terms").checked){EOL.popups.disable("award-prebid-buttons")}$$(".award-prebid-input").each(function(c){c.addEvent("keyup",EOL.popups.award.prebidCheck)})}if($("award-reuse-terms")){EOL.popups.award.switchTerms($("award-reuse-terms").checked)}})};EOL.popups.award.prebidCheck=function(a,c){if(a instanceof Date&&$(c)){$(c).removeClass("popup-input-default")}var b=true;$$(".award-prebid-input").each(function(d){if(!d.value||d.hasClass("popup-input-default")){b=false}});if(b){if($("award-terms-link").hasClass("displayNone")){EOL.popups.enable("award-prebid-buttons")}}else{if(!$("award-terms-link").hasClass("displayNone")){EOL.popups.disable("award-prebid-buttons")}}};EOL.popups.award.updateDuration=function(f,g){if(!g){g=($("award-previous-terms").hasClass("displayNone"))?"award-prebid-form":"award-terms-form"}if(!$(g)){return}var a=new Date();var d=a.getTime();var b=f.getTime();var e=Math.max(1,Math.ceil((b-d)/(1000*60*60*24)));var c=Math.floor(e/7);var h=e%7;if(c>0){$(g).getElementById("award-duration-weeksNumber").innerHTML=c;if(c==1){$(g).getElementById("award-duration-week").removeClass("displayNone");$(g).getElementById("award-duration-weeks").addClass("displayNone")}else{$(g).getElementById("award-duration-week").addClass("displayNone");$(g).getElementById("award-duration-weeks").removeClass("displayNone")}$(g).getElementById("award-duration-weeksNote").removeClass("displayNone")}else{$(g).getElementById("award-duration-weeksNote").addClass("displayNone")}if(h>0||c==0){$(g).getElementById("award-duration-daysNumber").innerHTML=h;if(h==1){$(g).getElementById("award-duration-day").removeClass("displayNone");$(g).getElementById("award-duration-days").addClass("displayNone")}else{$(g).getElementById("award-duration-day").addClass("displayNone");$(g).getElementById("award-duration-days").removeClass("displayNone")}$(g).getElementById("award-duration-daysNote").removeClass("displayNone")}else{$(g).getElementById("award-duration-daysNote").addClass("displayNone")}$(g).getElement("div.award-field-note").removeClass("displayNone")};EOL.popups.cancel=function(a){EOL.popups.open(a,function(b){$("popup-cancel-comments").onchange()});return false};EOL.popups.extend=function(a){EOL.popups.open(a,function(b){var c=$("popup-extend-min").get("value");var e=$("popup-extend-max").get("value");var d=new Picker.Date($("popup-extend-until"),{minDate:Date.parse(c),maxDate:Date.parse(e),positionOffset:{x:-5,y:5},pickerClass:"datepicker_elance",toggle:$("popup-extend-calendar"),startDay:0,format:"%b %e, %Y"});$("popup-extend-reason").onchange()});return false};EOL.popups.closeJob=function(a){EOL.popups.open(a,function(b){$("popup-close-reason").onchange()});return false};EOL.popups.repost=function(a){EOL.popups.open(a,function(b){var c=$("popup-repost-close-reason");if(c){c.onchange()}});return false};EOL.popups.close=function(){if(EOL.popups.confirmDialog){EOL.popups.confirmDialog.hide();EOL.popups.confirmDialog=null}if(EOL.popups.dialog){EOL.popups.dialog.hide()}return false};EOL.popups.invite.inviteList=null;EOL.popups.invite.checkRequests={};EOL.popups.invite.initInviteElance=function(){var c=$("invite-elance-area");if(!c){return}if(c.hasClass("popup-input-default")){c.set("value","").removeClass("popup-input-default")}if($("invite-elance-area-placeholder")){$("invite-elance-area-placeholder").addClass("displayNone")}if(EOL.popups.invite.inviteList){EOL.popups.invite.inviteList.container.show();EOL.popups.invite.inviteList.focusLast();return}var b=$("invite-suggest-url");if(!b){return}b=b.get("value").trim();if(!b.length){return}var a=$("invite-check-url");if(!a){return}a=a.get("value").trim();if(!a.length){return}EOL.popups.invite.inviteList=new TextboxList("invite-elance-area",{max:Math.min(EOL.popups.invite.limit,50),unique:true,startEditableBit:false,inBetweenEditableBits:false,plugins:{autocomplete:{queryRemote:true,placeholder:"",remote:{url:b}}},bitsOptions:{editable:{addOnBlur:false}},onBitBoxAdd:function(e){if(e.value[0]==null){e.value[0]=e.value[1];e.value[2]="<i>"+e.value[1]+"</i>";e.update(e.value);e.bit.addClass("textboxlist-bit-box-pending")}if(e.value&&e.bit.hasClass("textboxlist-bit-box-pending")){var d=e.value[0];if(EOL.popups.invite.checkRequests[d]){EOL.popups.invite.checkRequests[d].cancel()}EOL.popups.invite.checkRequests[d]=new Request.JSON({url:a,method:"POST",data:{search:d},onComplete:function(){EOL.popups.invite.checkRequests[d]=null},onSuccess:function(f){if(f.status=="success"){e.update(f.data);e.bit.removeClass("textboxlist-bit-box-pending")}else{e.bit.addClass("textboxlist-bit-box-error");$("invite-elance-nouser").removeClass("displayNone")}}}).send()}EOL.popups.invite.updateInviteCount(EOL.popups.invite.inviteList.getValues().length)},onBitBoxRemove:function(e){if(e.value){var d=e.value[0];if(EOL.popups.invite.checkRequests[d]){EOL.popups.invite.checkRequests[d].cancel()}}if($$(".textboxlist-bit-box-error").length<1){$("invite-elance-nouser").addClass("displayNone")}EOL.popups.invite.updateInviteCount(EOL.popups.invite.inviteList.getValues().length)},onBitEditableFocus:function(d){if(d.textboxlist.getValues().length>=d.textboxlist.options.max){d.blur()}},onBitBlur:function(d){if(!EOL.popups.invite.inviteList.getValues().length){if($("invite-elance-area-placeholder")){$("invite-elance-area-placeholder").removeClass("displayNone")}EOL.popups.invite.inviteList.container.hide()}}});EOL.popups.invite.inviteList.focusLast()};EOL.popups.invite.updateInviteCount=function(b){var d=$("elance-invite-limit");if(!d){return}var c=Math.min(EOL.popups.invite.limit,50)-b;var a=EOL.popups.invite.limit-b;d.set("text",a);$("invite-elance-limit").toggleClass("popup-limit-reached",a<1);if(c<1&&EOL.popups.invite.inviteList){EOL.popups.invite.inviteList.blur()}};EOL.popups.invite.selectTab=function(b){b=$(b);b.getSiblings(".popup-invite-tab").removeClass("popup-invite-tab-selected");b.addClass("popup-invite-tab-selected");var a=$("popup-invite-"+b.get("rel"));if(!a){return false}$$(".popup-invite-page").addClass("displayNone");a.removeClass("displayNone");return false};EOL.popups.invite.selectPage=function(b){b=$(b);if(!b.get("checked")){return}var a=$("popup-invite-"+b.get("rel"));if(!a){return}$$(".popup-invite-subpage").addClass("displayNone");a.removeClass("displayNone")};EOL.popups.invite.sendEmail=function(f,a){var c=$("popup-invite-email");if(!c){return false}var b=$("popup-invite-message");if(!b){return false}var d={type:"email",message:b.get("value"),emails:c.get("value")};var e=$("popup-email-copy");if(e&&e.get("checked")){d.copy=true}EOL.popups.invite.send(a,d,"popup-invite-error");return false};EOL.popups.invite.sendElance=function(d,a){var f=$("invite-elance-area");if(!f){return false}var b=EOL.popups.invite.inviteList.getBit(EOL.popups.invite.inviteList.list.getLast());if(b&&b.type=="editable"){b.toBox()}var e=f.hasClass("popup-input-default")?"":f.get("value");var c={type:"elance",users:e};EOL.popups.invite.send(a,c,"invite-elance-error");return false};EOL.popups.confirmDialog=null;EOL.popups.invite.send=function(a,c,b){$(b).addClass("displayNone");EOL.popups.disable("popup-invite-other");new Request.JSON({url:a,method:"POST",data:c,onComplete:function(){EOL.popups.enable("popup-invite-other")},onFailure:function(){$(b).set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(d){if(d.html){EOL.popups.confirmDialog=new EOL.dialog(d.html,{afterShow:function(){var e=$("popup-invite-confirm-ok");if(e){e=e.get("value")}EOL.popups.confirmDialog.isOk=e},afterHide:function(){if(!this.goBack){if(EOL.popups.confirmDialog.isOk&&EOL.popups.invite.redirect){window.location.href=EOL.popups.invite.redirect}else{EOL.popups.close()}}}});$(EOL.popups.dialog.containerEl).addClass("displayNone");EOL.popups.confirmDialog.show()}else{if(!d.error){d.error="Unknown error. Please try again later."}}if(d.error){$(b).set("html",d.error).removeClass("displayNone")}}}).send()};EOL.popups.invite.back=function(){EOL.popups.confirmDialog.goBack=true;EOL.popups.confirmDialog.hide();EOL.popups.confirmDialog.goBack=false;$(EOL.popups.dialog.containerEl).removeClass("displayNone");return false};EOL.popups.decline.reasonChanged=function(b,a){var d=$("popup-decline-other-div");if(d){var c=$(b).get("value");d.toggleClass("displayNone",c!=a)}};EOL.popups.decline.submit=function(b,c,d){var e=$("popup-decline-reason");if(!e){return}e=e.get("value");var a=$("popup-decline-other");a=a?a.get("value"):"";$("popup-decline-error").addClass("displayNone");EOL.popups.disable("popup-decline");new Request.JSON({url:b,method:"POST",data:{reason:e,other:a},onComplete:function(){EOL.popups.enable("popup-decline")},onFailure:function(){$("popup-decline-error").set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(f){if(f.status=="success"){EOL.popups.close();EOL.proposals.removeBidCard(c,"declined")}else{if(!f.error){f.error="Unknown error. Please try again later."}$("popup-decline-error").set("html",f.error).removeClass("displayNone")}}}).send();return false};EOL.popups.award.switchTerms=function(a){if(a){$("award-bid-terms").addClass("displayNone");$("award-previous-terms").removeClass("displayNone");if($("award-prebid-form")){if($("award-terms-link").hasClass("displayNone")){EOL.popups.enable("award-prebid-buttons")}}}else{$("award-previous-terms").addClass("displayNone");$("award-bid-terms").removeClass("displayNone");if($("award-prebid-form")){EOL.popups.award.prebidCheck()}}};EOL.popups.award.updateTermsUrl=function(){var a=$("award-terms-url").innerHTML;if($("award-reuse-terms")&&$("award-reuse-terms").checked){a+="&"+$("award-terms-form").toQueryString();a+="&prevTerms=1"}else{if($("award-prebid-form")){a+="&"+$("award-prebid-form").toQueryString()}}if($("award-keep-open")&&$("award-keep-open").checked){a+="&keepOpen=Y"}else{a+="&keepOpen=N"}$("award-terms-link").href=a};EOL.popups.award.submit=function(b){var c="";var a=$("award-keep-open");if(a&&a.get("checked")){c+="&keepOpen=1"}var e=$("award-reuse-terms");if(e&&e.get("checked")){c+="&reuseTerms=1";if($("award-terms-form")){c+="&"+$("award-terms-form").toQueryString()}}else{if($("award-prebid-form")){c+="&"+$("award-prebid-form").toQueryString()}}$("popup-award-error").addClass("displayNone");EOL.popups.disable("popup-award");if(typeof(ioGetBlackbox)=="function"){var d=ioGetBlackbox();if(d.finished){c+="&ioBB="+d.blackbox}}new Request.JSON({url:b,method:"POST",data:c,onComplete:function(){EOL.popups.enable("popup-award")},onFailure:function(){$("popup-award-error").set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(f){if(f.status=="success"){window.location.href=f.redirect}else{if(!f.error){f.error="Unknown error. Please try again later."}$("popup-award-error").set("html",f.error).removeClass("displayNone")}}}).send();return false};EOL.popups.preaward=new Object();EOL.popups.preaward.submit=function(c,a){var b=$("preaward-terms-form").toQueryString();$("popup-preaward-error").addClass("displayNone");EOL.popups.disable("popup-preaward");new Request.JSON({url:c,method:"POST",data:b,onComplete:function(){EOL.popups.enable("popup-preaward")},onFailure:function(){$("popup-preaward-error").set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(d){if(d.status=="success"){EOL.popups.close();EOL.popups.award(a)}else{if(!d.error){d.error="Unknown error. Please try again later."}$("popup-preaward-error").set("html",d.error).removeClass("displayNone")}}}).send();return false};EOL.popups.preaward.poSelectChanged=function(){var a=$("new-po-box");if($("po-select").get("value")=="+"){a.removeClass("displayNone")}else{if(!a.hasClass("displayNone")){a.addClass("displayNone")}}};EOL.popups.preaward.newPoFocus=function(a){var c=$(a).get("value");var b=$(a).get("data-dummy-text");if(c==b){$(a).set("value","");$(a).removeClass("dummy-text")}};EOL.popups.preaward.newPoBlur=function(a){var c=$(a).get("value");var b=$(a).get("data-dummy-text");if(c==""){$(a).set("value",b);if(!$(a).hasClass("dummy-text")){$(a).addClass("dummy-text")}}};EOL.popups.cancel.reasonChange=function(c,b){var d="";if(c.get("value")==b){d=$("popup-cancel-required").get("value")}else{d=$("popup-cancel-optional").get("value")}var a=$("popup-cancel-comments");if(a.hasClass("popup-input-default")){a.set("value",d)}else{a.store("default",d)}};EOL.popups.cancel.submit=function(a,d){var b=$("popup-cancel-reason");if(!b){return false}b=b.get("value");var c=$("popup-cancel-comments");if(!c){return false}if(c.hasClass("popup-input-default")){c=""}else{c=c.get("value")}$("popup-cancel-error").addClass("displayNone");EOL.popups.disable("popup-cancel");new Request.JSON({url:a,method:"POST",data:{reason:b,comments:c},onFailure:function(){EOL.popups.enable("popup-cancel");$("popup-cancel-error").set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(e){if(e.status=="success"){if(EOL.myjobs){window.location.href="?confirmMode=cancelJob&jobid="+d}else{window.location.href="?confirm=cancel"}}else{EOL.popups.enable("popup-cancel");if(!e.error){e.error="Unknown error. Please try again later."}$("popup-cancel-error").set("html",e.error).removeClass("displayNone")}}}).send();return false};EOL.popups.extend.submit=function(a){var b=$("popup-extend-reason");b=b?b.get("value"):"";var c=$("popup-extend-until");if(!c){return}c=c.get("value");$("popup-extend-error").addClass("displayNone");EOL.popups.disable("popup-extend");new Request.JSON({url:a,method:"POST",data:{reason:b,until:c},onFailure:function(){EOL.popups.enable("popup-extend");$("popup-extend-error").set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(d){if(d.status=="success"){if(EOL.myjobs){window.location.href="?confirmMode=extendJob&date="+c}else{window.location.href="?confirm=extend"}}else{EOL.popups.enable("popup-extend");if(!d.error){d.error="Unknown error. Please try again later."}$("popup-extend-error").set("html",d.error).removeClass("displayNone")}}}).send();return false};EOL.popups.closeJob.submit=function(c,a,d,b,e){if(!d){d="popup-close-reason"}d=$(d);if(!d){return}if(d.hasClass("popup-input-default")){d=""}else{d=d.get("value")}if(!b){b="popup-close-error"}$(b).addClass("displayNone");if(!a){a="popup-close"}EOL.popups.disable(a);new Request.JSON({url:c,method:"POST",data:{reason:d},onFailure:function(){EOL.popups.enable(a);$(b).set("text","Unknown error. Please try again later.").removeClass("displayNone")},onSuccess:function(f){if(f.status=="success"){if(EOL.myjobs&&!e){e="?confirmMode=closeJob"}else{if(!e){e="?confirm=close"}}window.location.href=e}else{EOL.popups.enable(a);if(!f.error){f.error="Unknown error. Please try again later."}$(b).set("html",f.error).removeClass("displayNone")}}}).send();return false};EOL.popups.repost.submit=function(c,e){var d=$("popup-repost-re-invited");if(d&&d.get("checked")){c+="&inviteAutoInvite=true"}var b=$("popup-repost-re-bid");if(b&&b.get("checked")){c+="&bidAutoInvite=true"}var a=$("popup-repost-close-yes");if(a&&a.get("checked")){EOL.popups.closeJob.submit(e,"popup-repost","popup-repost-close-reason","popup-repost-error",c)}else{window.location.href=c}return false};EOL.popups.repost.track=function(){var a=getCookie("userid");$el("send","useraction","CLICK","Job",{userId:a,pageName:"JobRepost"})};EOL.popups.paymentBlock=function(a){return EOL.popups.open(a)};EOL.popups.enable=function(c,b){var a=$(c);if(!a){return}a.getElements(".disable-disable").set("disabled",b);a.getElements(".disable-hide").toggleClass("displayNone",b);a.getElements(".disable-show").toggleClass("displayNone",!b)};EOL.popups.disable=function(a){EOL.popups.enable(a,true)};EOL.popups.handleInputDefault=function(b,a){b=$(b);if(a&&!b.hasClass("popup-input-default")){return}if(a){b.store("default",b.get("value")).set("value","").removeClass("popup-input-default")}else{if(!b.get("value").trim().length){b.set("value",b.retrieve("default")).addClass("popup-input-default")}}};EOL.popups.autoCompleteInitiated=false;EOL.popups.autoCompleteList=[];EOL.popups.autoComplete=function(){var a=[];var b=$("new-po-value").value;var e=EOL.popups.getAutoCompleteList();for(var c=0;c<e.length;c++){var d=e[c];if(d.value.indexOf(b)>-1){a.push(d)}}EOL.popups.formatHTMLAutoCompleteList(a)};EOL.popups.getAutoCompleteList=function(){if(!EOL.popups.autoCompleteInitiated){$("po-autocomplete-list").getChildren(".autocomplete-list-item").each(function(a){EOL.popups.autoCompleteList.push({id:a.getElement(".autocomplete-ids").value,value:a.getElement(".autocomplete-values").value,description:a.getElement(".autocomplete-descriptions").value})});EOL.popups.autoCompleteInitiated=true}return EOL.popups.autoCompleteList};EOL.popups.formatHTMLAutoCompleteList=function(d){$("po-autocomplete-ul").empty();for(var b=0;b<d.length;b++){var a=$("autocompleteTemplate");var c=a.clone().cloneEvents(a);var e=d[b];c.set("html",e.value+" - "+e.description);c.set("poNumberId",e.id);c.show();$("po-autocomplete-ul").grab(c)}$("po-autocomplete").show()};EOL.popups.selectAutoComplete=function(a){var b=a.get("poNumberId");$("po-select").set("value",b);$("new-po-box").addClass("displayNone")};EOL.popups.getPODescriptionByValue=function(){var a=$("new-po-value").value;var c=JSON.parse($("pos").value);var b=false;if($("continue_po_btn").isDisplayed()){$("continue_btn").show();$("continue_po_btn").hide()}c.each(function(d){if(a.toLowerCase().trim()==d.value.trim().toLowerCase()){EOL.popups.preaward.newPoFocus($("new-po-desc"));$("new-po-desc").value=d.description;$("new-po-value").value=d.value;$("continue_btn").hide();$("continue_po_btn").show();b=true}});$("new-po-desc").readOnly=b};EOL.popups.saveExistingPOasNew=function(f,a){var e=$("new-po-value").value.trim();var b=null;var d=null;var g=JSON.parse($("pos").value);g.each(function(h){if(e==h.value){d=h.valueId;b=h.description}});if(d){var c=new Element("option",{value:d,text:e+" ("+b+")"});$("po-select").grab(c);$("po-select").value=""+d;$("new-po-box").addClass("displayNone");$("continue_po_btn").hide();EOL.popups.preaward.submit(f,a)}};$(window).addEvent("domready",function(){var a=$("confirmInvite");if(a){EOL.popups.confirmDialog=new EOL.dialog(a.get("html"));EOL.popups.confirmDialog.show()}});
function archiveJob(e,b){var d=function(f){window.location.reload()};var a="jobid="+e+"&bidid="+b+"&action=ArchiveJob";var c=new Request({url:"/php/project/main/projectAHR.php",method:"post",data:a,onSuccess:function(f){d(f)}});c.send()}var clickAwayRecent=function(b){var a=null;if(window.event){a=window.event.srcElement}else{a=(b.target.tagName)?b.target:b.target.parentNode}do{if(a.id=="wr-recent-c"||a.id=="wr-recent-title"){return}}while(a=a.parentNode);closeRecent()};function openRecent(c,f){if($("wr-recent-c").style.display==""){closeRecent()}var e=250;var d=($("wr-recent-title").style.pixelWidth)?$("wr-recent-title").style.pixelWidth:$("wr-recent-title").offsetWidth;d=d-22;if(d<e){d=e}$("wr-recent-list").style.width=d+"px";if(!$("wr-recent-list").innerHTML){$("wr-recent-list").innerHTML='<div style="margin: 20px 0px; text-align:center"><img src="/media/images/4.0/ajax-loader.gif"></div>';var b=function(h){if(h.indexOf("<title>Elance: Please Sign In</title>")!=-1){location.reload()}else{$("wr-recent-list").innerHTML=h}};var a="bidid="+c+"&mode=RecentWorkrooms&selected="+f;var g=new Request({url:"/php/project/main/projectSelectHTML.php",method:"post",data:a,onSuccess:function(h){b(h)}});g.send()}$("wr-recent-c").style.display="";$("wr-recent-title").className="wr-recent-title-selected";if(document.addEventListener){document.addEventListener("mousedown",clickAwayRecent,false)}else{if(document.attachEvent){document.attachEvent("onmousedown",clickAwayRecent)}}}function closeRecent(){$("wr-recent-c").style.display="none";$("wr-recent-title").className="wr-recent-title";if(document.removeEventListener){document.removeEventListener("mousedown",clickAwayRecent,false)}else{if(document.detachEvent){document.detachEvent("onmousedown",clickAwayRecent)}}}EOL.namespace("cpanel");EOL.cpanel={bidid:null,jobid:null,dialog:null,joblist:false,curRequest:false,execute:function(c,f,g,d){EOL.cpanel.bidid=c;EOL.cpanel.jobid=g;EOL.cpanel.joblist=d?true:false;if(!EOL.cpanel.dialog){EOL.cpanel.dialog=new EOL.dialog("",{position:"scroll",modal:true,width:450,close:true})}EOL.cpanel.dialog.update('<div style="padding: 20px; text-align: center;"><img border=0 height=32 width=32 src="/media/images/4.0/ajax-loader.gif"></div>');EOL.cpanel.dialog.show();var a=function(h){EOL.cpanel.open(h)};var b="bidid="+c+"&action="+f;var e=new Request({url:"/php/project/main/projectHTML.php",method:"post",data:b,onSuccess:a});e.send()},open:function(a){EOL.cpanel.dialog.update(a);EOL.cpanel.dialog.show()},request:function(action){var isReopenedFeedback=(window.location.href.indexOf("reopenedFeedback=1")!==-1)?true:false;if(EOL.cpanel.curRequest){return}var handleSuccess=function(req){EOL.cpanel.curRequest=false;var response=eval("("+req+")");if(response.status=="success"){if(response.data&&response.data.url){window.location=response.data.url}else{if(EOL.myjobs){EOL.myjobs.results.reload();EOL.cpanel.dialog.hide();return}if(EOL.dashboard){EOL.dashboard.changeContent(1)}if(EOL.cpanel.joblist){EOL.cpanel.highlightJob()}else{if(!EOL.dashboard){var r=(!isReopenedFeedback)?"&reopenedFeedback=1":"";window.location.href=EOL.cpanel.cleanURL(window.location.href+r)}}EOL.cpanel.dialog.hide()}}else{if(response.status=="error"){$("cpanelError").innerHTML=response.errorMsgs[0];$("cpanelError").style.display=""}}};EOL.cpanel.curRequest=true;var postData=$("cpanelForm").toQueryString();postData+="&bidid="+EOL.cpanel.bidid+"&action="+action;var request=new Request({url:"/php/project/main/projectAHR.php",method:"post",data:postData,onSuccess:function(req){handleSuccess(req)}});request.send()},toggle:function(b,a){if($(a).style.display=="none"){$(a).style.display="";if(document.addEventListener){document.addEventListener("mousedown",EOL.cpanel.clickAwayAutopay,false)}else{if(document.attachEvent){document.attachEvent("onmousedown",EOL.cpanel.clickAwayAutopay)}}}else{$(a).style.display="none";if(document.removeEventListener){document.removeEventListener("mousedown",EOL.cpanel.clickAwayAutopay,false)}else{if(document.detachEvent){document.detachEvent("onmousedown",EOL.cpanel.clickAwayAutopay)}}}},clickAwayAutopay:function(b){var a=null;if(window.event){a=window.event.srcElement}else{a=(b.target.tagName)?b.target:b.target.parentNode}do{if(a.id=="cpanel_autopay"||a.id=="cpanel_autopay_toggle"){return}}while(a=a.parentNode);EOL.cpanel.toggle("cpanel_autopay","cpanel_autopay")},gotoTimesheet:function(){var a=getMoreData($("cpanelForm"));if(a.cpanel_srid){window.location.href="/php/statusreport/main/statusReport.php?workviewResume=1&pay=1&mode=minimal&srid="+a.cpanel_srid}else{$("cpanelError").innerHTML="Please select a timesheet";$("cpanelError").style.display=""}},cleanURL:function(a){a=a.replace(/&?caction=(\w+)/gi,"");if(a.search(/\?/)==-1){a+="?"}return a},showNotReadyDialog:function(){if(!EOL.cpanel.notReadyDialog){EOL.cpanel.notReadyDialog=new EOL.dialog($("cpanel_notready_dialog"),{width:450})}EOL.cpanel.notReadyDialog.show()},highlightJob:function(){EOL.cpanel.dialog.hide();var c=EOL.cpanel.jobid;var b=$("jobResultsSection");var a=b.clone(true,true);a.id="oldJobResults";a.inject(b,"after");b.style.display="none";reloadCurrentProjects(function(){var k,g,j,d;if(b.getElement("#job_"+c)){b.style.display="";a.dispose();k=$("job_"+c);g=$("job_"+c+"_bg");j=$("job_"+c+"_right");d=""}else{k=a.getElement("#job_"+c);g=a.getElement("#job_"+c+"_bg");j=a.getElement("#job_"+c+"_right");d="_old"}g.style.backgroundColor="#ffffcc";j.style.backgroundColor="#f1f2b9";var h={duration:2000};if(d){h.onComplete=function(){b.style.display="";a.dispose()};var i=new Fx.Morph(obDiv.id+="_old",{duration:2000,transition:Fx.Transitions.Expo.easeOut,onComplete:function(){}});i.start({height:0,opacity:0})}var f=new Fx.Tween(g.id+=d,h);f.start("backgroundColor","#fff");var e=new Fx.Tween(g.id+=d,{duration:2000});e.start("backgroundColor","#f1f2e9")})}};var args=getArgs();if(args.caction=="toggleAutoPay"){var opener=function(){if($("wr_cpanel_bidid")){var a=$("wr_cpanel_bidid").value;EOL.cpanel.execute(a,"ToggleAutoPay")}};window.addEvent("load",opener)}function checkRulesForTypeSwitch(c){var a="bidid="+c+"&mode=BRC&stage=p_draftswitch";var b="/php/post/main/post.php?mode=switch&bidid="+c;checkRules(c,a,b)}function checkRulesForRepeatProject(c){var a="bidid="+c+"&mode=BRC&stage=p_draftrepeat";var b="/repeat?bidid="+c;checkRules(c,a,b)}function checkRules(c,a,b){var d=new Request.JSON({url:"/php/post/main/postAHR.php",method:"post",data:a,onSuccess:function(e){console.log(e);switch(e.status){case"error":if(!EOL.jobTypeSwitchDialog){EOL.jobTypeSwitchDialog=new EOL.dialog(e.data.dialogContent,{position:"fixed",modal:true,close:true})}else{EOL.jobTypeSwitchDialog.update(e.data.dialogContent)}EOL.jobTypeSwitchDialog.show();break;default:if(e.data.action){b+="&action="+e.data.action}if(e.data.inv){b+="&inv="+e.data.inv}window.location=b;break}}});d.send()}var navigationMetricMap={pmb:"Messages",payments:"Payments",files:"Files",workview:"Workview",statusReports:"StatusReports",terms:"Terms",overview:"Alerts",team:"TeamMembers"};var sendNavigationMetric=function(c,b){if(navigationMetricMap[c]===undefined||navigationMetricMap[b]===undefined){return}var a=navigationMetricMap[c];$el("send","useraction","CLICK","workroom"+a+"Nav",{userId:getCookie("userid"),pageName:"Workroom"+navigationMetricMap[b]})};
var Event=DOMEvent;Event.Keys={};Event.Keys.up=38;Event.Keys.down=40;Event.Keys.enter=13;Event.Keys.left=37;Event.Keys.right=39;Event.Keys.backspace=8;var $chk=function(a){return !!(a||a===0)};var $type=function(a){return typeOf(a)};var $clear=function(a){return window.clearTimeout(a)};var $splat=function(a){return Array.from(a)};var $pick=function(){for(var b=0,a=arguments.length;b<a;b++){if(arguments[b]!=undefined){return arguments[b]}}return null};var TextboxList=new Class({Implements:[Options,Events],plugins:[],options:{prefix:"textboxlist",max:null,unique:false,uniqueInsensitive:true,endEditableBit:true,startEditableBit:true,hideEditableBits:true,inBetweenEditableBits:true,keyboardDeleteEnabled:true,keys:{previous:Event.Keys.left,next:Event.Keys.right},bitsOptions:{editable:{},box:{}},plugins:{},check:function(a){return a.clean().replace(/,/g,"")!=""},encode:function(a){return a.map(function(b){b=($chk(b[0])?b[0]:b[1]);return $chk(b)?b:null}).clean().join(",")},decode:function(a){return a.split(",")}},initialize:function(c,b){this.setOptions(b);this.element=c;this.original=$(c).setStyle("display","none").set("autocomplete","off").addEvent("focus",this.focusLast.bind(this));this.container=new Element("div",{"class":this.options.prefix}).inject(c,"after");this.container.addEvent("click",function(d){if((d.target==this.list||d.target==this.container)&&(!this.focused||$(this.current)!=this.list.getLast())){this.focusLast()}}.bind(this));this.list=new Element("ul",{"class":this.options.prefix+"-bits"}).inject(this.container);for(var a in this.options.plugins){this.enablePlugin(a,this.options.plugins[a])}["check","encode","decode"].each(function(d){this.options[d]=this.options[d].bind(this)},this);this.afterInit()},enablePlugin:function(b,a){this.plugins[b]=new TextboxList[b.camelCase().capitalize()](this,a)},afterInit:function(){if(this.options.unique){this.index=[]}if(this.options.endEditableBit){this.create("editable",null,{tabIndex:this.original.tabIndex}).inject(this.list)}var a=this.update.bind(this);this.addEvent("bitAdd",a,true).addEvent("bitRemove",a,true);document.addEvents({click:function(c){if(!this.focused){return}if(c.target.className.contains(this.options.prefix)){if(c.target==this.container){return}var b=c.target.getParent("."+this.options.prefix);if(b==this.container){return}}this.blur()}.bind(this),keydown:function(c){if(!this.focused||!this.current){return}var f=this.current.is("editable")?this.current.getCaret():null;var e=this.current.getValue()[1];var b=["shift","alt","meta","ctrl"].some(function(g){return c[g]});var d=b||(this.current.is("editable")&&this.current.isSelected());switch(c.code){case Event.Keys.backspace:if(this.current.is("box")&&this.options.keyboardDeleteEnabled){c.stop();return this.current.remove()}case this.options.keys.previous:if(this.current.is("box")||((f==0||!e.length)&&!d)){c.stop();this.focusRelative("previous")}break;case Event.Keys["delete"]:if(this.current.is("box")&&this.options.keyboardDeleteEnabled){c.stop();return this.current.remove()}case this.options.keys.next:if(this.current.is("box")||(f==e.length&&!d)){c.stop();this.focusRelative("next")}}}.bind(this)});this.setValues(this.options.decode(this.original.get("value")))},create:function(a,c,b){if(a=="box"){if((!c[0]&&!c[1])||($chk(c[1])&&!this.options.check(c[1]))){return false}if($chk(this.options.max)&&this.list.getChildren("."+this.options.prefix+"-bit-box").length+1>this.options.max){return false}if(this.options.unique&&this.index.contains(this.uniqueValue(c))){return false}}return new TextboxListBit[a.capitalize()](c,this,Object.merge(this.options.bitsOptions[a],b))},uniqueValue:function(a){return $chk(a[0])?(this.options.uniqueInsensitive?a[0].toLowerCase():a[0]):(this.options.uniqueInsensitive?a[1].toLowerCase():a[1])},onFocus:function(a){if(this.current){this.current.blur()}$clear(this.blurtimer);this.current=a;this.container.addClass(this.options.prefix+"-focus");if(!this.focused){this.focused=true;this.fireEvent("focus",a)}},onBlur:function(b,a){this.current=null;this.container.removeClass(this.options.prefix+"-focus");this.blurtimer=this.blur.delay(a?0:200,this)},onAdd:function(d){if(this.options.unique&&d.is("box")){this.index.push(this.uniqueValue(d.value))}if(d.is("box")){var c=this.getBit($(d).getPrevious());if((c&&c.is("box")&&this.options.inBetweenEditableBits)||(!c&&this.options.startEditableBit)){var a=this.create("editable").inject(c||this.list,c?"after":"top");if(this.options.hideEditableBits){a.hide()}}}},onRemove:function(b){if(this.options.unique&&b.is("box")){this.index.erase(this.uniqueValue(b.value))}var a=this.getBit($(b).getPrevious());if(a&&a.is("editable")){a.remove()}if(this.focused){this.focusRelative("next",b)}},focusRelative:function(c,d){var a=this.getBit($($pick(d,this.current))["get"+c.capitalize()]());if(a){a.focus()}return this},focusLast:function(){var a=this.list.getLast();if(a){this.getBit(a).focus()}return this},blur:function(){if(!this.focused){return this}if(this.current){this.current.blur()}this.focused=false;return this.fireEvent("blur")},add:function(d,f,c,e){var a=this.create("box",[f,d,c]);if(a){if(!e){e=this.list.getLast("."+this.options.prefix+"-bit-box")}a.inject(e||this.list,e?"after":"top")}return this},getBit:function(a){return($type(a)=="element")?a.retrieve("textboxlist:bit"):a},getValues:function(){return this.list.getChildren().map(function(a){var b=this.getBit(a);if(!b||b.is("editable")){return null}return b.getValue()},this).clean()},setValues:function(a){if(!a){return}a.each(function(b){if(b){this.add.apply(this,$type(b)=="array"?[b[1],b[0],b[2]]:[b])}},this)},update:function(){this.original.set("value",this.options.encode(this.getValues()))}});var TextboxListBit=new Class({Implements:Options,initialize:function(c,b,a){this.name=this.type.capitalize();this.value=c;this.textboxlist=b;this.setOptions(a);this.prefix=this.textboxlist.options.prefix+"-bit";this.typeprefix=this.prefix+"-"+this.type;this.bit=new Element("li").addClass(this.prefix).addClass(this.typeprefix).store("textboxlist:bit",this);this.bit.addEvents({mouseenter:function(){this.bit.addClass(this.prefix+"-hover").addClass(this.typeprefix+"-hover")}.bind(this),mouseleave:function(){this.bit.removeClass(this.prefix+"-hover").removeClass(this.typeprefix+"-hover")}.bind(this)})},inject:function(b,a){this.bit.inject(b,a);this.textboxlist.onAdd(this);return this.fireBitEvent("add")},focus:function(){if(this.focused){return this}this.show();this.focused=true;this.textboxlist.onFocus(this);this.bit.addClass(this.prefix+"-focus").addClass(this.prefix+"-"+this.type+"-focus");return this.fireBitEvent("focus")},blur:function(){if(!this.focused){return this}this.focused=false;this.textboxlist.onBlur(this);this.bit.removeClass(this.prefix+"-focus").removeClass(this.prefix+"-"+this.type+"-focus");return this.fireBitEvent("blur")},remove:function(){this.blur();this.textboxlist.onRemove(this);this.bit.destroy();return this.fireBitEvent("remove")},show:function(){this.bit.setStyle("display","block");return this},hide:function(){this.bit.setStyle("display","none");return this},fireBitEvent:function(a){a=a.capitalize();this.textboxlist.fireEvent("bit"+a,this).fireEvent("bit"+this.name+a,this);return this},is:function(a){return this.type==a},setValue:function(a){this.value=a;return this},getValue:function(){return this.value},toElement:function(){return this.bit}});TextboxListBit.Editable=new Class({Extends:TextboxListBit,options:{tabIndex:null,growing:true,growingOptions:{},stopEnter:true,addOnBlur:false,addKeys:Event.Keys.enter},type:"editable",initialize:function(c,b,a){this.parent(c,b,a);this.element=new Element("input",{type:"text","class":this.typeprefix+"-input",autocomplete:"off",value:this.value?this.value[1]:""}).inject(this.bit);if($chk(this.options.tabIndex)){this.element.tabIndex=this.options.tabIndex}if(this.options.growing){new GrowingInput(this.element,this.options.growingOptions)}this.element.addEvents({focus:function(){this.focus(true)}.bind(this),blur:function(){this.blur(true);if(this.options.addOnBlur){this.toBox()}}.bind(this)});if(this.options.addKeys||this.options.stopEnter){this.element.addEvent("keydown",function(d){if(!this.focused){return}if(this.options.stopEnter&&d.code===Event.Keys.enter){d.stop()}if($splat(this.options.addKeys).contains(d.code)){d.stop();this.toBox()}}.bind(this))}},hide:function(){this.parent();this.hidden=true;return this},focus:function(a){this.parent();if(!a){this.element.focus()}return this},blur:function(a){this.parent();if(!a){this.element.blur()}if(this.hidden&&!this.element.value.length){this.hide()}return this},getCaret:function(){if(this.element.createTextRange){var a=document.selection.createRange().duplicate();a.moveEnd("character",this.element.value.length);if(a.text===""){return this.element.value.length}return this.element.value.lastIndexOf(a.text)}else{return this.element.selectionStart}},getCaretEnd:function(){if(this.element.createTextRange){var a=document.selection.createRange().duplicate();a.moveStart("character",-this.element.value.length);return a.text.length}else{return this.element.selectionEnd}},isSelected:function(){return this.focused&&(this.getCaret()!==this.getCaretEnd())},setValue:function(a){this.element.value=$chk(a[0])?a[0]:a[1];if(this.options.growing){this.element.retrieve("growing").resize()}return this},getValue:function(){return[null,this.element.value.replace(/<\/?[^>]+(>|$)/g,""),null]},toBox:function(){var f=this.getValue();var c=f[1].trim().split(/[,;]+/);var a=null;for(var d=0;d<c.length;++d){var e=[f[0],c[d].trim(),f[2]];a=this.textboxlist.create("box",e);if(a){a.inject(this.bit,"before");this.setValue([null,"",null])}}return a}});TextboxListBit.Box=new Class({Extends:TextboxListBit,options:{deleteButton:true},type:"box",initialize:function(c,b,a){this.parent(c,b,a);$chk(this.value[2])?this.bit.set("html",this.value[2]):this.bit.set("text",this.value[1]);this.bit.addEvent("click",this.focus.bind(this));if(this.options.deleteButton){this.bit.addClass(this.typeprefix+"-deletable");this.close=new Element("a",{href:"javascript:void(0);","class":this.typeprefix+"-deletebutton",events:{click:this.remove.bind(this)}}).inject(this.bit)}this.bit.getChildren().addEvent("click",function(d){d.stop()})},update:function(a){this.textboxlist.index.erase(this.textboxlist.uniqueValue(this.getValue()));this.setValue(a);this.textboxlist.index.push(this.textboxlist.uniqueValue(this.getValue()));$chk(this.value[2])?this.bit.set("html",this.value[2]):this.bit.set("text",this.value[1]);if(this.options.deleteButton){this.close.inject(this.bit)}}});
var Event=DOMEvent;Event.Keys={};Event.Keys.up=38;Event.Keys.down=40;Event.Keys.enter=13;Event.Keys.left=37;Event.Keys.right=39;Event.Keys.backspace=8;(function(){TextboxList.Autocomplete=new Class({Implements:Options,options:{minLength:1,maxResults:10,insensitive:true,highlight:true,highlightSelector:null,mouseInteraction:true,onlyFromValues:false,queryRemote:false,remote:{url:"",param:"search",extraParams:{},loadPlaceholder:"Please wait..."},method:"standard",placeholder:"Type to receive suggestions"},initialize:function(b,a){this.setOptions(a);this.textboxlist=b;this.textboxlist.addEvent("bitEditableAdd",this.setupBit.bind(this),true).addEvent("bitEditableFocus",this.search.bind(this),true).addEvent("bitEditableBlur",this.hide.bind(this),true).setOptions({bitsOptions:{editable:{addKeys:[],stopEnter:false}}});if(this.textboxlist.options.unique){this.index=[];this.textboxlist.addEvent("bitBoxRemove",function(c){if(c.autoValue){this.index.erase(c.autoValue)}if(this.currentRequest){this.currentRequest.cancel()}}.bind(this),true).addEvent("bitBoxAdd",function(c){if(this.currentRequest){this.currentRequest.cancel()}}.bind(this),true)}this.prefix=this.textboxlist.options.prefix+"-autocomplete";this.method=TextboxList.Autocomplete.Methods[this.options.method];this.mouse_in_container=false;autocom=this;this.container=new Element("div",{"class":this.prefix}).setStyle("width",this.textboxlist.container.getStyle("width").toFloat()-2).inject(this.textboxlist.container);this.container.addEvents({mouseenter:function(){autocom.mouse_in_container=true},mouseleave:function(){autocom.mouse_in_container=false}});if($chk(this.options.placeholder)||this.options.queryServer){this.placeholder=new Element("div",{"class":this.prefix+"-placeholder"}).inject(this.container)}this.list=new Element("ul",{"class":this.prefix+"-results"}).inject(this.container);this.list.addEvent("click",function(c){c.stop()});this.values=this.results=this.searchValues=[];this.navigate=this.navigate.bind(this)},setValues:function(a){this.values=a},setupBit:function(a){a.element.addEvent("keydown",this.navigate,true).addEvent("keyup",function(){this.search()}.bind(this),true)},search:function(d){if(d){this.currentInput=d}if(!this.options.queryRemote&&!this.values.length){return}var a=this.currentInput.getValue()[1];if(a.length<this.options.minLength){this.showPlaceholder(this.options.placeholder)}if(a==this.currentSearch){return}this.currentSearch=a;this.list.setStyle("display","none");this.container.removeClass("textboxlist-autocomplete-show");if(a.length<this.options.minLength){return}if(this.options.queryRemote){if(this.searchValues[a]){this.values=this.searchValues[a]}else{var c=this.options.remote.extraParams,b=this;if($type(c)=="function"){c=c.apply([],this)}c[this.options.remote.param]=a;if(this.currentRequest){this.currentRequest.cancel()}this.currentRequest=new Request.JSON({url:this.options.remote.url,data:c,onRequest:function(){b.showPlaceholder(b.options.remote.loadPlaceholder)},onSuccess:function(e){if(e.status=="success"){var f=e.data;b.values=f;b.showResults(a)}}}).send()}}},showResults:function(b){var a=this.method.filter(this.values,b,this.options.insensitive,this.options.maxResults+(this.index?this.index.length:0));if(this.index){a=a.filter(function(c){for(var d=this.index.length;d--;){if(this.index[d][0]==c[0]){return false}}return true},this)}a=a.slice(0,this.options.maxResults);this.hidePlaceholder();if(!Object.getLength(a)){return}this.blur();this.container.addClass("textboxlist-autocomplete-show");this.list.empty().setStyle("display","block");Object.each(a,function(c){this.addResult(c,b)},this);if(this.options.onlyFromValues){this.focusFirst()}this.results=a},addResult:function(c,b){var a=new Element("li",{"class":this.prefix+"-result",html:$pick(c[3],c[1])}).store("textboxlist:auto:value",c);this.list.adopt(a);if(this.options.highlight){$$(this.options.highlightSelector?a.getElements(this.options.highlightSelector):a).each(function(d){if(d.get("html")){this.method.highlight(d,b,this.options.insensitive,this.prefix+"-highlight")}},this)}if(this.options.mouseInteraction){a.setStyle("cursor","pointer").addEvents({mouseenter:function(){this.focus(a)}.bind(this),mousedown:function(d){d.stop();$clear(this.hidetimer);this.doAdd=true}.bind(this),mouseup:function(){if(this.doAdd){this.addCurrent();this.currentInput.focus();this.search();this.doAdd=false}}.bind(this)});if(!this.options.onlyFromValues){a.addEvent("mouseleave",function(){if(this.current==a){this.blur()}}.bind(this))}}},hide:function(a){if(this.mouse_in_container){return}this.hidetimer=(function(){this.hidePlaceholder();this.list.setStyle("display","none");this.container.removeClass("textboxlist-autocomplete-show");this.currentSearch=null}).delay(Browser.ie?150:0,this)},showPlaceholder:function(a){if(this.placeholder){this.placeholder.setStyle("display","block");if(a){this.placeholder.set("html",a)}}},hidePlaceholder:function(){if(this.placeholder){this.placeholder.setStyle("display","none")}},focus:function(a){if(!a){return this}this.blur();this.current=a.addClass(this.prefix+"-result-focus")},blur:function(){if(this.current){this.current.removeClass(this.prefix+"-result-focus");this.current=null}},focusFirst:function(){return this.focus(this.list.getFirst())},focusRelative:function(a){if(!this.current){return this}return this.focus(this.current["get"+a.capitalize()]())},addCurrent:function(){if(!this.current){return}var c=this.current.retrieve("textboxlist:auto:value");var a=this.textboxlist.create("box",c.slice(0,3));if(a){a.autoValue=c;if(this.index!=null){this.index.push(c)}this.currentInput.setValue([null,"",null]);a.inject($(this.currentInput),"before")}this.blur();return this},navigate:function(a){switch(a.code){case Event.Keys.up:a.stop();(!this.options.onlyFromValues&&this.current&&this.current==this.list.getFirst())?this.blur():this.focusRelative("previous");break;case Event.Keys.down:a.stop();this.current?this.focusRelative("next"):this.focusFirst();break;case 188:case 186:case 59:case Event.Keys.enter:a.stop();this.addCurrentInput()}},addCurrentInput:function(){if(this.current){this.addCurrent()}else{var k=this.list.getChildren();var e=this.currentInput.getValue()[1].trim().toLowerCase();for(var f=0;f<k.length;++f){if(k[f].get("text").toLowerCase().trim()==e){this.focus(k[f]);if(this.current){this.addCurrent()}return}}if(!this.options.onlyFromValues){var j=this.currentInput.getValue();var d=j[1].trim().split(/[,;]+/);var g=new Element("div");for(var f=0;f<d.length;++f){var h=d[f].trim();h=[h,h,"<i>"+g.set("text",h).get("html")+"</i>"];var a=this.textboxlist.create("box",h);if(a){a.autoValue=h;if(this.index!=null){this.index.push(h)}a.bit.addClass(a.typeprefix+"-pending");a.inject($(this.currentInput),"before");this.currentInput.setValue([null,"",null])}}g.destroy()}}}});TextboxList.Autocomplete.Methods={standard:{filter:function(c,e,b,a){e=e.trim();var g=[],f=new RegExp(e.escapeRegExp(),b?"i":"");for(var d=0;d<c.length;d++){if(g.length===a){break}if(c[d][1].trim().test(f)){g.push(c[d])}}return g},highlight:function(d,c,b,a){var e=new RegExp("(<[^>]*>)|("+c.escapeRegExp()+")",b?"ig":"g");return d.set("html",d.get("html").replace(e,function(g,f,h){return(g.charAt(0)=="<")?g:'<strong class="'+a+'">'+h+"</strong>"}))}}}})();
(function(){GrowingInput=new Class({Implements:[Options,Events],options:{min:0,max:null,startWidth:2,correction:50},initialize:function(e,d){this.setOptions(d);this.element=$(e).store("growing",this).set("autocomplete","off");this.calc=new Element("span",{styles:{"float":"left",display:"inline-block",position:"absolute",left:-1000,color:"transparent"}}).inject(this.element,"after");["font-size","font-family","padding-left","padding-top","padding-bottom","padding-right","border-left","border-right","border-top","border-bottom","word-spacing","letter-spacing","text-indent","text-transform"].each(function(f){this.calc.setStyle(f,this.element.getStyle(f))},this);this.resize();var c=this.resize.bind(this);this.element.addEvents({blur:c,keyup:c,keydown:c,keypress:c})},calculate:function(d){this.calc.set("html",d.replace(/<\/?[^>]+(>|$)/g,""));var c=this.calc.getStyle("width").toInt();return(c?c:this.options.startWidth)+this.options.correction},resize:function(){this.lastvalue=this.value;this.value=this.element.value;var c=this.value;if($chk(this.options.min)&&this.value.length<this.options.min){if($chk(this.lastvalue)&&(this.lastvalue.length<=this.options.min)){return}c=a(this.value,this.options.min,"-")}else{if($chk(this.options.max)&&this.value.length>this.options.max){if($chk(this.lastvalue)&&(this.lastvalue.length>=this.options.max)){return}c=this.value.substr(0,this.options.max)}}this.element.setStyle("width",this.calculate(c));return this}});var b=function(d,c){return new Array(c+1).join(d)};var a=function(c,e,g,d){if(c.length>=e){return this}g=g||" ";var f=b(g,e-c.length).substr(0,e-c.length);if(!d||d=="right"){return c+f}if(d=="left"){return f+c}return f.substr(0,(f.length/2).floor())+c+f.substr(0,(f.length/2).ceil())}})();
Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(a){if(this.options.log&&window.console&&console.log){console.log("JSONP retrieving script with url:"+a)}},onError:function(a){if(this.options.log&&window.console&&console.warn){console.warn("JSONP "+a+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")}},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:false},initialize:function(a){this.setOptions(a)},send:function(c){if(!Request.prototype.check.call(this,c)){return this}this.running=true;var d=typeOf(c);if(d=="string"||d=="element"){c={data:c}}c=Object.merge(this.options,c||{});var e=c.data;switch(typeOf(e)){case"element":e=document.id(e).toQueryString();break;case"object":case"hash":e=Object.toQueryString(e)}var b=this.index=Request.JSONP.counter++;var f=c.url+(c.url.test("\\?")?"&":"?")+(c.callbackKey)+"=Request.JSONP.request_map.request_"+b+(e?"&"+e:"");if(f.length>2083){this.fireEvent("error",f)}Request.JSONP.request_map["request_"+b]=function(){this.success(arguments,b)}.bind(this);var a=this.getScript(f).inject(c.injectScript);this.fireEvent("request",[f,a]);if(c.timeout){this.timeout.delay(c.timeout,this)}return this},getScript:function(a){if(!this.script){this.script=new Element("script",{type:"text/javascript",async:true,src:a})}return this.script},success:function(b,a){if(!this.running){return}this.clear().fireEvent("complete",b).fireEvent("success",b).callChain()},cancel:function(){if(this.running){this.clear().fireEvent("cancel")}return this},isRunning:function(){return !!this.running},clear:function(){this.running=false;if(this.script){this.script.destroy();this.script=null}return this},timeout:function(){if(this.running){this.running=false;this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()}return this}});Request.JSONP.counter=0;Request.JSONP.request_map={};
Locale.define("en-US","DatePicker",{select_a_time:"Select a time",use_mouse_wheel:"Use the mouse wheel to quickly change value",time_confirm_button:"OK"});
var Picker=new Class({Implements:[Options,Events],options:{pickerClass:"datepicker",inject:null,animationDuration:400,useFadeInOut:true,positionOffset:{x:0,y:0},pickerPosition:"bottom",draggable:true,showOnInit:true},initialize:function(a){this.setOptions(a);this.constructPicker();if(this.options.showOnInit){this.show()}},constructPicker:function(){var c=this.options;var b=this.picker=new Element("div",{"class":c.pickerClass,styles:{left:0,top:0,display:"none",opacity:0}}).inject(c.inject||document.body);if(c.useFadeInOut){b.set("tween",{duration:c.animationDuration,link:"cancel"})}var g=this.header=new Element("div.header").inject(b);this.closeButton=new Element("div.closeButton[text=x]").addEvent("click",this.close.pass(false,this)).inject(g);var e=this.title=new Element("div.title").inject(g);this.titleText=new Element("div.titleText").inject(e);var a=this.body=new Element("div.body").inject(b);var d=this.slider=new Element("div.slider",{styles:{position:"absolute",top:0,left:0}}).set("tween",{duration:c.animationDuration,transition:Fx.Transitions.Quad.easeInOut}).inject(a);this.oldContents=new Element("div",{styles:{position:"absolute",top:0}}).inject(d);this.newContents=new Element("div",{styles:{position:"absolute",top:0,left:0}}).inject(d);var f=this.shim=window.IframeShim?new IframeShim(b):null;if(c.draggable&&typeOf(b.makeDraggable)=="function"){this.dragger=b.makeDraggable(f?{onDrag:f.position.bind(f)}:null);b.setStyle("cursor","move")}this.addEvent("open",function(){b.setStyle("display","block");if(f){f.show()}},true);this.addEvent("hide",function(){b.setStyle("display","none");if(f){f.hide()}},true)},open:function(a){if(this.opened==true){return this}this.opened=true;this.fireEvent("open");if(this.options.useFadeInOut&&!a){this.picker.fade("in").get("tween").chain(function(){this.fireEvent("show")}.bind(this))}else{this.picker.setStyle("opacity",1);this.fireEvent("show")}return this},show:function(){return this.open(true)},close:function(a){if(this.opened==false){return this}this.opened=false;this.fireEvent("close");if(this.options.useFadeInOut&&!a){this.picker.fade("out").get("tween").chain(function(){this.fireEvent("hide")}.bind(this))}else{this.picker.setStyle("opacity",0);this.fireEvent("hide")}return this},hide:function(){return this.close(true)},toggle:function(){return this[this.opened==true?"close":"open"]()},destroy:function(){this.picker.destroy();if(this.shim){this.shim.destroy()}},position:function(f,e){var a=this.options.positionOffset,g=document.getScroll(),i=document.getSize(),h=this.picker.getSize();if(typeOf(f)=="element"){var b=f,c=e||this.options.pickerPosition;var d=b.getCoordinates();f=(c=="left")?d.left-h.x:(c=="bottom"||c=="top")?d.left:d.right;e=(c=="bottom")?d.bottom:(c=="top")?d.top-h.y:d.top}f+=a.x*((c&&c=="left")?-1:1);e+=a.y*((c&&c=="top")?-1:1);if((f+h.x)>(i.x+g.x)){f=(i.x+g.x)-h.x}if((e+h.y)>(i.y+g.y)){e=(i.y+g.y)-h.y}if(f<0){f=0}if(e<0){e=0}this.picker.setStyles({left:f,top:e});if(this.shim){this.shim.position()}return this},setBodySize:function(){var a=this.bodysize=this.body.getSize();this.slider.setStyles({width:2*a.x,height:a.y});this.oldContents.setStyles({left:a.x,width:a.x,height:a.y});this.newContents.setStyles({width:a.x,height:a.y})},setContent:function(){var d=Array.from(arguments),c;if(["right","left","fade"].contains(d[1])){c=d[1]}if(d.length==1||c){d=d[0]}var a=this.oldContents;this.oldContents=this.newContents;this.newContents=a;this.newContents.empty();var b=typeOf(d);if(["string","number"].contains(b)){this.newContents.set("text",d)}else{this.newContents.adopt(d)}this.setBodySize();if(c){this.fx(c)}else{this.slider.setStyle("left",0);this.oldContents.setStyles({left:this.bodysize.x,opacity:0});this.newContents.setStyles({left:0,opacity:1})}return this},fx:function(e){var a=this.oldContents,b=this.newContents,d=this.slider,c=this.bodysize;if(e=="right"){a.setStyles({left:0,opacity:1});b.setStyles({left:c.x,opacity:1});d.setStyle("left",0).tween("left",0,-c.x)}else{if(e=="left"){a.setStyles({left:c.x,opacity:1});b.setStyles({left:0,opacity:1});d.setStyle("left",-c.x).tween("left",-c.x,0)}else{if(e=="fade"){d.setStyle("left",0);a.setStyle("left",0).set("tween",{duration:this.options.animationDuration/2}).tween("opacity",1,0).get("tween").chain(function(){a.setStyle("left",c.x)});b.setStyles({opacity:0,left:0}).set("tween",{duration:this.options.animationDuration}).tween("opacity",0,1)}}}},toElement:function(){return this.picker},setTitle:function(a){this.titleText.set("text",a);return this},setTitleEvent:function(a){this.titleText.removeEvents("click");if(a){this.titleText.addEvent("click",a)}this.titleText.setStyle("cursor",a?"pointer":"");return this}});
Picker.Attach=new Class({Extends:Picker,options:{showOnInit:false},initialize:function(e,d){this.parent(d);this.attachedEvents=[];this.attachedElements=[];this.toggles=[];this.inputs=[];var b=function(f){if(this.attachedElements.contains(f.target)){return null}this.close()}.bind(this);var a=this.picker.getDocument().addEvent("click",b);var c=function(f){f.stopPropagation();return false};this.picker.addEvent("click",c);if(this.options.toggleElements){this.options.toggle=a.getElements(this.options.toggleElements)}this.attach(e,this.options.toggle)},attach:function(d,b){if(typeOf(d)=="string"){d=document.id(d)}if(typeOf(b)=="string"){b=document.id(b)}var g=Array.from(d),f=Array.from(b),e=[].append(g).combine(f),c=this;var a=function(i,h){return function(j){if(j.type=="keydown"&&["tab","esc"].contains(j.key)==false){return false}if(j.target.get("tag")=="a"){j.stop()}c.fireEvent("attachedEvent",[j,h]);c.position(h);i()}};e.each(function(l,k){if(c.attachedElements.contains(l)){return null}var h=l.get("tag");var j={};if(h=="input"){j={focus:a(c.open.bind(c),l),keydown:a(c.close.bind(c),l),click:a(c.open.bind(c),l)};c.inputs.push(l)}else{if(f.contains(l)){c.toggles.push(l);j.click=a(c.toggle.bind(c),l)}else{j.click=a(c.open.bind(c),l)}}l.addEvents(j);c.attachedElements.push(l);c.attachedEvents.push(j)});return this},detach:function(c,a){if(typeOf(c)=="string"){c=document.id(c)}if(typeOf(a)=="string"){a=document.id(a)}var f=Array.from(c),e=Array.from(a),d=[].append(f).combine(e),b=this;if(!d.length){d=b.attachedElements}d.each(function(j){var h=b.attachedElements.indexOf(j);if(h<0){return null}var g=b.attachedEvents[h];j.removeEvents(g);delete b.attachedEvents[h];delete b.attachedElements[h];var l=b.toggles.indexOf(j);if(l!=-1){delete b.toggles[l]}var k=b.inputs.indexOf(j);if(l!=-1){delete b.inputs[k]}});return this},destroy:function(){this.detach();this.parent()}});
(function(){this.DatePicker=Picker.Date=new Class({Extends:Picker.Attach,options:{timePicker:false,timePickerOnly:false,timeWheelStep:1,yearPicker:true,yearsPerPage:20,startDay:1,startView:"days",pickOnly:false,canAlwaysGoUp:["months","days"],months_abbr:null,days_abbr:null,years_title:function(e,d){var f=e.get("year");return f+"-"+(f+d.yearsPerPage-1)},months_title:function(e,d){return e.get("year")},days_title:function(e,d){return e.format("%b %Y")},time_title:function(e,d){return(d.pickOnly=="time")?Locale.get("DatePicker.select_a_time"):e.format("%d %B, %Y")}},initialize:function(f,e){this.parent(f,e);this.setOptions(e);var e=this.options;["year","month","day","time"].some(function(g){if(e[g+"PickerOnly"]){return e.pickOnly=g}});if(e.pickOnly){e[e.pickOnly+"Picker"]=true;e.startView=e.pickOnly}var d=["days","months","years"];["month","year","decades"].some(function(h,g){if(e.startView==h){e.startView=d[g];return true}});e.canAlwaysGoUp=e.canAlwaysGoUp?Array.from(e.canAlwaysGoUp):[];if(e.minDate){if(!(e.minDate instanceof Date)){e.minDate=Date.parse(e.minDate)}e.minDate.clearTime()}if(e.maxDate){if(!(e.maxDate instanceof Date)){e.maxDate=Date.parse(e.maxDate)}e.maxDate.clearTime()}if(!e.format){e.format=(e.pickOnly!="time")?Locale.get("Date.shortDate"):"";if(e.timePicker){e.format=(e.format)+(e.format?" ":"")+Locale.get("Date.shortTime")}}this.date=b(new Date(),e.minDate,e.maxDate);this.addEvent("attachedEvent",function(m,l){var g=l.get("tag"),h;if(g=="input"){h=l}else{var k=this.toggles.indexOf(l);if(this.inputs[k]){h=this.inputs[k]}}this.date=new Date();if(h){var j=Date.parse(h.get("value"));if(j==null||!j.isValid()){var i=h.retrieve("datepicker:value");if(i){j=Date.parse(i)}}if(j!=null&&j.isValid()){this.date=j}}this.input=h}.bind(this),true);this.currentView=e.startView;this.addEvent("open",function(){var g=this.currentView,h=g.capitalize();if(this["render"+h]){this["render"+h](this.date.clone());this.currentView=g}}.bind(this))},constructPicker:function(){this.parent();this.previous=new Element("div.previous[html=&#171;]").inject(this.header);this.next=new Element("div.next[html=&#187;]").inject(this.header)},hidePrevious:function(d,e){this[d?"next":"previous"].setStyle("display",e?"block":"none");return this},showPrevious:function(d){return this.hidePrevious(d,true)},setPreviousEvent:function(e,d){this[d?"next":"previous"].removeEvents("click");if(e){this[d?"next":"previous"].addEvent("click",e)}return this},hideNext:function(){return this.hidePrevious(true)},showNext:function(){return this.showPrevious(true)},setNextEvent:function(d){return this.setPreviousEvent(d,true)},renderYears:function(f,h){var e=this.options;while(f.get("year")%e.yearsPerPage>0){f.decrement("year",1)}this.setTitle(e.years_title(f,e));this.setContent(a.years(e,f.clone(),this.date.clone(),function(i){if(e.pickOnly=="years"){this.select(i)}else{this.renderMonths(i,"fade")}}.bind(this)),h);var d=(e.minDate&&f.get("year")<=e.minDate.get("year")),g=(e.maxDate&&(f.get("year")+e.yearsPerPage)>=e.maxDate.get("year"));this[(d?"hide":"show")+"Previous"]();this[(g?"hide":"show")+"Next"]();this.setPreviousEvent(function(){this.renderYears(f.decrement("year",e.yearsPerPage),"left")}.bind(this));this.setNextEvent(function(){this.renderYears(f.increment("year",e.yearsPerPage),"right")}.bind(this));this.setTitleEvent(null)},renderMonths:function(h,k){var g=this.options;this.setTitle(g.months_title(h,g));this.setContent(a.months(g,h.clone(),this.date.clone(),function(l){if(g.pickOnly=="months"){this.select(l)}else{this.renderDays(l,"fade")}}.bind(this)),k);var j=h.get("year"),e=(g.minDate&&j<=g.minDate.get("year")),i=(g.maxDate&&j>=g.maxDate.get("year"));this[(e?"hide":"show")+"Previous"]();this[(i?"hide":"show")+"Next"]();this.setPreviousEvent(function(){this.renderMonths(h.decrement("year",1),"left")}.bind(this));this.setNextEvent(function(){this.renderMonths(h.increment("year",1),"right")}.bind(this));var f=g.yearPicker&&(g.pickOnly!="months"||g.canAlwaysGoUp.contains("months"));var d=(f)?function(){this.renderYears(h,"fade")}.bind(this):null;this.setTitleEvent(d)},renderDays:function(h,k){var g=this.options;this.setTitle(g.days_title(h,g));this.setContent(a.days(g,h.clone(),this.date.clone(),function(l){if(g.pickOnly=="days"||!g.timePicker){this.select(l)}else{this.renderTime(l,"fade")}}.bind(this)),k);var j=h.format("%Y%m").toInt(),e=(g.minDate&&j<=g.minDate.format("%Y%m")),i=(g.maxDate&&j>=g.maxDate.format("%Y%m"));this[(e?"hide":"show")+"Previous"]();this[(i?"hide":"show")+"Next"]();this.setPreviousEvent(function(){this.renderDays(h.decrement("month",1),"left")}.bind(this));this.setNextEvent(function(){this.renderDays(h.increment("month",1),"right")}.bind(this));var f=g.pickOnly!="days"||g.canAlwaysGoUp.contains("days");var d=(f)?function(){this.renderMonths(h,"fade")}.bind(this):null;this.setTitleEvent(d)},renderTime:function(g,h){var f=this.options;this.setTitle(f.time_title(g,f));this.setContent(a.time(f,g.clone(),this.date.clone(),function(i){this.select(i)}.bind(this)),h);this.hidePrevious().hideNext().setPreviousEvent(null).setNextEvent(null);var e=f.pickOnly!="time"||f.canAlwaysGoUp.contains("time");var d=(e)?function(){this.renderDays(g,"fade")}.bind(this):null;this.setTitleEvent(d)},select:function(d){this.date=d;if(this.input){this.input.set("value",d.format(this.options.format)).store("datepicker:value",d.strftime())}this.fireEvent("select",d);this.close()}});var a={years:function(o,f,e,n){var h={left:false,right:false},d=new Element("div.years"),m=new Date(),l,k,g;for(var j=0;j<o.yearsPerPage;j++){l=f.get("year");g=".year.year"+j;if(l==m.get("year")){g+=".today"}if(l==e.get("year")){g+=".selected"}k=new Element("div"+g,{text:l}).inject(d);if(c("year",f,o)){k.addClass("unavailable")}else{k.addEvent("click",n.pass(f.clone()))}f.increment("year",1)}return d},months:function(r,g,f,q){var p=new Date(),n=p.get("month"),j={left:false,right:false},l=(g.get("year")==p.get("year")),o=(g.get("year")==f.get("year")),d=new Element("div.months"),e=r.months_abbr||Locale.get("Date.months_abbr"),m,h;g.set("month",0);if(r.minDate){g.decrement("month",1);g.set("date",g.get("lastdayofmonth"));g.increment("month",1)}g.set("date",g.get("lastdayofmonth"));for(var k=0;k<=11;k++){h=".month.month"+(k+1);if(k==n&&l){h+=".today"}if(k==f.get("month")&&o){h+=".selected"}element=new Element("div"+h,{text:e[k]}).inject(d);if(c("month",g,r)){element.addClass("unavailable")}else{element.addEvent("click",q.pass(g.clone()))}g.increment("month",1);g.set("date",g.get("lastdayofmonth"))}return d},days:function(u,g,f,r){var p=g.get("month"),j={left:false,right:false},m=new Date().toDateString(),e=f.toDateString(),d=new Element("div.days"),n=new Element("div.titles").inject(d),o=u.days_abbr||Locale.get("Date.days_abbr"),q,h,l,t,s;g.setDate(1);while(g.getDay()!=u.startDay){g.setDate(g.getDate()-1)}for(q=u.startDay;q<(u.startDay+7);q++){new Element("div.title.day.day"+(q%7),{text:o[(q%7)]}).inject(n)}for(var k=0;k<42;k++){if(k%7==0){t=new Element("div.week.week"+(Math.floor(k/7))).inject(d)}s=g.toDateString();h=".day.day"+g.get("day");if(s==m){h+=".today"}if(s==e){h+=".selected"}if(g.get("month")!=p){h+=".otherMonth"}l=new Element("div"+h,{text:g.getDate()}).inject(t);if(c("date",g,u)){l.addClass("unavailable")}else{l.addEvent("click",r.pass(g.clone()))}g.increment("day",1)}return d},time:function(g,f,e,h){var d=new Element("div.time"),j=(f.get("minutes")/g.timeWheelStep).round()*g.timeWheelStep;if(j>=60){j=0}f.set("minutes",j);var i=new Element("input.hour[type=text]",{title:Locale.get("DatePicker.use_mouse_wheel"),value:f.format("%H"),events:{click:function(l){l.target.focus();l.stop()},mousewheel:function(l){l.stop();i.focus();var m=i.get("value").toInt();m=(l.wheel>0)?((m<23)?m+1:0):((m>0)?m-1:23);f.set("hours",m);i.set("value",f.format("%H"))}.bind(this)},maxlength:2}).inject(d);var k=new Element("input.minutes[type=text]",{title:Locale.get("DatePicker.use_mouse_wheel"),value:f.format("%M"),events:{click:function(l){l.target.focus();l.stop()},mousewheel:function(l){l.stop();k.focus();var m=k.get("value").toInt();m=(l.wheel>0)?((m<59)?(m+g.timeWheelStep):0):((m>0)?(m-g.timeWheelStep):(60-g.timeWheelStep));if(m>=60){m=0}f.set("minutes",m);k.set("value",f.format("%M"))}.bind(this)},maxlength:2}).inject(d);new Element("div.separator[text=:]").inject(d);new Element("input.ok[type=submit]",{value:Locale.get("DatePicker.time_confirm_button"),events:{click:function(l){l.stop();f.set({hours:i.get("value").toInt(),minutes:k.get("value").toInt()});h(f.clone())}}}).inject(d);return d}};Picker.Date.defineRenderer=function(d,e){a[d]=e;return this};var b=function(e,f,d){if(f&&e<f){return f}if(d&&e>d){return d}return e};var c=function(i,f,m){var g=m.minDate,e=m.maxDate,l=m.availableDates;if(!g&&!e&&!l){return false}f.clearTime();if(i=="year"){var j=f.get("year");return((g&&j<g.get("year"))||(e&&j>e.get("year"))||((l!=null)&&(l[j]==null||Object.getLength(l[j])==0||Object.getLength(Object.filter(l[j],function(n){return(n.length>0)}))==0)))}if(i=="month"){var j=f.get("year"),h=f.get("month")+1,d=f.format("%Y%m").toInt();return((g&&d<g.format("%Y%m").toInt())||(e&&d>e.format("%Y%m").toInt())||((l!=null)&&(l[j]==null||l[j][h]==null||l[j][h].length==0)))}var j=f.get("year"),h=f.get("month")+1,k=f.get("date");return((g&&f<g)||(e&&f>e)||((l!=null)&&(l[j]==null||l[j][h]==null||!l[j][h].contains(k))))};Date.defineParsers("%H:%M( ?%p)?")})();
EOL.namespace("uploadW");function uwlog(a){return;if(top.window.console){top.console.log(a)}}EOL.uploadW.iframeCount=0;EOL.uploadW.iframeName="";EOL.uploadW.maxNameLength=0;EOL.uploadW.initInclude=function(){if($("uploadW-file-attach-module")){$("uploadW-file-attach-module").removeClass("displayNone")}if($("uploadW-bulk-file-attach-module")){$("uploadW-bulk-file-attach-module").removeClass("displayNone")}};EOL.uploadW.UploadWidget=new Class({Implements:[Options,Events],options:{dialogMode:false,fileGroupId:0,fileContext:"job",iframeSRC:"/php/files/main/uploadIframe.php?jobid="},initialize:function(b,a){this.setOptions(a);if(typeof b=="string"){b=$(b)}var c=this;c.el=b;EOL.uploadW.dialogMode=c.options.dialogMode;EOL.uploadW.fileGroupId=c.options.fileGroupId;EOL.uploadW.fileContext=c.options.fileContext;EOL.uploadW.iframeSRC=c.options.iframeSRC;new Request({url:"/php/files/main/uploadIframe.php",method:"get",data:{mode:"include",context:c.options.fileContext},onSuccess:function(d){c.el.set("html",c.el.get("html")+d);EOL.uploadW.initInclude()}}).send()}});EOL.uploadW.toggleAttach=function(){if(typeof(EOL.uploadW.sendMetrics.onAttach)=="function"){EOL.uploadW.sendMetrics.onAttach()}var a=$("uploadW-file-attach-module");if(a.className.search("closed")!=-1){EOL.uploadW.openAttach()}else{EOL.uploadW.closeAttach()}};EOL.uploadW.toggleBulkAttach=function(){var a=$("uploadW-bulk-file-attach-module");if(a.className.search("closed")!=-1){EOL.uploadW.openBulkAttach()}else{EOL.uploadW.closeBulkAttach()}};EOL.uploadW.openAttach=function(){var b=$("uploadW-file-attach-module");b.removeClass("closed");if(EOL.uploadW.dialogMode){if(!EOL.uploadW.attachDialog){EOL.uploadW.attachDialog=new EOL.uploadW.dialog("uploadW-attach-dialog-c","uploadW-attach-dialog-b");EOL.uploadW.attachDialog.beforeShow=function(){EOL.uploadW.beforeShowDialog()};EOL.uploadW.attachDialog.afterShow=function(){EOL.uploadW.afterShowDialog()};EOL.uploadW.attachDialog.beforeHide=function(){$("uploadW-file-attach-module").addClass("closed");EOL.uploadW.beforeHideDialog()};EOL.uploadW.attachDialog.afterHide=function(){EOL.uploadW.afterHideDialog()}}EOL.uploadW.attachDialog.show()}var d=$("uploadW-attach-frame");if(d.innerHTML==""){var c=EOL.uploadW.iframeSRC;c+="&fileGroupId="+EOL.uploadW.fileGroupId+"&fileContext="+EOL.uploadW.fileContext;c+="&t="+getDateTime();if(EOL.uploadW.addtionalCss){c+="&css="+EOL.uploadW.addtionalCss}EOL.uploadW.iframeName="uploadW-iframe"+EOL.uploadW.iframeCount++;var a=document.createElement("iframe");a.setAttribute("src",c);a.setAttribute("scrolling","no");a.setAttribute("frameBorder","0");a.setAttribute("id",EOL.uploadW.iframeName);a.setAttribute("name",EOL.uploadW.iframeName);$(a).addClass("uploadW-iframe");d.appendChild(a)}};EOL.uploadW.openBulkAttach=function(){var b=$("uploadW-bulk-file-attach-module");b.removeClass("closed");var e=$("uploadW-bulk-attach-frame");if(e.innerHTML==""){var d=Array();$("myjobs-results").getElements(".selected").each(function(f){if(f.get("projecttype")=="bid"){d.push(f.get("projectid"))}});var c=EOL.uploadW.iframeSRC+"&bidids="+JSON.stringify(d);c+="&fileGroupId="+EOL.uploadW.fileGroupId+"&fileContext="+EOL.uploadW.fileContext;c+="&t="+getDateTime();if(EOL.uploadW.addtionalCss){c+="&css="+EOL.uploadW.addtionalCss}EOL.uploadW.iframeName="uploadW-iframe"+EOL.uploadW.iframeCount++;var a=document.createElement("iframe");a.setAttribute("src",c);a.setAttribute("scrolling","no");a.setAttribute("frameBorder","0");a.setAttribute("id",EOL.uploadW.iframeName);a.setAttribute("name",EOL.uploadW.iframeName);$(a).addClass("uploadW-iframe");e.appendChild(a)}};EOL.uploadW.closeAttach=function(){if(EOL.uploadW.dialogMode){EOL.uploadW.attachDialog.hide();EOL.uploadW.updateFileList()}$("uploadW-file-attach-module").addClass("closed")};EOL.uploadW.closeBulkAttach=function(){if($("uploadW-bulk-file-attach-module")){$("uploadW-bulk-file-attach-module").addClass("closed")}if($("uploadW-bulk-attach-frame")){$("uploadW-bulk-attach-frame").empty()}};EOL.uploadW.updateFileList=function(){$("uploadW-attach-fileList").innerHTML=$("uploadW-attach-fileList-loading").innerHTML;var a=EOL.uploadW.fileListSRC;a+="&fileGroupId="+EOL.uploadW.fileGroupId+"&fileContext="+EOL.uploadW.fileContext;a+="&maxNameLength="+EOL.uploadW.maxNameLength;a+="&t="+getDateTime();var b=new Request({url:a,method:"post",onSuccess:EOL.uploadW.onUpdateFileListSuccess}).send()};EOL.uploadW.onUpdateFileListSuccess=function(a){$("uploadW-attach-fileList").innerHTML=a};EOL.uploadW.resizeUploadIframe=function(a){uwlog("parent resize "+a);if(a>0){$(EOL.uploadW.iframeName).style.height=a+"px"}};EOL.uploadW.setError=function(a,c,b){uwlog("parent showError");if(EOL.uploadW.dialogMode){$("uploadW-attach-error").removeClass("displayNone");$("uploadW-attach-errorTitle").innerHTML=a;$("uploadW-attach-errorBody").innerHTML=c}else{a=a.replace(/<.*?>/g,"");c=c.replace(/<.*?>/g,"");alert(a+":"+c)}};EOL.uploadW.setErrorId=function(d,c,b){var e=$(d)?$(d).innerHTML:"";var a=$(c)?$(c).innerHTML:"";return EOL.uploadW.setError(e,a,b)};EOL.uploadW.clearError=function(){uwlog("parent clearError");if(EOL.uploadW.dialogMode){$("uploadW-attach-error").addClass("displayNone")}};EOL.uploadW.showBusy=function(){uwlog("parent showbusy")};EOL.uploadW.hideBusy=function(){uwlog("parent hidebusy")};EOL.uploadW.widgetUploadNewFile=function(){EOL.uploadW.openAttach();$("uploadW-attach-frame").focus()};EOL.uploadW.beforeShowDialog=function(){};EOL.uploadW.afterShowDialog=function(){};EOL.uploadW.beforeHideDialog=function(){};EOL.uploadW.afterHideDialog=function(){};EOL.uploadW.showBusyResize=function(a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.showBusy()};EOL.uploadW.hideBusyResize=function(a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.hideBusy()};EOL.uploadW.completeFile=function(a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.hideBusy();EOL.uploadW.clearError()};EOL.uploadW.setErrorResize=function(b,d,c,a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.setError(b,d,c)};EOL.uploadW.failureError=function(b,d,c,a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.hideBusy();EOL.uploadW.setError(b,d,c)};EOL.uploadW.clearErrorResize=function(a){EOL.uploadW.resizeUploadIframe(a);EOL.uploadW.clearError()};EOL.uploadW.notifyGroupId=function(a){EOL.uploadW.fileGroupId=a};EOL.uploadW.removeUploaderFrame=function(c){if(!c.firstChild){return}var b=c.firstChild.contentWindow;if(b){var a=$(b.document);if(a){a.getElements(".swiff-uploader-box").dispose()}}c.removeChild(c.firstChild)};EOL.uploadW.reset=function(){EOL.uploadW.closeAttach();var a=$("uploadW-attach-frame");EOL.uploadW.removeUploaderFrame(a);EOL.uploadW.fileGroupId=0;EOL.uploadW.hideBusy();EOL.uploadW.clearError()};EOL.uploadW.getFileIconClass=function(c,d){var b=c.toLowerCase().substr(c.lastIndexOf(".")+1,c.length-(c.lastIndexOf(".")-1));var a;switch(d){case"large":a="uploadW-icon-large";break;default:a="uploadW-icon-small";break}a+=" "+a;switch(b){case"mp3":case"wav":case"au":a+="-audio";break;case"doc":case"docx":a+="-doc";break;case"xls":case"xlt":case"xlsx":a+="-excel";break;case"swf":case"fla":a+="-flash";break;case"html":case"htm":case"css":case"js":a+="-html";break;case"png":case"gif":case"jpg":case"jpeg":case"tif":a+="-image";break;case"pdf":a+="-pdf";break;case"ppt":case"pptx":a+="-ppt";break;case"txt":case"rtf":a+="-text";break;case"mpg":case"mpeg":case"avi":case"wmv":case"mov":a+="-video";break;case"zip":case"rar":case"tgz":case"gz":a+="-zip";break;default:a+="-default";break}return a};EOL.uploadW.getFileGroupId=function(){return EOL.uploadW.fileGroupId};EOL.uploadW.uploadNewVersion=function(b){var a=window.frames[EOL.uploadW.iframeName];if(!a.EOL){return setTimeout(function(){EOL.uploadW.uploadNewVersion(b)},100)}a.EOL.uploadWI.uploadNewVersion(b);return null};EOL.uploadW.removeFile=function(b){window.frames[EOL.uploadW.iframeName].EOL.uploadWI.swiffy.removeThisFile(b);var a=$("uploadW-file-"+b);if(a){a.parentNode.removeChild(a)}return null};EOL.uploadW.removeFileCallback=function(){};EOL.uploadW.dialog=function(c,b,a){EOL.uploadW.dialog.superclass.constructor.call(this,"",a);document.body.appendChild($(c));this.containerEl=c;this.bodyEl=b;this.opened=false};EOL.utility.extend(EOL.uploadW.dialog,EOL.dialog);EOL.uploadW.dialog.prototype.show=function(){if(this.opened){return}this.beforeShow();if(this.options.modal){this.createOverlay()}var a=$(this.containerEl);a.removeClass("displayNone");a.style.display="block";a.style.visibility="inherit";this.setContainerAttributes(a);this.setBodyAttributes($(this.bodyEl));if(this.options.close){var b=document.createElement("div");this.setCloseAttributes(b);a.appendChild(b)}this.sizeElements();this.setResizeEvents();this.opened=true;this.afterShow()};EOL.uploadW.dialog.prototype.hide=function(){if(!this.opened){return}this.beforeHide();this.removeResizeEvents();$(this.containerEl).style.display="none";if($("eol-dialog-overlay")){$("eol-dialog-overlay").parentNode.removeChild($("eol-dialog-overlay"))}this.opened=false;this.afterHide()};EOL.namespace("uploadWI");EOL.uploadWI.maxFiles=10;EOL.uploadWI.maxSizeMb=50;EOL.uploadWI.controller="/php/files/main/upload.php";EOL.uploadWI.mode=null;EOL.uploadWI.revise_fid=null;if(getGetParam("css")=="upload-dashboard.css"){EOL.uploadWI.max_filename_length=19}else{EOL.uploadWI.max_filename_length=25}EOL.uploadWI.initIframe=function(){parent.EOL.uploadW.notifyGroupId(EOL.uploadWI.fileGroupId);if(navigator.appVersion.indexOf("MSIE 6")!=-1){return EOL.uploadWI.useFallback()}EOL.uploadWI.resizeIframe();EOL.uploadWI.File=new Class({Extends:FancyUpload2.File,initialize:function(b,a){this.parent(b,a);if(EOL.uploadWI.mode=="version"){this.setOptions({url:b.options.url+"&mode=revision&revise_fid="+EOL.uploadWI.revise_fid+"&version.root="+EOL.uploadWI.revise_fid})}},render:function(){if(this.invalid){this.parent();return}this.addEvents({start:this.onStart,progress:this.onProgress,complete:this.onComplete,error:this.onError,remove:this.onRemove});var b=$("file-progress-stub").cloneNode(true);b.id="";this.progressImg=b.getElement(".file-progress");this.currentProgress=new Fx.ProgressBar(this.progressImg,{text:new Element("span",{"class":"progress-text"}).inject(this.progressImg,"after"),fit:false});var c=this.name;if(c.length>EOL.uploadWI.max_filename_length){c=c.substr(0,EOL.uploadWI.max_filename_length)+"..."}this.fname=new Element("span",{html:c,"data-filename":this.name});var d=Swiff.Uploader.formatUnit(this.size,"b");var a=this.fake?"":"("+d+")";this.fsize=new Element("span",{"class":"file-size",html:"&nbsp;&nbsp;"+a,"data-size":d});this.icon=new Element("img",{src:"/media/images/spacer.gif","class":"file-icon"});$(this.icon).addClass(EOL.uploadW.getFileIconClass(this.name));this.info=new Element("span",{"class":"file-info"});this.clearDiv=new Element("div",{"class":"clear"});this.fileRemove=new Element("img",{src:"/media/images/spacer.gif","class":"uploadW-icon-small uploadW-icon-small-trash"});this.element=new Element("li",{"class":"file"}).adopt(this.icon,new Element("div",{"class":"file-name"}).adopt(this.fname,this.fsize),b,this.info,new Element("a",{"class":"file-remove",html:'<span class="file-remove-text">[x]</span>',href:"#",title:MooTools.lang.get("FancyUpload","removeTitle"),events:{click:function(){this.removeAction();EOL.uploadWI.hideBusy();return false}.bind(this)}}).adopt(this.fileRemove),this.clearDiv).inject(this.base.list);$("demo-list").removeClass("displayNone");EOL.uploadWI.resizeIframe.delay(10)},validate:function(){var b=this.parent();if(!b){return b}var a=this.name;var d=this.base.fileList.some(function(f){return(f.name==a)});if(d){this.validationError="duplicate";return false}$("controls").addClass("displayNone");EOL.uploadWI.showBusy();if(EOL.uploadWI.mode!="version"){EOL.uploadWI.collision_file=this;var e=EOL.uploadWI.ajaxParams+"&action=chk_file&filename="+escape(this.name)+"&filesize="+this.size+"&t="+getDateTime();var c=new Request({url:EOL.uploadWI.controller,method:"post",data:e,onSuccess:EOL.uploadWI.onValidateFileUploadSuccess,onFailure:EOL.uploadWI.onValidateFileUploadFailure});c.send()}return true},onStart:function(){this.parent();if(!this.fake){this.currentProgress.element.parentNode.style.display=""}this.currentProgress.cancel().set(0);EOL.uploadWI.showBusy()},onProgress:function(){this.parent();this.currentProgress.start(this.progress.percentLoaded)},onComplete:function(g){this.parent();if(this.response.error){return}var d=null;if(g){var c=JSON.decode(g.response.text);if(c.fid){d=c.fid}else{d=c.data}}if(this.fname.get("data-filename")!=this.name){this.name=this.fname.get("html")}var f=EOL.uploadWI.ajaxParams+"&action=complete&filename="+escape(this.name)+"&filesize="+this.size+"&t="+getDateTime();if(d){f+="&fid="+d}var e=this;var b=new Request({url:EOL.uploadWI.controller,method:"post",data:f,onSuccess:function(h,a){EOL.uploadWI.onCompleteSuccess(h,a,e)}}).send();this.showFileRemove();EOL.uploadWI.completeFile()},showFileRemove:function(){this.fileRemove.removeClass("displayNone")},onError:function(){this.parent();this.showFileRemove();switch(this.response.error){case"httpStatus":EOL.uploadWI.failureErrorId.delay(100,null,["errorTitle","error"+this.response.code]);break;case"ioError":EOL.uploadWI.failureError.delay(100,null,[$("errorTitle").innerHTML,("An error caused a send or load operation to fail ({text})").substitute(this.response)]);break}},removeAction:function(){this.removeActionCalled=true;if(!this.fake){this.remove()}this.coreRemove.delay(100,this)},onRemove:function(){if(typeof(EOL.uploadWI.sendMetrics.onRemove)=="function"){EOL.uploadWI.sendMetrics.onRemove()}parent.EOL.uploadW.removeFileCallback();if(this.removeActionCalled){return}this.coreRemove()},coreRemove:function(){this.base.fileListSize-=this.size;if(this.fname.get("data-filename")!=this.name){this.name=this.fname.get("html")}this.base.fileList.erase(this);if($(this.element)){$(this.element).destroy()}if(this.base.fileList.length==0){$("demo-list").addClass("displayNone")}else{if(this.base.fileList.length<EOL.uploadWI.maxFiles){EOL.uploadWI.clickAddAnother()}}EOL.uploadWI.resizeIframe.delay(10);var e=EOL.uploadWI.ajaxParams+"&action=delete&t="+getDateTime()+"&fid="+this.fid;if(this.fake){e+="&ref_id="+this.ref_id;var c=0;var d;while(d=$("localfile"+c)){if(d&&d.value==this.id){d.checked=false;$(d.parentNode.parentNode).removeClass("displayNone");break}c++}if(!this.ref_id){return}}else{e+="&filename="+escape(this.name)+"&filesize="+this.size}if(this.fake||this.fid){var b=new Request({url:EOL.uploadWI.controller,method:"post",data:e,onSuccess:EOL.uploadWI.onRemoveSuccess}).send()}},addToCompany:function(){if(this.fake){return}var d=EOL.uploadWI.ajaxParams+"&action=addToCompany&t="+getDateTime()+"&fid="+this.fid;var c=this;var b=new Request({url:EOL.uploadWI.controller,method:"post",data:d,onSuccess:function(e,a){EOL.uploadWI.onAddToCompanySuccess(e,a,c)},onFailure:EOL.uploadWI.onFailureGeneric}).send()}});EOL.uploadWI.FancyUpload2=new Class({Extends:FancyUpload2,createDummyFile:function(b,d){var a=this.options.fileClass||Swiff.Uploader.File;var c=new a(this,{name:b,status:3,id:d,size:0,fake:true});this.fileList.push(c);c.render();return c},isUploading:function(){for(var a=0;a<this.fileList.length;a++){if(this.fileList[a].element.hasClass("file-uploading")){return true}}return false},removeThisFile:function(a){uwlog("remove file called with ["+a);this.fileList.each(function(c,b){if(c.fid==a||c.ref_id==a){c.removeAction()}})},resetFiles:function(){this.fileList.each(function(a){a.id=null})},reposition:function(a){a=a||(this.target&&this.target.offsetHeight)?this.target.getCoordinates(this.box.getOffsetParent()):{top:0,left:0,width:1,height:1};this.box.setStyles(a)},debugPrint:function(){var b="";for(var a=0;a<this.fileList.length;a++){b+=this.fileList[a].id+":"+this.fileList[a].name+", "}uwlog("FILES ["+this.fileList.length+"] "+b)}});EOL.uploadWI.swiffy=new EOL.uploadWI.FancyUpload2($("demo-status"),$("demo-list"),{url:EOL.uploadWI.wsURL+EOL.uploadWI.ajaxParams,fieldName:"file",path:"/scripts/upload/uploadv3/Swiff.Uploader.swf",target:"demo-browse",limitSize:EOL.uploadWI.maxSizeMb*1024*1024,limitFiles:EOL.uploadWI.maxFiles,multiple:false,fileHeight:30,instantStart:false,fileClass:EOL.uploadWI.File,onSelectSuccess:function(a){if(typeof(EOL.uploadWI.sendMetrics.onSelect)=="function"){EOL.uploadWI.sendMetrics.onSelect()}if(EOL.uploadWI.swiffy.options.instantStart){EOL.uploadWI.reset()}},onSelectFail:function(b){var a="";b.each(function(c){a+=" "+c.validationErrorMessage},this);EOL.uploadWI.failureError($("userErrorTitle").innerHTML,a);return false},onLoad:function(){if(EOL.uploadWI.swiffyLoaded){this.resetFiles()}EOL.uploadWI.swiffyLoaded=true;EOL.uploadWI.onSourceChange();EOL.utility.__flash__fixRemoveCallback()},onFail:function(a){EOL.uploadWI.useFallback();$("upswitch-1").addClass("displayNone");EOL.uploadWI.onSourceChange()}});$("demo-browse").addEvents({mouseenter:function(){$("demo-browse").style.backgroundColor="#00468C";$("demo-browse").style.color="white"},mouseleave:function(){$("demo-browse").style.backgroundColor="transparent";$("demo-browse").style.color="black"},mousedown:function(){if(typeof(EOL.uploadWI.sendMetrics.onBrowseClick)=="function"){EOL.uploadWI.sendMetrics.onBrowseClick()}this.click()}})};EOL.uploadWI.useFallback=function(c){$("fallback").removeClass("displayNone");if(c){$("fallback-warning").addClass("displayNone");$("upswitch-1").addClass("displayNone");$("upswitch-2").removeClass("displayNone");$("fallback").set("data-toggle","on")}$("demo-browse").addClass("displayNone");EOL.uploadWI.resizeIframe();if(!document.getElement("iframe#fallback-iframe")){var b=EOL.uploadWI.fallbackURL+"/php/files/main/fallbackIframe.php?";b+="&fileGroupId="+EOL.uploadWI.fileGroupId+"&fileContext="+EOL.uploadWI.fileContext;if(EOL.uploadWI.ajaxParams){b+="&"+EOL.uploadWI.ajaxParams}b+="&frameName="+parent.EOL.uploadW.iframeName;b+="&xdomain="+document.location.protocol+"//"+document.location.host;var a=document.createElement("iframe");a.setAttribute("src",b);a.setAttribute("id","fallback-iframe");a.setAttribute("name","fallback-iframe");a.setAttribute("scrolling","no");a.setAttribute("frameBorder","0");$("fallback-iframe").appendChild(a)}};EOL.uploadWI.hideFallback=function(){$("fallback").set("data-toggle","off");$("fallback").addClass("displayNone");$("demo-browse").removeClass("displayNone");$("upswitch-1").removeClass("displayNone");$("upswitch-2").addClass("displayNone");EOL.uploadWI.resizeIframe()};EOL.uploadWI.reset=function(){if(EOL.uploadWI.hasLocalFiles){$("form-demo").uploadSource.disabled=false}EOL.uploadWI.mode=null;EOL.uploadWI.revise_fid=null;EOL.uploadWI.swiffy.options.instantStart=false;$("controls").addClass("displayNone");$("content-local").addClass("displayNone");if(EOL.uploadWI.swiffy.fileList.length==0){EOL.uploadWI.clickAddAnother()}else{if(EOL.uploadWI.swiffy.fileList.length<EOL.uploadWI.maxFiles){EOL.uploadWI.clickAddAnother()}else{$("controls").addClass("displayNone")}}EOL.uploadWI.clearError();EOL.uploadWI.hideBusy()};EOL.uploadWI.resizeIframe=function(b){var a=document.body.clientHeight;if(b!=null){a+=b}uwlog("child resize ["+a+"]["+b+"]");parent.EOL.uploadW.resizeUploadIframe(a)};EOL.uploadWI.showBusy=function(){var a=document.body.clientHeight;uwlog("child show busy ["+a+"]");if(EOL.uploadWI.dialogMode){EOL.uploadWI.hideDialogSaveBtn()}parent.EOL.uploadW.showBusyResize(a)};EOL.uploadWI.hideBusy=function(){var a=document.body.clientHeight;uwlog("child hideBusy ["+a+"]");if(EOL.uploadWI.swiffy.isUploading()){parent.EOL.uploadW.resizeUploadIframe(a);if(!EOL.uploadWI.swiffy.fileList.length||$$("li.file-uploading").length<=1){parent.EOL.uploadW.hideBusy()}}else{parent.EOL.uploadW.hideBusyResize(a)}};EOL.uploadWI.completeFile=function(){var a=document.body.clientHeight;uwlog("child complete file ["+a+"]");if(EOL.uploadWI.swiffy.isUploading()){parent.EOL.uploadW.clearErrorResize(a)}else{parent.EOL.uploadW.completeFile(a);if(EOL.uploadWI.dialogMode){EOL.uploadWI.showDialogSaveBtn()}}};EOL.uploadWI.setError=function(b,d,c){var a=document.body.clientHeight;uwlog("child setError ["+a+"]["+b+"]["+d+"]");parent.EOL.uploadW.setErrorResize(b,d,c,a)};EOL.uploadWI.setErrorId=function(d,c,b){var e=$(d)?$(d).innerHTML:"";var a=$(c)?$(c).innerHTML:"";return EOL.uploadWI.setError(e,a,b)};EOL.uploadWI.failureError=function(b,d,c){var a=document.body.clientHeight;uwlog("child failureError ["+a+"]["+b+"]["+d+"]");if(EOL.uploadWI.swiffy.isUploading()){parent.EOL.uploadW.setErrorResize(b,d,c,a)}else{parent.EOL.uploadW.failureError(b,d,c,a)}};EOL.uploadWI.failureErrorId=function(d,c,b){var e=$(d)?$(d).innerHTML:"";var a=$(c)?$(c).innerHTML:"";return EOL.uploadWI.failureError(e,a,b)};EOL.uploadWI.clearError=function(){var a=document.body.clientHeight;uwlog("child clearError ["+a+"]");parent.EOL.uploadW.clearErrorResize(a)};EOL.uploadWI.hideDialogSaveBtn=function(){disableElems($("uploadW-attach-dialog-save"))};EOL.uploadWI.showDialogSaveBtn=function(){enableElems($("uploadW-attach-dialog-save"))};EOL.uploadWI.source=null;EOL.uploadWI.onSourceChange=function(){$("controls").removeClass("displayNone");$("content-local").addClass("displayNone");$("controls-workroom").addClass("displayNone");$("controls-company").addClass("displayNone");var a=$("form-demo").uploadSource;var c="";for(var b=0;b<a.options.length;b++){if(a.options[b].selected){c=a.options[b].value}}if(c=="remote"){$("controls-remote").removeClass("displayNone");$("controls-local").addClass("displayNone");if($("fallback").get("data-toggle")=="on"){$("fallback").removeClass("displayNone")}}else{$("content-local").removeClass("workroom");$("content-local").removeClass("company");$("content-local").addClass(c);$("controls-remote").addClass("displayNone");$("controls-local").removeClass("displayNone");if($("fallback").get("data-toggle")=="on"){$("fallback").addClass("displayNone")}}EOL.uploadWI.source=c;EOL.uploadWI.resizeIframe.delay(10)};EOL.uploadWI.sourceSelect=function(){var a=$("form-demo").uploadSource;var c="";for(var b=0;b<a.options.length;b++){if(a.options[b].selected){c=a.options[b].value}}if(c=="workroom"){$("controls").addClass("displayNone");$("content-local").removeClass("displayNone");$("workroom-files-list").removeClass("displayNone");$("controls-workroom").removeClass("displayNone");$("company-files-list").addClass("displayNone");$("controls-company").addClass("displayNone");EOL.uploadWI.folderChange(true)}else{if(c=="company"){$("controls").addClass("displayNone");$("content-local").removeClass("displayNone");$("company-files-list").removeClass("displayNone");$("controls-company").removeClass("displayNone");$("workroom-files-list").addClass("displayNone");$("controls-workroom").addClass("displayNone");EOL.uploadWI.folderChange(true)}}};EOL.uploadWI.clickSupportedTypes=function(){if($("portfolio-types-wrapper").className.search("opened")==-1){$("portfolio-types-wrapper").addClass("opened")}else{$("portfolio-types-wrapper").removeClass("opened")}EOL.uploadWI.resizeIframe.delay(10)};EOL.uploadWI.clickAddAnother=function(){$("controls").removeClass("displayNone");$("upload-source-remote").selected=true;EOL.uploadWI.onSourceChange();EOL.uploadWI.swiffy.reposition()};EOL.uploadWI.changeCollisionOption=function(a){if(a.id=="collision_rename"){$("collision-newname").removeClass("displayNone");EOL.uploadWI.resizeIframe.delay(10)}else{$("collision-newname").addClass("displayNone")}};EOL.uploadWI.collision_data={};EOL.uploadWI.submitCollisionDialog=function(){var c=EOL.uploadWI.swiffy.options.url;var d=$("form-demo");if($("collision_revision").checked){c+="&version.root="+EOL.uploadWI.collision_data.fileId+"&revise_fid="+EOL.uploadWI.collision_data.fileId+"&mode=revision";EOL.uploadWI.collision_file.setOptions({url:c})}else{if($("collision_rename").checked){var a=d.newname.value;if(a.length<=0){return EOL.uploadWI.setErrorId("userErrorTitle","errorRenameEmpty")}else{if(a==EOL.uploadWI.collision_data.fileRename){return EOL.uploadWI.setErrorId("userErrorTitle","errorRenameSame")}else{if(a.search(/[\!\'\$\^\|\*\+\?\:\%\@\,\;\(\)\[\]\`\+\{\}\&]/)!=-1){return EOL.uploadWI.setErrorId("userErrorTitle","errorRenameBadChars")}}}a+="."+EOL.uploadWI.collision_data.fileExt;var b=a;var f=EOL.uploadWI.ajaxParams+"&action=chk_file&filename="+escape(a)+"&filesize="+EOL.uploadWI.collision_file.size+"&t="+getDateTime();var g=new Request({url:EOL.uploadWI.controller,method:"post",data:f,onSuccess:EOL.uploadWI.onValidateFileUploadSuccess,onFailure:EOL.uploadWI.onValidateFileUploadFailure});g.send();c+="&name="+a;EOL.uploadWI.collision_file.setOptions({url:c});if(a.length>EOL.uploadWI.max_filename_length){a=a.substr(0,EOL.uploadWI.max_filename_length)+"..."}EOL.uploadWI.collision_file.fname.innerHTML=a;$(EOL.uploadWI.collision_file.fname).set("data-filename",b)}else{if($("collision_reference")&&$("collision_reference").checked){EOL.uploadWI.collision_file.remove();EOL.uploadWI.swiffy.createDummyFile(EOL.uploadWI.collision_data.fileName,EOL.uploadWI.collision_data.fileId);var j=0;var e;while(e=$("localfile"+j)){if(e.value==EOL.uploadWI.collision_data.fileId){e.checked=false;$(e.parentNode.parentNode).addClass("displayNone");break}j++}var h=$("form-reference");h.ref_fid0.value=EOL.uploadWI.collision_data.fileId;h.set("send",{onSuccess:EOL.uploadWI.onRefSuccess,onFailure:EOL.uploadWI.onRefFailure,onComplete:EOL.uploadWI.onRefComplete});h.send()}else{return EOL.uploadWI.setErrorId("userErrorTitle","errorSelect")}}}$(document.body).removeClass("dialog-collision");EOL.uploadWI.clearError();if($("collision_revision").checked){EOL.uploadWI.reset();EOL.uploadWI.swiffy.start.delay(10,EOL.uploadWI.swiffy)}return};EOL.uploadWI.cancelCollisionDialog=function(){$(document.body).removeClass("dialog-collision");EOL.uploadWI.collision_file.remove();EOL.uploadWI.reset();return};EOL.uploadWI.folderChange=function(d,e,b){if(d&&!e){var c=EOL.uploadWI.source;var a=$$("#"+c+"-files-list .local-files-list");if(a&&a.length==1){e=a[0].getProperty("idx");b=a[0].getProperty("listname")}}$$(".local-files-list").each(function(f){f.addClass("displayNone")});if(e){$("content-local").removeClass("parent");$("content-local").addClass("folder");$("content-local-folder").innerHTML=b;$("content-local-controls").addClass("displayNone");$("content-local-lists").removeClass("displayNone");$("localfiles"+e).removeClass("displayNone")}else{$("content-local").addClass("parent");$("content-local").removeClass("folder");$("content-local-controls").removeClass("displayNone");$("content-local-lists").addClass("displayNone")}if(EOL.uploadWI.source=="company"){$("content-local").addClass("parent");$("content-local").removeClass("folder")}EOL.uploadWI.resizeIframe.delay(50)};EOL.uploadWI.clickLocalFile=function(a){$("content-local-select").addClass("active")};EOL.uploadWI.clickRefSubmit=function(){$("controls").addClass("displayNone");$("content-local").addClass("displayNone");EOL.uploadWI.showBusy();var a=0;var c;while(c=$("localfile"+a)){if(c.checked){EOL.uploadWI.swiffy.createDummyFile(c.getAttribute("fname"),c.value);$(c.parentNode.parentNode).addClass("displayNone")}a++}EOL.uploadWI.resizeIframe.delay(10);var b=$("form-demo");b.set("send",{onSuccess:EOL.uploadWI.onRefSuccess,onFailure:EOL.uploadWI.onRefFailure,onComplete:EOL.uploadWI.onRefComplete});b.send()};EOL.uploadWI.clickRefCancel=function(){$("upload-source-remote").selected=true;EOL.uploadWI.reset()};EOL.uploadWI.uploadNewVersion=function(a){if(!EOL.uploadWI.swiffy){return setTimeout("EOL.uploadWI.uploadNewVersion("+a+")",100)}$("upload-source-remote").selected=true;EOL.uploadWI.onSourceChange();$("form-demo").uploadSource.disabled=true;EOL.uploadWI.mode="version";EOL.uploadWI.revise_fid=a;EOL.uploadWI.swiffy.options.instantStart=true};EOL.uploadWI.onCompleteSuccess=function(responseText,responseXML,file){var responseObj=eval("("+(responseText||"{}")+")");if(!responseObj||!responseObj.result){return EOL.uploadWI.setErrorId("errorTitle","error500")}file.fid=responseObj.fileId;$("avail").innerHTML=responseObj.available;if(responseObj.addToCompany==1&&!file.fake){var text="Also add to my Account Files";if(responseObj.companyFileId){text="Also update to my Account Files"}file.coLink=new Element("span",{"class":"file-atc",html:" | "}).adopt(new Element("a",{href:"#",html:text,events:{click:function(){file.addToCompany();return false}.bind(file)}}));file.coLink.inject(file.clearDiv,"before")}};EOL.uploadWI.onValidateFileUploadSuccess=function(responseText,responseXML){$("dialog-collision").addClass("displayNone");var responseObj=eval("("+(responseText||"{}")+")");if(!responseObj||!responseObj.result){return EOL.uploadWI.onValidateFileUploadFailure(this.xhr,"error500")}if(responseObj.result=="success"){if(responseObj.collision==1){$(document.body).addClass("dialog-collision");if(responseObj.rootFileId){$("collision_revision_div").removeClass("displayNone")}else{$("collision_revision_div").addClass("displayNone")}EOL.uploadWI.collision_data=responseObj;$("form-demo").newname.value=responseObj.fileRename;$("collision-newname-ext").innerHTML=responseObj.fileExt;$("dialog-collision-filename").href=responseObj.fileURL;$("dialog-collision-filename").innerHTML=responseObj.fileName;EOL.uploadWI.resizeIframe();return true}else{EOL.uploadWI.reset();return EOL.uploadWI.swiffy.start.delay(10,EOL.uploadWI.swiffy)}}else{return EOL.uploadWI.onValidateFileUploadFailure(this.xhr,"error500")}};EOL.uploadWI.onValidateFileUploadFailure=function(a,b){EOL.uploadWI.collision_file.removeAction();EOL.uploadWI.reset();if(!b){b="error"+a.status}EOL.uploadWI.failureErrorId.delay(100,null,["errorTitle",b])};EOL.uploadWI.onRefSuccess=function(responseText,responseXML){var responseObj=eval("("+(responseText||"{}")+")");if(!responseObj||!responseObj.result){return EOL.uploadWI.onRefFailure(this.xhr,"error500")}var results;for(var i in responseObj){results=i.match(/^ref_fid(\d+)$/);if(!results){continue}var idx=results[1];var fid=responseObj["fid"+idx];var file=EOL.uploadWI.swiffy.findFile(fid);if(file!=null){file.showFileRemove();file.ref_id=responseObj[i];file.fid=file.ref_id}}EOL.uploadWI.hideBusy();if(EOL.uploadWI.dialogMode){EOL.uploadWI.showDialogSaveBtn()}};EOL.uploadWI.onRefFailure=function(a,d){for(var c=0;c<EOL.uploadWI.swiffy.fileList.length;c++){var b=EOL.uploadWI.swiffy.fileList[c];if(b.fake&&!b.ref_id){b.showFileRemove();b.remove()}}if(!d){d="error"+a.status}EOL.uploadWI.failureErrorId.delay(100,null,["errorTitle",d])};EOL.uploadWI.onRefComplete=function(){var a=0;var b;while(b=$("localfile"+a)){b.checked=false;a++}EOL.uploadWI.reset()};EOL.uploadWI.onRemoveSuccess=function(responseText,responseXML){var responseObj=eval("("+(responseText||"{}")+")");if(!responseObj||!responseObj.result){return EOL.uploadWI.onFailureGeneric()}else{if(responseObj.result!="success"){return EOL.uploadWI.handleErrorGeneric(responseObj)}}$("avail").innerHTML=responseObj.available};EOL.uploadWI.onAddToCompanySuccess=function(responseText,responseXML,file){var responseObj=eval("("+(responseText||"{}")+")");if(!responseObj||!responseObj.result){return EOL.uploadWI.onFailureGeneric()}if(responseObj.result!="success"){return EOL.uploadWI.handleErrorGeneric(responseObj)}file.coLink.addClass("displayNone")};EOL.uploadWI.onFailureGeneric=function(){EOL.uploadWI.failureErrorId("errorTitle","errorAjax")};EOL.uploadWI.handleErrorGeneric=function(a){var c="";for(var b=0;b<a.errorMsgs.length;b++){c+=(b==0?"":", ")+a.errorMsgs[b]}EOL.uploadWI.failureError.delay(100,null,["Please correct the following",c])};EOL.namespace("uploadWI.fallback");EOL.uploadWI.fallback.clearUploads=function(){$("fallback-list").innerHTML="";parent.EOL.uploadW.hideBusy()};EOL.uploadWI.fallback.notifyUpload=function(d){var c=d.split("/");d={name:c[0],size:c[1],fid:c[2]};var b=d.name;if(b.length>EOL.uploadWI.max_filename_length){b=b.substr(0,EOL.uploadWI.max_filename_length)+"..."}var a="&nbsp;&nbsp("+EOL.uploadWI.sizeToKB(parseInt(d.size||"0"))+")";new Element("li",{"class":"file"}).adopt(new Element("div",{"class":"file-name",html:b}).adopt(new Element("span",{"class":"file-size",html:a})),new Element("a",{"class":"file-remove",href:"#",html:"Remove",events:{click:function(){var e="/php/upload/main/fallbackUpload.php?";var f=getArgs();f=Object.merge(f,{fallback:1,action:"delete",fileGroupId:EOL.uploadWI.fileGroupId,fileContext:EOL.uploadWI.fileContext,fileId:d.fid});e+=Object.toQueryString(f);Attach(e,{reload:true});return false}.bind(this)}}),new Element("div",{"class":"clear"})).inject($("fallback-list"));if(EOL.uploadWI.dialogMode){EOL.uploadWI.showDialogSaveBtn()}EOL.uploadWI.clearError();EOL.uploadWI.completeFile()};EOL.namespace("uploadWI.fallback.iframe");EOL.uploadWI.fallback.iframe.init=function(){var a=getArgs();EOL.uploadWI.fallback.iframe.xdomain=new XDomain(a.xdomain,"uploadW-fallback-iframe");EOL.uploadWI.fallback.iframe.parentName=a.frameName;EOL.uploadWI.fallback.iframe.fileGroupId=a.fileGroupId;EOL.uploadWI.fallback.iframe.fileContext=a.fileContext;EOL.uploadWI.fallback.iframe.params=a};EOL.uploadWI.fallback.iframe.open=function(){var a="/php/upload/main/fallbackUpload.php?";var b=EOL.uploadWI.fallback.iframe.params;b.fallback=1;a+=Object.toQueryString(b);Attach(a)};EOL.uploadWI.fallback.iframe.clearUploads=function(){EOL.uploadWI.fallback.iframe.xdomain.makeCallThroughXDomain(EOL.uploadWI.fallback.iframe.parentName,"EOL.uploadWI.fallback.clearUploads",new Array())};EOL.uploadWI.fallback.iframe.showBusy=function(){EOL.uploadWI.fallback.iframe.xdomain.makeCallThroughXDomain(EOL.uploadWI.fallback.iframe.parentName,"EOL.uploadWI.showBusy",new Array())};EOL.uploadWI.fallback.iframe.notifyUpload=function(a){EOL.uploadWI.fallback.iframe.xdomain.makeCallThroughXDomain(EOL.uploadWI.fallback.iframe.parentName,"EOL.uploadWI.fallback.notifyUpload",new Array(a))};EOL.uploadWI.sizeToKB=function(a){var b="B";if((a/1048576)>1){b="MB";a/=1048576}else{if((a/1024)>1){b="kB";a/=1024}}return a.round(1)+" "+b};EOL.namespace("uploadWW");EOL.uploadWW.toggleView=function(){var a=$("uploadW-recent-files-container");if(a.className.search("closed")!=-1){a.addClass("opened");a.removeClass("closed")}else{a.addClass("closed");a.removeClass("opened")}};EOL.uploadWW.reloadWidget=function(){if(!$("uploadW-recent-files-content")){return false}$("uploadW-recent-files-loading").removeClass("displayNone");$("uploadW-recent-files-content").addClass("displayNone");var a={url:"/php/files/main/recentFiles.php",method:"get",data:"bidid="+$("uploadW-recent-files-bidid").value+"&t="+getDateTime(),onSuccess:EOL.uploadWW.contentSuccess,onFailure:EOL.uploadWW.contentFailure};var b=new Request(a);b.send()};EOL.uploadWW.contentSuccess=function(a,b){if(a==undefined||a==""){return}$("uploadW-recent-files-loading").addClass("displayNone");$("uploadW-recent-files-content").innerHTML=a;$("uploadW-recent-files-content").removeClass("displayNone")};EOL.uploadWW.contentFailure=function(a){$("uploadW-recent-files-loading").addClass("displayNone");return};EOL.uploadWI.sendMetrics=EOL.uploadW.sendMetrics={};if(window.top.EOL.uploadWI){EOL.uploadWI.sendMetrics=window.top.EOL.uploadWI.sendMetrics||{}}if(window.top.EOL.uploadW){EOL.uploadW.sendMetrics=window.top.EOL.uploadW.sendMetrics||{}};
EOL.namespace("cloud");EOL.namespace("cloud.tag");EOL.namespace("cloud.search");EOL.cloud.tagList=[];EOL.cloud.asyncProcessingInsert=false;EOL.cloud.asyncProcessingDelete=false;EOL.cloud.init=function(){EOL.cloud.populateCloud()};window.addEvent("domready",EOL.cloud.init);EOL.cloud.resetCloud=function(){EOL.cloud.tagList=[];Array.each($("tag-spacer-user").getAllPrevious(".tag"),function(b,a){b.destroy()})};EOL.cloud.populateCloud=function(){var handleSubmitSuccess=function(req){var response=eval("("+req+")");if(response.status=="success"){if(response.data&&response.data.tags){for(mytag in response.data.tags){if(response.data.tags[mytag].text){EOL.cloud.tagList.push({identifier:response.data.tags[mytag].id,value:response.data.tags[mytag].text});EOL.cloud.tag.displayTag("user","user",response.data.tags[mytag].id,response.data.tags[mytag].text)}}}if(EOL.myjobs){EOL.myjobs.setTagViewMode(true)}else{EOL.dashboard.setTagViewMode(true)}if($("db-search-input")){EOL.cloud.search.suggest()}}if($("myjobs-results")){if(response.status=="success"&&response.data&&response.data.tags.length>0){$("cloudlist").style.display=""}else{$("noToolbarTags").style.display=""}}};var url="/php/myelance/main/dashboardAHR.php?mode=GetTags&t="+getDateTime();var options={url:url,method:"get",onSuccess:handleSubmitSuccess,onFailure:function(){}};curAsyncReq=new Request(options);curAsyncReq.send()};EOL.cloud.tag.getTagname=function(b){for(var a=0;a<EOL.cloud.tagList.length;a++){if(EOL.cloud.tagList[a]["identifier"]==b){return EOL.cloud.tagList[a]["value"]}}return null};EOL.cloud.tag.getTagid=function(a){for(var b=0;b<EOL.cloud.tagList.length;b++){if(EOL.cloud.tagList[b]["value"].toLowerCase()==a.toLowerCase()){return EOL.cloud.tagList[b]["identifier"]}}return null};EOL.cloud.tag.displayAdd=function(a){if(!$("selected"+a).value){window.addEvent("select",EOL.cloud.tag.suggest(a))}$("addnewtag"+a).style.display="block";$("addnewtagOption"+a).style.display="none";setTimeout("$('editnewtag'+"+a+").focus()",200)};EOL.cloud.tag.displayUserAdd=function(){$("addnewtaguser").style.display="block";$("addnewtagOptionuser").style.display="none";setTimeout("$('editnewtaguser').focus()",200)};EOL.cloud.tag.displayPanelAdd=function(){EOL.cloud.tag.panelSuggest($("panelProjectId").get("html"));$("panelAddNewTagLi").style.display="block";$("panelAddTag").style.display="none";$("panelAddNewTag").addClass("addingPanelTag");window.addEvent("select",EOL.cloud.tag.panelSuggest);setTimeout("$('panelAddNewTag').focus()",200);$(document.body).addEvent("click",EOL.myjobs.closeOpenTagStates);$("panelAddNewTag").value=""};EOL.cloud.clickUserTagHandler=function(a){EOL.cloud.tag.inserttag("user","user")};EOL.cloud.clickTagHandler=function(a){handleSelectedElement(null)};EOL.cloud.tag.hideAdd=function(a){$("addnewtag"+a).style.display="none";$("addnewtagOption"+a).style.display="block";if($("editnewtag"+a)){$("editnewtag"+a).value=""}};EOL.cloud.tag.add=function(a,c,b){if(window.event){b=window.event}switch(b.keyCode){case 13:$("editnewtag"+c).blur();break}};EOL.cloud.tag.panelAdd=function(b){if(b.keyCode==13){var a=$("panelAddNewTag").get("value").trim();if(EOL.myjobs.panel.verifyNewTag(a)){EOL.myjobs.panel.addTagProcess()}}};EOL.cloud.tag.inserttag=function(b,d,a){if($("editnewtag"+d)&&!$("editnewtag"+d).value.trim()){$("addnewtag"+d).style.display="none";$("addnewtagOption"+d).style.display="block"}else{var c="";if($("editnewtag"+d)){c=$("editnewtag"+d).value}else{if($("panelAddNewTag")){c=$("panelAddNewTag").value}}existingtagid=EOL.cloud.tag.getTagid(c);if(existingtagid&&b=="user"||$(d+existingtagid)){if(!$(d+existingtagid)){EOL.cloud.tag.displayTag(b,d,existingtagid,c)}else{EOL.cloud.tag.hideAdd(d)}}else{if(existingtagid&&!a){a=existingtagid}if($("panelAddNewTag")&&$("panelAddNewTag").value){d=$("panelProjectId").value;b=$("panelProjectType").value;EOL.myjobs.panel.loadTag(a,c)}EOL.cloud.tag.inserttagProcess(b,d,a,c)}}};EOL.cloud.tag.filterByTag=function(a){if($("user"+a)){if($("user"+a).hasClass("tag-cloud-selected")){EOL.dashboard.removeSearch()}else{EOL.dashboard.doSearch(a)}}};EOL.cloud.showJobsByTag=function(a){EOL.cloud.showTagCloud();EOL.cloud.tag.filterByTag(a)};EOL.cloud.tag.displayTag=function(d,h,b,g){if(EOL.myjobs){EOL.myjobs.header.prepareDisplayTag(h)}if($("addTagIcon"+h)){$("addTagIcon"+h).addClass("displayNone")}if($("addTagLink"+h)){$("addTagLink"+h).removeClass("displayNone")}if($("tagIcon"+h)){$("tagIcon"+h).removeClass("displayNone")}if(d=="bid"){var a=$("tagTemplateBidContainer").getChildren()[0].clone(true,true).inject("tag-spacer-"+h,"before")}else{if(d=="job"){var a=$("tagTemplateJobContainer").getChildren()[0].clone(true,true).inject("tag-spacer-"+h,"before")}else{if($$("#cloudlist .tag ul li").get("text").contains(g)){return}var c=$("tagTemplate").clone(true,true).inject("tag-spacer-"+h,"before");c.id="";var a=c.getChildren("ul")[0].getChildren("li")[0]}}a.id=h+b;a.innerHTML+=g;a.set("text",g.truncate(30,"..."));a.set("tagvalue",g);a.set("tagid",b);if($("myjobs-results")){a.addEvent("click",function(i){EOL.myjobs.results.showJobsByTag(i.target.get("tagid"))})}else{a.addEvent("click",function(i){if($("user"+i.target.get("tagid"))&&$("user"+i.target.get("tagid")).title){EOL.cloud.tag.filterByTag(i.target.get("tagid"))}})}var e=new Element("a",{id:h+b+"l",href:"javascript:void(0);","class":"textboxlist-bit-box-deletebutton",events:{click:function(){EOL.cloud.tag.deleteTag(b,d,h)}},title:"Remove tag"});e.inject(a);$("editnewtag"+h).value="";if($("addTagSection"+h)){var f=new Element("div",{id:"display"+h+b,"class":"tag-item-link tag-assigned left",events:{click:function(){EOL.myjobs.results.showJobsByTag(b);return false}}});new Element("a",{text:g.truncate(30,"..."),title:"Click to Filter",href:"javascript:void(0);",events:{click:function(){EOL.myjobs.results.showJobsByTag(b)}}}).inject(f);f.innerHTML+="&nbsp;";f.inject("addTagSection"+h,"before")}EOL.cloud.tag.hideAdd(h)};EOL.cloud.tag.popup=function(a,b){if(!b){b="Please correct the following"}EOL.cloud.tag.dialog=new EOL.dialog([b,a],{position:"fixed",width:350});EOL.cloud.tag.dialog.show()};EOL.cloud.tag.inserttagProcess=function(type,id,tagid,text){text=text.trim();if(!text||!text.length){return}if(EOL.cloud.asyncProcessingInsert){return}EOL.cloud.asyncProcessingInsert=true;var handleTagSubmitSuccess=function(req){var response=eval("("+req+")");if(response.status=="success"){if(!response.data){EOL.cloud.tag.popup("This project already has same tag assigned.")}else{if(response.data.text){var tagNo=$("tagCount").get("html");$("tagCount").set("html",parseInt(tagNo)+1);if($("tagCount").get("text")==1){$("tagOrTags").set("text","tag")}else{$("tagOrTags").set("text","tags")}EOL.cloud.tag.displayTag(type,id,response.data.id,response.data.text);if(!EOL.cloud.tag.getTagname(response.data.id)){EOL.cloud.tagList.push({identifier:response.data.id,value:response.data.text});if(type!="user"){EOL.cloud.tag.displayTag("user","user",response.data.id,response.data.text);if(EOL.myjobs){EOL.myjobs.setTagViewMode(true)}else{EOL.dashboard.setTagViewMode(true)}}}}}}else{EOL.cloud.tag.popup(response.errorMsgs,response.errorTitle)}};var mode;var params="";switch(type){case"job":mode="AddJobTags";params="&jobIds="+id;break;case"bid":mode="AddBidTags";params="&bidIds="+id;break}if(!tagid){mode="CreateTags";params+="&text="+encodeURIComponent(text)}else{params+="&tagId="+tagid}var url="/php/myelance/main/dashboardAHR.php?mode="+mode+"&t="+getDateTime()+params;var options={url:url,method:"post",onSuccess:handleTagSubmitSuccess,onComplete:function(){EOL.cloud.asyncProcessingInsert=false},onFailure:function(){alert("There was an error processing your request. Please refresh and try again.")}};curAsyncReq=new Request(options);if(text){curAsyncReq.send()}};EOL.cloud.tag.deleteUserTag=function(a){EOL.cloud.tag.deleteTagProcess(a,null,null)};EOL.cloud.tag.deleteTag=function(a,b,c){EOL.cloud.tag.deleteTagProcess(a,b,c)};EOL.cloud.deleteTag=function(a){EOL.cloud.tagList.each(function(b){if(b.identifier==a){EOL.cloud.tagList.erase(b)}})};EOL.cloud.tag.deleteTagProcess=function(tagid,type,id){var tagLiId=type=="user"?"user"+tagid:id+tagid;$(tagLiId).setStyle("display","none");if(EOL.cloud.asyncProcessingDelete){EOL.cloud.tag.addItemToDeleteTagQueueList(Array.prototype.slice.call(arguments));return}EOL.cloud.asyncProcessingDelete=true;var handleTagSubmitSuccess=function(req){var response=eval("("+req+")");if(response.status=="success"){if(type=="user"){$(tagLiId).dispose();var tags_divids=response.data.bidid;if(response.data.jobid){if(tags_divids&&tags_divids.length>0){tags_divids.combine(response.data.jobid)}else{tags_divids=response.data.jobid}}if(tags_divids){for(var i=0;i<tags_divids.length;i++){if($("display"+tags_divids[i]+tagid)){$("display"+tags_divids[i]+tagid).dispose()}if($(tags_divids[i]+tagid)){$(tags_divids[i]+tagid).dispose()}}}EOL.cloud.deleteTag(tagid)}else{$(tagLiId).dispose();$("display"+tagLiId).dispose()}var projects=null;if(response.data.refs.jobid){projects=response.data.refs.jobid}if(response.data.refs.bidid){if(projects){projects=response.data.refs.bidid.concat(response.data.refs.jobid)}else{projects=response.data.refs.bidid}}projects.each(function(elem){if($("display"+elem+response.data.id)){$("display"+elem+response.data.id).destroy()}});return true}else{EOL.cloud.tag.popup(response.errorMsgs)}};var mode;var params="";switch(type){case"job":mode="RemoveJobTags";params="&jobIds="+id;break;case"bid":mode="RemoveBidTags";params="&bidIds="+id;break}if(!id||id=="user"){mode="RemoveTags"}params+="&tagId="+tagid;var url="/php/myelance/main/dashboardAHR.php?tagId="+tagid+"&mode="+mode+"&t="+getDateTime()+params;var options={url:url,method:"post",onSuccess:handleTagSubmitSuccess,onComplete:function(){EOL.cloud.asyncProcessingDelete=false;EOL.cloud.tag.checkDeleteTagQueue()},onFailure:function(){alert("There was an error processing your request. Please refresh and try again.");$(tagLiId).setStyle("display","block")}};curAsyncReq=new Request(options);curAsyncReq.send()};EOL.cloud.tag.deleteTagQueueList=[];EOL.cloud.tag.addItemToDeleteTagQueueList=function(b){var a=false;Object.each(EOL.cloud.tag.deleteTagQueueList,function(c){if(c.toString()==b.toString()){a=true}});if(!a){EOL.cloud.tag.deleteTagQueueList.push(b)}};EOL.cloud.tag.checkDeleteTagQueue=function(){if(EOL.cloud.tag.deleteTagQueueList.length>0){var a=EOL.cloud.tag.deleteTagQueueList.shift();EOL.cloud.tag.deleteTagProcess.apply(EOL.cloud.tag,a)}};EOL.cloud.showTagSection=function(a){if(!a){return}$(a).onmouseout=function(){EOL.cloud.hideTagSection(a)};if($("view"+a)){$("view"+a).removeClass("displayNone")}if($("addTagSection"+a)){$("addTagSection"+a).removeClass("displayNone")}$("action"+a).addEvent("click",function(b){b.stopPropagation()})};EOL.cloud.hideTagSection=function(b){if($("view"+b)){$("view"+b).addClass("displayNone")}if($("arrow"+b)){$("arrow"+b).addClass("displayNone")}$(b).onmouseover=function(){EOL.cloud.showTagSection(b)};var a=$("add"+b);if($("addTagSection"+b)){$("addTagSection"+b).addClass("displayNone")}};EOL.cloud.toggleTagCloud=function(){if($("db-cloudTags").hasClass("db-menu-selected")){EOL.cloud.hideTagCloud()}else{EOL.cloud.showTagCloud()}};EOL.cloud.showTagCloud=function(){if($("db-cloudTags").hasClass("db-menu-selected")){return}EOL.dashboard.hideArchive();EOL.dashboard.hidePersonalize();$("db-cloudTagsRollout").removeClass("displayNone");$("db-cloudTags").addClass("db-menu-selected");EOL.cloud.tag.hideAdd("user");$("addnewtagOptionuser").style.display="none"};EOL.cloud.hideTagCloud=function(){if(!$("db-cloudTags").hasClass("db-menu-selected")){return}$("db-cloudTagsRollout").addClass("displayNone");$("db-cloudTags").removeClass("db-menu-selected");EOL.cloud.tag.hideAdd("user");$("addnewtagOptionuser").style.display="none"};EOL.cloud.clickTagViewErrorDialogCheck=function(b){var c=$(b).getParents();for(var a in c){if($(c[a])&&$(c[a]).match(".eol-dialog-container")){return true}}return false};EOL.cloud.clickTagViewModeHandler=function(a){if($(EOL.cloud.tag.selecteddivid)&&(!a.target||(!$(a.target).getParents().contains($(EOL.cloud.tag.selecteddivid))&&!EOL.cloud.clickTagViewErrorDialogCheck(a.target)))){EOL.cloud.tag.hideIndividualTags(EOL.cloud.tag.selecteddivid);$(document.body).removeEvent("click",EOL.cloud.clickTagViewModeHandler)}};EOL.cloud.clickTagCloudViewModeHandler=function(a){if($("db-cloudTags").hasClass("db-menu-selected")&&(!a.target||(!$(a.target).getParents().contains($("db-cloudTagsRollout"))&&!EOL.cloud.clickTagViewErrorDialogCheck(a.target)))){EOL.dashboard.setTagViewMode(true);$(document.body).removeEvent("click",EOL.cloud.clickTagCloudViewModeHandler)}else{if($("tagsToggle")&&$("tagsToggle").hasClass("tagsOpen")&&(!a.target||!a.target.getParents().contains($("tagsMenu")))){if(EOL.myjobs){EOL.myjobs.setTagViewMode(true)}else{EOL.dashboard.setTagViewMode(true)}}}};EOL.cloud.tag.showIndividualTags=function(a){if(EOL.cloud.tag.selecteddivid){EOL.cloud.tag.hideIndividualTags(EOL.cloud.tag.selecteddivid)}EOL.cloud.tag.selecteddivid=a;$("tag"+a).addClass("displayNone");$("action"+a).removeClass("displayNone");if($("addnewtagOptionElt"+a)){$("addnewtagOptionElt"+a).removeClass("displayNone")}if($("add"+a)){$("add"+a).addClass("displayNone")}$(document.body).addEvent("click",EOL.cloud.clickTagViewModeHandler)};EOL.cloud.tag.hideIndividualTags=function(a){if(!$("tag"+a)){return}$("tag"+a).removeClass("displayNone");$("action"+a).addClass("displayNone");if($("addnewtagOptionElt"+a)){$("addnewtagOptionElt"+a).addClass("displayNone")}};EOL.cloud.tag.suggest=function(a){EOL.cloud.tag.selected=a;EOL.cloud.tag.selectedtype=$("type"+a).value;if(!EOL.cloud.tag.autocomplete){EOL.cloud.tag.autocomplete=new Array();EOL.cloud.tag.autocompleteListSize=new Array();EOL.cloud.tag.autocompleteList=new Meio.Element.List({width:"137px"})}if(!EOL.cloud.tag.autocomplete[a]){EOL.cloud.tag.autocompleteListSize[a]=EOL.cloud.tagList.length;EOL.cloud.tag.autocomplete[a]=new Meio.Autocomplete.Select("editnewtag"+a,EOL.cloud.tagList,{cacheType:"shared",valueField:$("selected"+a),valueFilter:function(b){return b.value},filter:{filter:function(c,b){if(!c){return false}return b.value.test(new RegExp(c.escapeRegExp(),"i"))},formatMatch:function(c,b){return b.value},formatItem:function(d,c,b){return c.value}},listOptions:{width:"140px"}},EOL.cloud.tag.autocompleteList)}else{if(EOL.cloud.tag.autocompleteListSize[a]!=EOL.cloud.tagList.length){EOL.cloud.tag.autocompleteListSize[a]=EOL.cloud.tagList.length;EOL.cloud.tag.autocomplete[a].initData(EOL.cloud.tagList);EOL.cloud.tag.autocomplete[a].inputedText=""}}};EOL.cloud.search.suggest=function(){if(!EOL.cloud.search.autocomplete){EOL.cloud.search.autocompleteListSize=0}if(!EOL.cloud.search.tagList||EOL.cloud.search.autocompleteListSize!=EOL.cloud.tagList.length){EOL.cloud.search.tagList=[];for(var a=0;a<EOL.cloud.tagList.length;a++){var b=EOL.cloud.tagList[a];EOL.cloud.search.tagList.push({identifier:b.identifier,value:b.value})}}if(!EOL.cloud.search.autocomplete){EOL.cloud.search.autocompleteList=new Meio.Element.List({width:($("db-search-input").getWidth()+4)+"px",classes:{container:"ma-container-search",hover:"ma-hover-search"}});EOL.cloud.search.autocompleteListSize=EOL.cloud.search.tagList.length;EOL.cloud.search.autocomplete=new Meio.Autocomplete.Select("db-search-input",EOL.cloud.search.tagList,{cacheType:"own",valueField:$("db-search-input-tag"),valueFilter:function(c){return c.identifier},filter:{filter:function(d,c){if(!d){return false}return c.value.test(new RegExp(d.escapeRegExp(),"i"))},formatMatch:function(d,c){return"tag:"+c.value},formatItem:function(e,d,c){return d.value+"&nbsp;&nbsp;"+$("tagIcon").get("html")}},listOptions:{width:"240px",classes:{container:"ma-container-search",hover:"ma-hover-search"}}},EOL.cloud.search.autocompleteList)}else{if(EOL.cloud.search.autocompleteListSize!=EOL.cloud.search.tagList.length){EOL.cloud.search.autocompleteListSize=EOL.cloud.search.tagList.length;EOL.cloud.search.autocomplete.initData(EOL.cloud.search.tagList);EOL.cloud.search.autocomplete.inputedText=""}}};EOL.cloud.tag.panelSuggest=function(){var a=$("panelProjectId").value;if(!EOL.cloud.tag.autocomplete){EOL.cloud.tag.autocomplete=new Array();EOL.cloud.tag.autocompleteListSize=new Array();EOL.cloud.tag.autocompleteList=new Meio.Element.List({width:"auto"})}if(!EOL.cloud.tag.autocomplete[a]){EOL.cloud.tag.autocompleteListSize[a]=EOL.cloud.tagList.length;EOL.cloud.tag.autocomplete[a]=new Meio.Autocomplete.Select("panelAddNewTag",EOL.cloud.tagList,{cacheType:"shared",valueField:$("selecteduser"),valueFilter:function(b){return b.value},filter:{filter:function(c,b){if(!c){return false}return b.value.test(new RegExp(c.escapeRegExp(),"i"))},formatMatch:function(c,b){return b.value},formatItem:function(d,c,b){return c.value}},listOptions:{width:"140px"}},EOL.cloud.tag.autocompleteList)}else{if(EOL.cloud.tag.autocompleteListSize[a]!=EOL.cloud.tagList.length){EOL.cloud.tag.autocompleteListSize[a]=EOL.cloud.tagList.length;EOL.cloud.tag.autocomplete[a].initData(EOL.cloud.tagList);EOL.cloud.tag.autocomplete[a].inputedText=""}}};handleSelectedElement=function(a){if(document.activeElement==$("db-search-input")){if(a){EOL.cloud.tag.filterByTag(a)}return}if(!a){if(EOL.cloud.tag.getTagname(EOL.cloud.tag.selected)){return}}EOL.cloud.tag.inserttag(EOL.cloud.tag.selectedtype,EOL.cloud.tag.selected,a);if(EOL.cloud.tag.autocomplete&&EOL.cloud.tag.autocomplete.elements&&EOL.cloud.tag.autocomplete.elements.list&&EOL.cloud.tag.autocomplete.elements.list.hide){EOL.cloud.tag.autocomplete.elements.list.hide()}};
(function(e,f){var c=Browser;Object.append(Element.NativeEvents,{paste:2,input:2});Element.Events.paste={base:(c.opera||(c.firefox&&c.version<3))?"input":"paste",condition:function(h){this.fireEvent("paste",h,1);return false}};Element.Events.keyrepeat={base:(c.firefox||c.opera)?"keypress":"keydown",condition:Function.from(true)};var a=e.Meio||{};var g;var b={9:1,16:1,17:1,18:1,224:1,91:1,37:1,38:1,39:1,40:1};var d=function(h){return h.replace(/"/g,"&quot;").replace(/'/g,"&#39;")};a.Widget=new Class({initialize:function(){this.elements={}},addElement:function(h,i){this.elements[h]=i},addEventToElement:function(i,h,j){this.elements[i].addEvent(h,j.bind(this))},addEventsToElement:function(i,j){for(var h in j){this.addEventToElement(i,h,j[h])}},attach:function(){for(var h in this.elements){this.elements[h].attach()}},detach:function(){for(var h in this.elements){this.elements[h].detach()}},destroy:function(){for(var h in this.elements){this.elements[h]&&this.elements[h].destroy()}}});a.Autocomplete=new Class({Extends:a.Widget,Implements:[Options,Events],options:{delay:200,minChars:0,cacheLength:20,selectOnTab:true,maxVisibleItems:10,cacheType:"shared",filter:{},fieldOptions:{},listOptions:{},requestOptions:{},urlOptions:{}},initialize:function(h,k,i,j){this.parent();this.setOptions(i);this.active=0;this.filters=a.Autocomplete.Filter.get(this.options.filter);this.addElement("list",j||new a.Element.List(this.options.listOptions));this.addListEvents();this.addElement("field",new a.Element.Field(h,this.options.fieldOptions));this.addFieldEvents();this.addSelectEvents();this.attach();this.initCache();this.initData(k)},addFieldEvents:function(){this.addEventsToElement("field",{beforeKeyrepeat:function(j){this.active=1;var h=j.key,i=this.elements.list;if(h=="up"||h=="down"||(h=="enter"&&i.showing)){j.preventDefault()}},delayedKeyrepeat:function(j){var h=j.key,i=this.elements.field;i.keyPressControl[h]=true;switch(h){case"up":case"down":this.focusItem(h);break;case"enter":this.setInputValue();break;case"tab":if(this.options.selectOnTab){this.setInputValue()}i.keyPressControl[h]=false;break;case"esc":this.elements.list.hide();break;default:this.setupList()}this.oldInputedText=i.node.get("value")},keyup:function(i){var h=this.elements.field;if(!b[i.code]){if(!h.keyPressControl[i.key]){this.setupList()}h.keyPressControl[i.key]=false}},focus:function(){this.active=1;var h=this.elements.list;h.focusedItem=null;h.positionNextTo(this.elements.field.node)},click:function(){if(++this.active>2&&!this.elements.list.showing){this.forceSetupList()}},blur:function(i){this.active=0;var h=this.elements.list;if(h.shouldNotBlur){h.shouldNotBlur=false;if(h.focusedItem){h.hide()}}else{h.hide()}},paste:function(){return this.setupList()}})},addListEvents:function(){this.addEventsToElement("list",{mousedown:function(h){if(this.active&&!h.dontHide){this.setInputValue()}}})},update:function(){var p=this.data,r=this.elements.list;var t=p.getKey(),l=this.cache.get(t),q;if(l){q=l.html;this.itemsData=l.data}else{p=p.get();var v=[],u=[],m=r.options.classes,w=this.inputedText;var j=this.filters.filter,h=this.filters.formatMatch,s=this.filters.formatItem;for(var x,o=0,k=0;x=p[o++];){if(j.call(this,w,x)){v.push('<li title="',d(h.call(this,w,x)),'" data-index="',k,'" class="',(k%2?m.even:m.odd),'">',s.call(this,w,x,k),"</li>");u.push(x);k++}}q=v.join("");this.cache.set(t,{html:q,data:u});this.itemsData=u}r.focusedItem=null;this.fireEvent("deselect",[this.elements]);r.list.set("html",q);if(this.options.maxVisibleItems){r.applyMaxHeight(this.options.maxVisibleItems)}},setupList:function(){this.inputedText=this.elements.field.node.get("value");if(this.inputedText!==this.oldInputedText){this.forceSetupList(this.inputedText)}else{this.elements.list.hide()}return true},forceSetupList:function(h){h=h||this.elements.field.node.get("value");if(h.length>=this.options.minChars){clearInterval(this.prepareTimer);this.prepareTimer=this.data.prepare.delay(this.options.delay,this.data,this.inputedText)}},dataReady:function(){this.update();if(this.onUpdate){this.onUpdate();this.onUpdate=null}var h=this.elements.list;if(h.list.get("html")){if(this.active){h.show()}}else{this.fireEvent("noItemToList",[this.elements]);h.hide()}},setInputValue:function(){var i=this.elements.list;if(i.focusedItem){var j=i.focusedItem.get("title");this.elements.field.node.set("value",j);var h=i.focusedItem.get("data-index");this.fireEvent("select",[this.elements,this.itemsData[h],j,h]);if(typeof handleSelectedElement=="function"){handleSelectedElement(this.itemsData[h].identifier)}}else{if(typeof handleSelectedElement=="function"){handleSelectedElement(null)}}i.hide()},focusItem:function(i){var h=this.elements.list;if(h.showing){h.focusItem(i)}else{this.forceSetupList();this.onUpdate=function(){h.focusItem(i)}}},addSelectEvents:function(){this.addEvents({select:function(h){h.field.addClass("selected")},deselect:function(h){h.field.removeClass("selected")}})},initData:function(h){this.data=(typeOf(h)=="string")?new a.Autocomplete.Data.Request(h,this.cache,this.elements.field,this.options.requestOptions,this.options.urlOptions):new a.Autocomplete.Data(h,this.cache);this.data.addEvent("ready",this.dataReady.bind(this))},initCache:function(){var h=this.options.cacheLength;if(this.options.cacheType=="shared"){this.cache=g;this.cache.setMaxLength(h)}else{this.cache=new a.Autocomplete.Cache(h)}},refreshCache:function(h){this.cache.refresh();this.cache.setMaxLength(h||this.options.cacheLength)},refreshAll:function(i,h){this.refreshCache(i);this.data.refreshKey(h)}});a.Autocomplete.Select=new Class({Extends:a.Autocomplete,options:{syncName:"id",valueField:null,valueFilter:function(h){return h.id}},initialize:function(h,k,i,j){this.parent(h,k,i,j);this.valueField=f(this.options.valueField);if(!this.valueField){return}this.syncWithValueField(k)},syncWithValueField:function(i){var h=this.getValueFromValueField();if(h&&this.options.syncName){this.addParameter(i);this.addDataReadyEvent(h);this.data.prepare(this.elements.field.node.get("value"))}else{this.addValueFieldEvents()}},addValueFieldEvents:function(){this.addEvents({select:function(i,h){this.valueField.set("value",this.options.valueFilter.call(this,h))},deselect:function(h){this.valueField.set("value","")}})},addParameter:function(h){this.parameter={name:this.options.syncName,value:function(){return this.valueField.value}.bind(this)};if(this.data.url){this.data.url.addParameter(this.parameter)}},addDataReadyEvent:function(j){var i=this;var h=function(){i.addValueFieldEvents();var k=this.get();for(var l=k.length;l--;){if(i.options.valueFilter.call(i,k[l])==j){var m=i.filters.formatMatch.call(i,"",k[l],0);i.elements.field.node.set("value",m);i.fireEvent("select",[i.elements,k[l],m,l]);break}}if(this.url){this.url.removeParameter(i.parameter)}this.removeEvent("ready",h)};this.data.addEvent("ready",h)},getValueFromValueField:function(){return this.valueField.get("value")}});a.Autocomplete.Select.One=new Class({Extends:a.Autocomplete.Select,options:{filter:{path:"text"}},initialize:function(h,i,j){this.select=f(h);this.replaceSelect();this.parent(this.field,this.createDataArray(),Object.merge(i||{},{valueField:this.select,valueFilter:function(k){return k.value}}),j)},replaceSelect:function(){var h=this.select.getSelected()[0];this.field=new Element("input",{type:"text"});var i=h.get("value");if(i||i===0){this.field.set("value",h.get("html"))}this.select.setStyle("display","none");this.field.inject(this.select,"after")},createDataArray:function(){var j=this.select.options,l=[];for(var k=0,h,m;h=j[k++];){m=h.value;if(m||m===0){l.push({value:m,text:h.innerHTML})}}return l},addValueFieldEvents:function(){this.addEvents({select:function(k,j,l,h){var i=this.valueField.getElement('option[value="'+this.options.valueFilter.call(this,j)+'"]');if(i){i.selected=true}},deselect:function(i){var h=this.valueField.getSelected()[0];if(h){h.selected=false}}})},getValueFromValueField:function(){return this.valueField.getSelected()[0].get("value")}});a.Element=new Class({Implements:[Events],initialize:function(h){this.setNode(h);this.createBoundEvents();this.attach()},setNode:function(h){this.node=h?f(h)||$$(h)[0]:this.render()},createBoundEvents:function(){this.bound={};this.boundEvents.each(function(h){this.bound[h]=function(i){this.fireEvent("before"+h.capitalize(),i);this[h]&&this[h](i);this.fireEvent(h,i);return true}.bind(this)},this)},attach:function(){for(var h in this.bound){this.node.addEvent(h,this.bound[h])}},detach:function(){for(var h in this.bound){this.node.removeEvent(h,this.bound[h])}},addClass:function(h){this.node.addClass(this.options.classes[h])},removeClass:function(h){this.node.removeClass(this.options.classes[h])},toElement:function(){this.node},render:function(){}});a.Element.Field=new Class({Extends:a.Element,Implements:[Options],options:{classes:{loading:"ma-loading",selected:"ma-selected"}},initialize:function(i,h){this.keyPressControl={};this.boundEvents=["paste","focus","blur","click","keyup","keyrepeat"];if(c.ie6){this.boundEvents.push("keypress")}this.setOptions(h);this.parent(i);f(e).addEvent("unload",function(){if(f(this.node)){f(this.node).set("autocomplete","on")}}.bind(this))},setNode:function(h){this.parent(h);this.node.set("autocomplete","off")},keyrepeat:function(h){clearInterval(this.keyrepeatTimer);this.keyrepeatTimer=this._keyrepeat.delay(1,this,h)},_keyrepeat:function(h){this.fireEvent("delayedKeyrepeat",h)},destroy:function(){this.detach();this.node.removeAttribute("autocomplete")},keypress:function(h){if(h.key=="enter"){this.bound.keyrepeat(h)}}});a.Element.List=new Class({Extends:a.Element,Implements:[Options],options:{width:"field",classes:{container:"ma-container",hover:"ma-hover",odd:"ma-odd",even:"ma-even"}},initialize:function(h){this.boundEvents=["mousedown","mouseover"];this.setOptions(h);this.parent();this.focusedItem=null},applyMaxHeight:function(l){var h=this.list.childNodes;var k=h[l-1]||(h.length?h[h.length-1]:null);if(!k){return}k=f(k);for(var j=2;j--;){this.node.setStyle("height",k.getCoordinates(this.list).bottom)}},mouseover:function(i){var h=this.getItemFromEvent(i),j=this.options.classes.hover;if(!h){return true}if(this.focusedItem){this.focusedItem.removeClass(j)}h.addClass(j);this.focusedItem=h;this.fireEvent("focusItem",[this.focusedItem])},mousedown:function(h){h.preventDefault();this.shouldNotBlur=true;if(!(this.focusedItem=this.getItemFromEvent(h))){h.dontHide=true;return true}this.focusedItem.removeClass(this.options.classes.hover)},focusItem:function(i){var j=this.options.classes.hover,h;if(this.focusedItem){if((h=this.focusedItem[i=="up"?"getPrevious":"getNext"]())){this.focusedItem.removeClass(j);h.addClass(j);this.focusedItem=h;this.scrollFocusedItem(i)}}else{if((h=this.list.getFirst())){h.addClass(j);this.focusedItem=h}}},scrollFocusedItem:function(k){var h=this.focusedItem.getCoordinates(this.list),j=this.node.scrollTop;if(k=="down"){var l=h.bottom-this.node.getStyle("height").toInt();if((l-j)>0){this.node.scrollTop=l}}else{var i=h.top;if(j&&j>i){this.node.scrollTop=i}}},getItemFromEvent:function(i){var h=i.target;while(h&&h.tagName.toLowerCase()!="li"){if(h===this.node){return null}h=h.parentNode}return f(h)},render:function(){var h=new Element("div",{"class":this.options.classes.container});if(h.bgiframe){h.bgiframe({top:0,left:0})}this.list=new Element("ul").inject(h);f(document.body).grab(h);return h},positionNextTo:function(i){var j=this.options.width,k=this.node;var h=this.options.position,k=this.node;var l=i.getCoordinates();k.setStyle("width",j=="field"?i.getWidth().toInt()-k.getStyle("border-left-width").toInt()-k.getStyle("border-right-width").toInt():j);if(h){k.setPosition({x:(parseInt(l.left)+parseInt(h)),y:l.bottom})}else{k.setPosition({x:l.left-10,y:l.bottom})}},show:function(){this.node.scrollTop=0;this.node.setStyle("visibility","visible");this.showing=true},hide:function(){this.showing=false;this.node.setStyle("visibility","hidden")}});a.Autocomplete.Filter={filters:{},get:function(h){var i=h.type,k=(h.path||"").split(".");var j=(i&&this.filters[i])?this.filters[i](this,k):h;return Object.merge(this.defaults(k),j)},define:function(i,h){this.filters[i]=h},defaults:function(i){var h=this;return{filter:function(k,j){return k?h._getValueFromKeys(j,i).test(new RegExp(k.escapeRegExp(),"i")):true},formatMatch:function(k,j){return h._getValueFromKeys(j,i)},formatItem:function(l,k,j){return l?h._getValueFromKeys(k,i).replace(new RegExp("("+l.escapeRegExp()+")","gi"),"<strong>$1</strong>"):h._getValueFromKeys(k,i)}}},_getValueFromKeys:function(m,k){var j,l=m;for(var h=0;j=k[h++];){l=l[j]}return l}};a.Autocomplete.Filter.define("contains",function(h,i){return{}});a.Autocomplete.Filter.define("startswith",function(h,i){return{filter:function(k,j){return k?h._getValueFromKeys(j,i).test(new RegExp("^"+k.escapeRegExp(),"i")):true}}});a.Autocomplete.Data=new Class({Implements:[Options,Events],initialize:function(i,h){this._cache=h;this.data=i;this.dataString=JSON.encode(this.data)},get:function(){return this.data},getKey:function(){return this.cachedKey},prepare:function(h){this.cachedKey=this.dataString+(h||"");this.fireEvent("ready")},cache:function(h,i){this._cache.set(h,i)},refreshKey:function(){}});a.Autocomplete.Data.Request=new Class({Extends:a.Autocomplete.Data,options:{noCache:true,formatResponse:function(h){return h}},initialize:function(k,i,l,j,h){this.setOptions(j);this.rawUrl=k;this._cache=i;this.element=l;this.urlOptions=h;this.refreshKey();this.createRequest()},prepare:function(h){this.cachedKey=this.url.evaluate(h);if(this._cache.has(this.cachedKey)){this.fireEvent("ready")}else{this.request.send({url:this.cachedKey})}},createRequest:function(){var h=this;this.request=new Request.JSON(this.options);this.request.addEvents({request:function(){h.element.addClass("loading")},complete:function(){h.element.removeClass("loading")},success:function(i){h.data=h.options.formatResponse(i);h.fireEvent("ready")}})},refreshKey:function(h){h=Object.merge(this.urlOptions,{url:this.rawUrl},h||{});this.url=new a.Autocomplete.Data.Request.URL(h.url,h)}});a.Autocomplete.Data.Request.URL=new Class({Implements:[Options],options:{queryVarName:"q",extraParams:null,max:20},initialize:function(j,h){this.setOptions(h);this.rawUrl=j;this.url=j;this.url+=this.url.contains("?")?"&":"?";this.dynamicExtraParams=[];var l=Array.from(this.options.extraParams);for(var k=l.length;k--;){this.addParameter(l[k])}if(this.options.max){this.addParameter("limit="+this.options.max)}},evaluate:function(l){l=l||"";var k=this.dynamicExtraParams,h=[];h.push(this.options.queryVarName+"="+encodeURIComponent(l));for(var j=k.length;j--;){h.push(encodeURIComponent(k[j].name)+"="+encodeURIComponent(Function.from(k[j].value)()))}return this.url+h.join("&")},addParameter:function(h){if(h.nodeType==1||typeOf(h.value)=="function"){this.dynamicExtraParams.push(h)}else{this.url+=((typeOf(h)=="string")?h:encodeURIComponent(h.name)+"="+encodeURIComponent(h.value))+"&"}},removeParameter:function(h){this.dynamicExtraParams.erase(h)}});a.Autocomplete.Cache=new Class({initialize:function(h){this.refresh();this.setMaxLength(h)},set:function(h,i){if(!this.cache[h]){if(this.getLength()>=this.maxLength){var j=this.pos.shift();this.cache[j]=null;delete this.cache[j]}this.cache[h]=i;this.pos.push(h)}return this},get:function(h){return this.cache[h||""]||null},has:function(h){return !!this.get(h)},getLength:function(){return this.pos.length},refresh:function(){this.cache={};this.pos=[]},setMaxLength:function(h){this.maxLength=Math.max(h,1)}});g=new a.Autocomplete.Cache();e.Meio=a})(this,document.id||$);
EOL.namespace("logger");EOL.logger.logging={log:function(e,b,d,c,g,f,a){this.logEvent(e,b,d,c,g,f,a,true)},logSync:function(e,b,d,c,g,f,a){this.logEvent(e,b,d,c,g,f,a,false)},logCustomData:function(c,a,b,d){this._logCustomDataEvent(c,a,b,d,true)},logCustomDataSync:function(c,a,b,d){this._logCustomDataEvent(c,a,b,d,false)},logEvent:function(a,i,d,h,b,c,f,e){var g={event:a,location:i,sublocation:d,timestamp:new Date().getTime(),data:[{type:h,id:b,indexed:c,position:f}]};this._sendLoggingData(g,e)},_logCustomDataEvent:function(d,a,c,f,b){var e={event:d,location:a,sublocation:c,timestamp:new Date().getTime()};e.data=[];if(f!==null){e.data=f}this._sendLoggingData(e,b)},_sendLoggingData:function(e,b){var a=JSON.stringify(e),d=b?10000:3000,c=new Request({url:"/sf/event-logging-proxy",method:"post",format:"json",async:b,timeout:d,data:{data:a}});c.send()}};
window.addEvent("load",function(){var b=$("eInvitation");if(b){var a=b.get("data-location");EOL.logger.logging.logCustomData("impression",a,"invitation_widget",[]);b.getElementsByClassName("learnMoreButton")[0].addEvent("click",function(){EOL.logger.logging.logCustomDataSync("click_learn_more",a,"invitation_widget",[])})}});
EOL.namespace("oDeskInvitation");EOL.oDeskInvitation.ClientInvitationPopUp=(function(){return new Class({Extends:EOL.modal,options:{url:null,firstName:null,clickAwayClose:true},initialize:function(a){var b={1:{header:"Don't miss out!",text:"New jobs await on Upwork (formerly oDesk)",button:"Duplicate your Elance account"},2:{header:"Don't miss out!",text:"Access more great talent on Upwork (formerly oDesk)",button:"Get started today"}};a.content='<div class="body clientInvitationPopUp"><h3>'+b[a.type].header+"</h3><br><p>"+b[a.type].text+"</p><img src='/sf/bundles/elancedashboard/img/freelancer-invite-icon.png' class='eInvitationIcon'><div class=\"eInvitationControls\"><a href=\""+a.url+'" class="btn-large btn-large-normal control learnMoreButton">'+b[a.type].button+"</a></div></div>";this.parent(a)},close:function(){this.hide();this.fireEvent("close")}})})();
EOL.namespace("dashboard.collab");EOL.dashboard.collab.index=1;EOL.dashboard.collab.getMessageReq=null;EOL.dashboard.collab.getMessages=function(a,b){if(EOL.dashboard.collab.getMessageReq&&EOL.dashboard.collab.getMessageReq.isRunning()){return false}var c="page="+b+"&bidid="+a+"&index="+(EOL.dashboard.collab.index+1);EOL.dashboard.collab.getMessageReq=new Request({url:"/sf/dashboard/pmb/messages",data:c,method:"GET",onSuccess:function(d){d=JSON.decode(d);var e=Elements.from(d.html);e.getElement(".messageText").each(function(g){var h=g.get("html");var f=g.getProperty("elanceMessage")=="Y";g.set("html",h.collabHtmlEnc(f))});e.inject($("dashboard-pmb-messages"));if(!d.moreResults){$("dashboard-pmb-more").hide()}else{$("dashboard-pmb-more").set("html","Load "+d.moreResults+" more messages")}$("pmb-page").value=d.page;EOL.dashboard.collab.index++}});EOL.dashboard.collab.getMessageReq.send()};EOL.dashboard.collab.expandForm=function(){if($("dashboardCollabForm").hasClass("expanded")){return}$("dashboardCollabForm").addClass("expanded");$$("#dashboardCollabForm textarea")[0].set("html","");EOL.dashboard.collab.setUploadParam()};EOL.dashboard.collab.setUploadParam=function(){EOL.namespace("uploadW");EOL.uploadW.dialogMode=false;EOL.uploadW.fileGroupId=0;EOL.uploadW.fileContext="pmb";EOL.uploadW.iframeSRC="/php/files/main/uploadIframe.php?messageid=&bidid="+$("panelProjectId").value;EOL.uploadW.addtionalCss="upload-dashboard.css";EOL.uploadW.initInclude();EOL.uploadW.showBusy=function(){disableElems($("msgButtonContent"))};EOL.uploadW.hideBusy=function(){enableElems($("msgButtonContent"))}};EOL.dashboard.collab.collapseForm=function(){$("dashboardCollabForm").removeClass("expanded")};EOL.dashboard.collab.postReq=null;EOL.dashboard.collab.postMessageMetricTagSource=null;EOL.dashboard.collab.postMessage=function(){if(EOL.dashboard.collab.postReq&&EOL.dashboard.collab.postReq.isRunning()){return false}$("pmbError").hide();if($("dashboard-pmb-no-messages")){$("dashboard-pmb-no-messages").hide()}var a=$("dashboardCollabForm").toQueryString()+"&online=&meeting=N&connected=N&action=submit&fileGroupId="+EOL.uploadW.getFileGroupId();$el("send","useraction","CLICK","jobInfoPanelMessagesPost",{userId:getCookie("userid"),pageName:EOL.dashboard.collab.postMessageMetricTagSource||"not-specified",logEntries:{bidid:$("pmbBidId").value}});EOL.dashboard.collab.postReq=new Request({url:"/php/collab/main/MessageAHR.php",data:a,method:"POST",onSuccess:function(c){c=JSON.decode(c);if(c.status=="error"){var d=$("pmbError").getElement("ul");d.empty();for(i=0;i<c.errorMsgs.length;i++){var b=new Element("li",{html:c.errorMsgs[i]});b.inject(d)}$("pmbError").show()}else{EOL.dashboard.collab.createMessage(JSON.decode(c.data.message));EOL.uploadW.reset();$("dashboardCollabForm").getElement("textarea").value=""}}});EOL.dashboard.collab.postReq.send()};EOL.dashboard.collab.postBulkMessage=function(){var d=$("bulkMsgTxt").get("value").trim();$("pmbBulkError").hide();EOL.dashboard.collab.setUploadParam();if($("bulkPanelTitle").get("text")=="0 Items Selected"){EOL.dashboard.collab.showError("You cannot send message to empty folder.");return}if(d){if(d.length>4000){EOL.dashboard.collab.showError("Message cannot contain more than 4000 characters.");return}$("broadcast-send").removeClass("btn-small-normal");$("broadcast-send").addClass("btn-small-disabled");$("bulkLoader").show();var a=new Element("div",{"class":"dashboard-pmb owner"});var c=new Element("div",{"class":"message"});var e=$("statusFilter_input").value;$el("send","useraction","CLICK","BroadcastPanelPost",{userId:getCookie("userid"),pageName:"MyJobs",logEntries:{numberOfBids:$("myjobs-results").getElements(".selected").length}});var b=new Request({url:"/sf/myjobs/actions/bulk/messages?t="+getDateTime(),method:"POST",data:"&msg="+encodeURIComponent(d)+"&projects="+encodeURIComponent(EOL.dashboard.collab.getSelectedProjects())+"&statusFilter="+e,onSuccess:function(f){f=JSON.decode(f);if(f.success){new Element("div",{"class":"messageText",html:d.collabHtmlEnc()}).inject(c);c.inject(a);new Element("div",{"class":"indicator",html:"<!-- -->"}).inject(a);var g=new Date().format("%b %e, %Y %l:%M %p");new Element("div",{"class":"signature",html:f.displayName+" | "+g}).inject(a);EOL.uploadW.closeBulkAttach();$("bulkLoader").hide();a.inject($("bulkPostedMsgs"),"top");$("broadcast-send").toggleClass("btn-small-disabled");$("broadcast-send").toggleClass("btn-small-normal")}else{EOL.dashboard.collab.showError(f.errorText)}},onFailure:function(){}}).send()}else{EOL.dashboard.collab.showError("You must enter a message for sending.")}$("bulkMsgTxt").set("value","")};EOL.dashboard.collab.showError=function(b){$("bulkLoader").hide();if(b.length>0){var c=$("pmbBulkError").getElement("ul");c.empty();var a=new Element("li",{html:b});a.inject(c);$("pmbBulkError").show();$("broadcast-send").removeClass("btn-small-disabled");$("broadcast-send").addClass("btn-small-normal")}};EOL.dashboard.collab.getSelectedProjects=function(){var a={};$("myjobs-results").getElements(".selected").each(function(b){a[b.get("projectid")]=b.get("projecttype")});return JSON.stringify(a)};EOL.dashboard.collab.createMessage=function(d){var a=new Element("div",{"class":"dashboard-pmb owner"});var c=new Element("div",{"class":"message"});new Element("div",{"class":"messageText",html:d.messageContent.collabHtmlEnc()}).inject(c);if(d.attachments&&d.attachments.length){for(i=0;i<d.attachments.length;i++){var f=d.attachments[i];var b=new Element("div",{"class":"msgAttachement"});if(f.thumbURL||f.iconURL){new Element("a",{href:f.url,html:'<img border="0" src="'+(f.thumbURL?f.thumbURL:f.iconURL)+'">',target:"_blank"}).inject(b)}new Element("a",{href:f.url,html:f.name,target:"_blank"}).inject(b);b.inject(c)}}c.inject(a);new Element("div",{"class":"indicator",html:"<!-- -->"}).inject(a);var e=new Date(d.timestamp*1000).format("%b %e, %Y")+" "+d.time;new Element("div",{"class":"signature",html:d.sender+" | "+e}).inject(a);a.inject($("dashboard-pmb-messages"),"top")};
EOL.namespace("adwidget");EOL.adwidget.loadAdWidget=function(){var a=new Request({url:"sf/widget/ad/load",method:"GET",onSuccess:function(b){var c=JSON.decode(b);var d=$("marketingAds");if(c.active){d.set("class","productMarketingWidget");d.set("html",c.html);d.set("adNumber",c.adNumber);d.set("active",c.active);EOL.adwidget.setAds(c.adNumber,c.count);if(c.duration>0&&c.active){window.setInterval(function(){EOL.adwidget.changeNext(c.count)},c.duration*1000)}}else{d.set("html","");d.set("class","none")}}}).send()};EOL.adwidget.setAds=function(d,b){for(var a=1;a<b+1;a++){if(a!=d){$("ad"+a).set("tween",{duration:1000});$("adbody"+a).fade("out")}else{var c=$("adbody"+a).get("title");$("title").set("value",c);_gaq.push(["_trackEvent","ad_widget","view",c])}}};EOL.adwidget.changeAd=function(a){var b=$("marketingAds").get("adNumber");$("adbody"+b).fade("out");$("ad"+b).set("style","display:none; height:100%;");$("adbody"+a).fade("in");$("ad"+a).set("style","height:100%;");$("marketingAds").set("adNumber",a);var c=$("adbody"+a).get("title");$("title").set("value",c);if($("ad"+a).get("viewed")=="false"){_gaq.push(["_trackEvent","ad_widget","view",c]);$("ad"+a).set("viewed","true")}};EOL.adwidget.changeNext=function(c){var b=$("marketingAds");var a=parseInt(b.get("adNumber"));a=a+1;if(a>c){a=a%c}EOL.adwidget.changeAd(a)};EOL.adwidget.mouseOver=function(a){a.set("src","/sf/bundles/elancedashboard/img/icon_pag_mouseover.png")};EOL.adwidget.mouseOut=function(a){if(a.get("id")=="default"){a.set("src","/sf/bundles/elancedashboard/img/icon_pag_default.png")}else{a.set("src","/sf/bundles/elancedashboard/img/icon_pag_selected.png")}};
EOL.namespace("dashboard.widget");EOL.dashboard.widget.load=function(g,c,e,f,b){if(!e){e=""}if(typeof(b)==="undefined"){b=false}var d=function(h){if(!b){h=JSON.decode(h)}$(g).set("opacity",0);$(g).set("html",h.data.html);new Fx.Tween(g,{duration:200}).start("opacity",1);if(f){f()}};var a={url:c,method:"get",data:e,onSuccess:d,onFailure:function(){}};if(b){curAsyncReq=new Request.JSONP(a)}else{curAsyncReq=new Request(a)}curAsyncReq.send()};EOL.dashboard.widget.loadReportsWidget=function(){if(!$("reportsjs")){new Asset.javascript("/scripts/lib/marketing/raphael.js,reports/payments.js",{id:"reportsjs",onLoad:EOL.dashboard.widget.initReportsWidget})}};EOL.dashboard.widget.initReportsWidget=function(){EOL.paymentsReport.filterEndDate=new Date();endTs=EOL.paymentsReport.filterEndDate.getTime();startTs=endTs-1000*60*60*24*7*24;EOL.paymentsReport.filterStartDate=new Date(startTs);EOL.paymentsReport.loadChart("jobsPie","db-reports",EOL.dashboard.widget.drawReportsWidget)};EOL.dashboard.widget.drawReportsWidget=function(b,d){$("db-lnav-reports").getElement(".db-lnav-reports-viewAll").removeClass("displayNone");if(d.data.length==0){return false}$(b).innerHTML="";var a=EOL.paymentsReport.graphics.getPieChartColors(d.labels);var c=new Raphael(b,284,212).pieChart(132,100,100,d.data,a,"#fff");EOL.paymentsReport.graphics.createPieChartLegend(b,d.labels,a,35);return true};EOL.namespace("dashboard.card");EOL.dashboard.card.select=function(a){a.addClass("selected");a.getElement(".checkbox").addClass("checked")};EOL.dashboard.card.unselect=function(a){a.removeClass("selected");a.getElement(".checkbox").removeClass("checked")};EOL.dashboard.card.isSelected=function(a){return a.hasClass("selected")};EOL.dashboard.card.toggleAll=function(b,a){var d=$$("#"+b+"-results .dashboard-card");if(!d.length){return}var c=(!$("multi-toggle").hasClass("checked"))?true:false;d.each(function(e){if(c){EOL.dashboard.card.select(e)}else{EOL.dashboard.card.unselect(e)}});if(c){$("multi-toggle").addClass("checked");a.showBulk();a.open()}else{$("multi-toggle").removeClass("checked");a.close()}};EOL.namespace("dashboard.preferences");EOL.dashboard.preferences.save=function(a,c){var d="";if(a=="statusFilter"){d+="statusFilter="+c}if(a=="contractorStatusFilter"){d+="contractorStatusFilter="+c}if(a=="contractorViewFilter"){d+="contractorViewFilter="+c}if(a=="contextFilter"){d+="contextFilter="+c}if(a=="showCompanyJobs"){d+="showCompanyJobs="+($("onlyMyJobs").checked?"N":"Y")}if(a=="contractorShowJobs"){d+="contractorShowJobs="+c}if(a=="showCompanyContractors"){d+="showCompanyContractors="+($("onlyMyContractors").checked?"N":"Y")}if(a=="modules"){if($("mycontractorsPref")){d+="mycontractorsPref="+($("mycontractorsPref").checked?"Y":"N")}if($("openjobsPref")){d+="&openjobsPref="+($("openjobsPref").checked?"Y":"N")}if($("reportsPref")){d+="&reportsPref="+($("reportsPref").checked?"Y":"N")}if($("profileCompletenessPref")){d+="&profileCompletenessPref="+($("profileCompletenessPref").checked?"Y":"N")}if($("groupsOnboardingPref")){d+="&groupsOnboardingPref="+($("groupsOnboardingPref").checked?"Y":"N")}if($("bulkPaymentsPref")){d+="&bulkPaymentsPref="+($("bulkPaymentsPref").checked?"Y":"N")}}if(a=="listStyle"){d+="listStyle="+$$("input[name=listStyleChoice]:checked").get("value")}if(a=="home"){d+="home="+c}if(a=="showFoldersFirst"){d+="showFoldersFirst="+($("foldersFirstPref").checked?"Y":"N")}var b=new Request({url:"/sf/myjobs/prefs/save",data:d,method:"POST",onSuccess:function(e){if(a=="statusFilter"||a=="contractorStatusFilter"){statusFilter.change(c)}if(a=="contractorViewFilter"){viewFilter.change(c)}if(a=="contextFilter"){contextFilter.change(c)}if(a=="showCompanyJobs"){EOL.myjobs.results.reload()}if(a=="showCompanyContractors"){EOL.mycontractors.results.reload()}if(a=="modules"||a=="listStyle"){window.location.reload()}if(a=="home"){if(EOL.myjobs){EOL.myjobs.header.toggleSettings()}if(EOL.mycontractors){EOL.mycontractors.header.toggleSettings()}}if(a=="showFoldersFirst"){EOL.myjobs.results.reload()}}}).send()};EOL.namespace("dashboard.tooltip");EOL.dashboard.tooltip.markSeen=function(a){var c="tooltip="+a;var b=new Request({url:"/sf/myjobs/prefs/save",data:c,method:"POST",onSuccess:function(d){}}).send()};EOL.namespace("dashboard.select");EOL.dashboard.select=function(d,b,c){var a=this;this.id=d;this.onchange=b;this.selectedElem=null;this.selectedText=null;this.menuElem=null;this.init=function(){var e=$(this.id).getElementsByTagName("li");this.selectedElem=e[0];this.selectedText=$(this.id).getElement(".eol-select-selected");this.menuElem=e[1].getElementsByTagName("ul")[0];e=this.menuElem.getElementsByTagName("li");for(var f=0;f<e.length;f++){if(window.addEventListener){e[f].addEventListener("click",this.clickValue,false)}else{if(window.attachEvent){e[f].attachEvent("onclick",this.clickValue)}}}if(window.addEventListener){this.selectedElem.addEventListener("click",this.toggleMenu,false)}else{if(window.attachEvent){this.selectedElem.attachEvent("onclick",this.toggleMenu)}}};this.clickValue=function(g){var f=null;if(window.event){f=window.event.srcElement}else{f=(g.target.tagName)?g.target:g.target.parentNode}var e=f.getAttribute("val");a.changeVal(e);a.toggleMenu()};this.changeVal=function(g){var e=this.menuElem.getElementsByTagName("li");for(var f=0;f<e.length;f++){if(e[f].getAttribute("val")==g){this.selectedText.innerHTML=e[f].innerHTML;break}}$(this.id+"_input").value=g;if(a.onchange){a.onchange(g)}};this.clickAwayMenu=function(f){var e=null;if(window.event){e=window.event.srcElement}else{e=(f.target.tagName)?f.target:f.target.parentNode}do{if(e.id==a.id){return}}while(e=e.parentNode);a.toggleMenu()};this.toggleMenu=function(){if(a.menuElem.style.display=="none"){if(c){c()}a.menuElem.style.display="";$(a.id).getParent().addClass("selected");if(document.addEventListener){document.addEventListener("mousedown",a.clickAwayMenu,false)}else{if(document.attachEvent){document.attachEvent("onmousedown",a.clickAwayMenu)}}}else{a.menuElem.style.display="none";$(a.id).getParent().removeClass("selected");if(document.removeEventListener){document.removeEventListener("mousedown",a.clickAwayMenu,false)}else{if(document.detachEvent){document.detachEvent("onmousedown",a.clickAwayMenu)}}}};this.getVal=function(){return $(this.id+"_input").value};this.init()};EOL.dashboard.select.prototype.change=function(a){this.changeVal(a)};EOL.dashboard.select.prototype.getValue=function(){return this.getVal()};EOL.namespace("dashboard.header");EOL.dashboard.header.acDialog=null;EOL.dashboard.header.addContractor=function(){EOL.dashboard.header.acDialog=new EOL.dialog($("mp-acDialog"),{width:546});EOL.dashboard.header.acDialog.show()};
EOL.namespace("folders");EOL.folders.dialog=null;EOL.folders.create=function(){var a="/sf/folders/dialog/create";var b=new Request({url:a,method:"GET",onSuccess:function(c){EOL.folders.dialog=new EOL.dialog(c,{position:"fixed",modal:true,width:300,close:true});EOL.folders.dialog.show();$("dialogFolderName").focus()}}).send()};EOL.folders.doCreate=function(){var b=$("dialogFolderName").value;var a="/sf/folders/actions/create";var c=new Request({url:a,data:"name="+encodeURIComponent(b),method:"POST",onSuccess:function(d){var d=JSON.decode(d);if(d.error){var e=document.getElement(".folder-create .errorBox-small");e.getElement("li").set("html",d.error);e.show();return}EOL.folders.dialog.hide();if($("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}if($("newFolderTooltip")){EOL.myjobs.results.callback=function(){EOL.utility.showToolTip("newFolderTooltip","projectCard"+d.folderid,-175,0);EOL.dashboard.tooltip.markSeen("newFolderTooltip");EOL.myjobs.header.loadFolders()}}EOL.myjobs.results.reload()}}).send()};EOL.folders.rename=function(c){var a="/sf/folders/dialog/rename?folderId="+c;var b=new Request({url:a,method:"GET",onSuccess:function(d){EOL.folders.dialog=new EOL.dialog(d,{position:"fixed",modal:true,width:300,close:true});EOL.folders.dialog.show();$("dialogFolderName").focus()}}).send()};EOL.folders.doRename=function(d){var b=$("dialogFolderName").value;var a="/sf/folders/actions/rename";var c=new Request({url:a,data:"name="+encodeURIComponent(b)+"&folderId="+encodeURIComponent(d),method:"POST",onSuccess:function(e){var e=JSON.decode(e);if(e.error){var f=document.getElement(".folder-create .errorBox-small");f.getElement("li").set("html",e.error);f.show();return}EOL.folders.dialog.hide();if($("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}EOL.myjobs.results.reload()}}).send()};EOL.folders.move=function(a,e,f){EOL.myjobs.actions.resetErrors();if(!a&&!e&&!f){var b=false;$$("#myjobs-results .dashboard-card .checkbox.checked").each(function(h){while(!h.hasClass("dashboard-card")){h=h.getParent()}var g=h.get("projecttype");if(g=="job"||g=="bid"){b=true}});if(!b){EOL.myjobs.actions.displayError("Folders can't be moved into another folder. Select specific jobs you want to move to folders.");return}$el("send","useraction","CLICK","bulkMoveToFolder",{userId:getCookie("userid"),pageName:"MyJobs"});a="";e="";f=(EOL.myjobs.results.curFolder)?EOL.myjobs.results.curFolder:0}var c="/sf/folders/dialog/move?projectid="+a+"&projecttype="+e+"&currentFolderId="+f;var d=new Request({url:c,method:"GET",onSuccess:function(g){EOL.folders.dialog=new EOL.dialog(g,{position:"fixed",modal:true,width:300,close:true});EOL.folders.dialog.show()}}).send()};EOL.folders.doMove=function(g,b,j,l,e,k){var a="/sf/folders/actions/move";var c=new Array();if(!g&&!b){var h=(k)?k:"";var f=(e)?e:"";$$("#myjobs-results .dashboard-card .checkbox.checked").each(function(m){while(!m.hasClass("dashboard-card")){m=m.getParent()}if(m.get("projecttype")=="job"){if(f){f+=","}f+=m.get("projectid")}else{if(m.get("projecttype")=="bid"){if(h){h+=","}h+=m.get("projectid")}}});var d="jobids="+f+"&bidids="+h+"&currentFolderId="+j}else{var d="projectid="+g+"&projecttype="+b+"&currentFolderId="+j}if(typeof l==="undefined"){l=EOL.folders.list.getSelected("dialog-list")}d+="&folderid="+l;if(EOL.folders.dialog){EOL.folders.dialog.hide()}$$(".folderMessage").each(function(m){m.destroy()});window.scrollTo(0,0);$("myjobs-loader").show();$("myjobs-results").empty();EOL.myjobs.panel.close();var i=new Request({url:a,data:d,method:"POST",onSuccess:function(m){EOL.myjobs.results.reload();m=JSON.decode(m);if(m.error){var q=m.error;var o=null}else{var q=m.text;var o=new Element("a",{href:"javascript:EOL.folders.doMove('"+g+"','"+b+"',"+l+","+j+",'"+f+"','"+h+"')",html:"Undo",style:"font-weight: bold; margin-left: 10px;"});if($("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}}var p=new Element("div",{"class":"folderMessage",html:q});p.set("opacity",0);if(o){o.inject(p)}p.inject($("dashboard-header"));if(!$("folderMessage-c")){var n=new Element("div",{id:"folder-Message-c",style:"position:relative;"});n.inject($("dashboard-header"))}p.inject($("folder-Message-c"));new Fx.Tween(p,{duration:500,link:"chain",transition:Fx.Transitions.Expo.easeOut}).start("opacity",1).wait(10000).start("display","none")}}).send()};EOL.folders.openFolder=function(c){var a="/sf/folders/open?folderid="+c;var b=new Request({url:a,method:"GET",onSuccess:function(d){}}).send()};EOL.namespace("folders.list");EOL.folders.list.select=function(a,b){disableElems($("folderMoveActions"),true);var a=$(a);$(b).getElements(".folder-list-item").each(function(c){if(c.get("folderid")==a.get("folderid")){c.addClass("selected")}else{c.removeClass("selected")}})};EOL.folders.list.getSelected=function(a){var b="";$(a).getElements(".folder-list-item").each(function(c){if(c.hasClass("selected")){b=c.get("folderid")}});return b};EOL.folders.folderHelpDialog=null;EOL.folders.showHelp=function(a){EOL.folders.folderHelpDialog=new EOL.dialog($(a),{position:"fixed",modal:true,width:875,close:true,className:"folder-tour"});EOL.folders.folderHelpDialog.show()};EOL.folders.closeTooltip=function(a){if(a=="foldersIntroTip"){$("foldersIntroTip").hide();EOL.dashboard.tooltip.markSeen("foldersIntroTip")}else{if(a=="newFolderTooltip"){EOL.utility.hideToolTip("newFolderTooltip");$("newFolderTooltip").destroy()}}};EOL.namespace("folders.drag");EOL.folders.drag.dragSrcEl=null;EOL.folders.drag.start=function(a){$(this).setStyle("opacity","0.6");EOL.folders.drag.dragSrcEl=this;a.dataTransfer.effectAllowed="move";var b=$(this).get("id").toString();a.dataTransfer.setData("Text",b)};EOL.folders.drag.end=function(a){$(this).setStyle("opacity","1")};EOL.folders.drag.drop=function(f){if(f.dataTransfer.getData("Text").indexOf("projectCard")!=0){return}if(f.stopPropagation){f.stopPropagation()}if(f.preventDefault){f.preventDefault()}$(this).removeClass("dragOver");var b=$(f.dataTransfer.getData("Text"));var a=(EOL.myjobs.results.curFolder)?EOL.myjobs.results.curFolder:0;var d=$(this).get("projectid");if(b.getElements(".checkbox.checked").length){var c=$$("#myjobs-results .dashboard-card .checkbox.checked").getParent().getParent();c.erase(this);if(c.length){EOL.folders.doMove("","",a,d)}}else{EOL.folders.doMove(b.get("projectid"),b.get("projecttype"),a,d)}};EOL.folders.drag.over=function(a){if(a.preventDefault){a.preventDefault()}if(a.dataTransfer.getData("Text").indexOf("projectCard")!=0){return}a.dataTransfer.dropEffect="move";return false};EOL.folders.drag.curTarget=null;EOL.folders.drag.enter=function(a){if(a.dataTransfer.getData("Text").indexOf("projectCard")!=0){return}$(this).addClass("dragOver")};EOL.folders.drag.leave=function(f){if(f.dataTransfer.getData("Text").indexOf("projectCard")!=0){return}var d=$(this);if(!d.hasClass("folder")){while(d&&(!$(d).hasClass("folder"))){d=d.getParent()}}if(!d||!$(d).hasClass("folder")){$(this).removeClass("dragOver");return}var c=d.getBoundingClientRect();var a=(f.clientY)?f.clientY:f.y;var b=(f.clientX)?f.clientX:f.x;if(b>(c.left+c.width-2)||b<(c.left+2)||a>(c.top+c.height-2)||a<(c.top+2)){$(this).removeClass("dragOver")}};EOL.folders.drag.menuEnter=function(a){if(!$("foldersHeaderMenu").isDisplayed()){EOL.myjobs.header.toggleFolders()}};
EOL.namespace("bulkPayment");EOL.bulkPayment.dialog=null;EOL.bulkPayment.initiating=false;EOL.bulkPayment.init=function(){if(EOL.bulkPayment.initiating){return}EOL.bulkPayment.initiating=true;if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}var a="/sf/bulkPayment/dialog/init";var b=new Request({url:a,method:"GET",onSuccess:function(c){EOL.bulkPayment.dialog=new EOL.dialog(c,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show();var d=$("templateDownloadBtn");d.addEvent("click",function(){this.getSiblings(".btn-expandable-menu-wrapper")[0].toggleClass("displayNone")})},onComplete:function(){EOL.bulkPayment.initiating=false}}).send()};EOL.bulkPayment.download=function(){var a=$("bulkPaymentOnlyWorking").get("checked");EOL.bulkPayment.showEdit("misc",a)};EOL.bulkPayment.downloadUnpaidInvoices=function(){EOL.bulkPayment.showEdit("invoices",false)};EOL.bulkPayment._redirectedToDownload=false;EOL.bulkPayment._redirectToDownload=function(a){if(EOL.bulkPayment._redirectedToDownload){return false}EOL.bulkPayment._redirectedToDownload=true;window.setTimeout(function(){EOL.bulkPayment._redirectedToDownload=false},3000);onlyWorkingY=a?"Y":"";window.location.href="/php/transactions/main/downloadBulkPayments.php?onlyWorkingY="+onlyWorkingY;return true};EOL.bulkPayment.showEdit=function(a,d){a=typeof a!=="undefined"?a:false;if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}var b="/sf/bulkPayment/dialog/showEdit";var c=new Request({url:b,method:"GET",onSuccess:function(e){EOL.bulkPayment.dialog=new EOL.dialog(e,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show();if(a=="misc"){$("bp_edit_img_01").addEvent("load",function(){EOL.bulkPayment._redirectToDownload(d)});window.setTimeout(function(){EOL.bulkPayment._redirectToDownload(d)},3000)}else{if(a=="invoices"){window.setTimeout(function(){window.location="/php/invoice/main/downloadInvoices.php?type=csv&context=buyer&filterType=unpaidAll&template=true"},1000)}}}}).send()};EOL.bulkPayment.showUpload=function(){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}var a="/sf/bulkPayment/dialog/showUpload";var b=new Request({url:a,method:"GET",onSuccess:function(c){EOL.bulkPayment.dialog=new EOL.dialog(c,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show();EOL.bulkPayment.bindUploadIFrameLoadEvent()}}).send()};EOL.bulkPayment.userFileSelected=function(){if($("bulkPaymentUploadBtnEnabled").hasClass("displayNone")){$("bulkPaymentUploadBtnEnabled").removeClass("displayNone");$("bulkPaymentUploadBtnDisabled").removeClass("displayNone").addClass("displayNone")}};EOL.bulkPayment.skipForNow=function(){var a="/sf/bulkPayment/subscribeToWidget";var b=new Request({url:a,method:"POST",onSuccess:function(c){},onFailure:function(){}}).send();EOL.bulkPayment.dialog.hide()};EOL.bulkPayment.backToInit=function(){EOL.bulkPayment.dialog.hide();EOL.bulkPayment.init()};EOL.bulkPayment.uploadingFile=false;EOL.bulkPayment.parseFile=function(){$("bulkPaymentError1").removeClass("displayNone").addClass("displayNone");$("bulkPaymentError2").removeClass("displayNone").addClass("displayNone");$("bulkPaymentUpload").addClass("displayNone");$("bulkPaymentUploading").removeClass("displayNone");$("bulkPaymentSkipBtnEnabled").addClass("displayNone");$("bulkPaymentSkipBtnDisabled").removeClass("displayNone");$("bulkPaymentBackBtnEnabled").addClass("displayNone");$("bulkPaymentBackBtnDisabled").removeClass("displayNone");$("bulkPaymentUploadBtnEnabled").addClass("displayNone");$("bulkPaymentUploadBtnDisabled").removeClass("displayNone");EOL.bulkPayment.uploadingFile=true;$("bulkPaymentUploadForm").submit()};EOL.bulkPayment.bindUploadIFrameLoadEvent=function(){$("bulkPaymentUploadTarget").addEvent("load",function(){if(!EOL.bulkPayment.uploadingFile){return}EOL.bulkPayment.uploadingFile=false;try{var a=JSON.decode($("bulkPaymentUploadTarget").contentWindow.document.body.innerHTML);if(a){if(a.status=="success"&&a.data){EOL.bulkPayment.showConfirm(a.data.batchId)}else{if(a.status=="error"){$("bulkPaymentError1").removeClass("displayNone");$("bulkPaymentErrorMsg").set("text",a.message?a.message:"");$("bulkPaymentUpload").removeClass("displayNone");$("bulkPaymentUploading").addClass("displayNone");$("bulkPaymentSkipBtnEnabled").removeClass("displayNone");$("bulkPaymentSkipBtnDisabled").addClass("displayNone");$("bulkPaymentBackBtnEnabled").removeClass("displayNone");$("bulkPaymentBackBtnDisabled").addClass("displayNone");$("bulkPaymentUploadBtnEnabled").removeClass("displayNone");$("bulkPaymentUploadBtnDisabled").removeClass("displayNone").addClass("displayNone")}else{throw"unknown response status"}}}else{throw"empty response"}}catch(b){$("bulkPaymentError2").removeClass("displayNone");$("bulkPaymentUpload").removeClass("displayNone");$("bulkPaymentUploading").addClass("displayNone");$("bulkPaymentSkipBtnEnabled").removeClass("displayNone");$("bulkPaymentSkipBtnDisabled").addClass("displayNone");$("bulkPaymentBackBtnEnabled").removeClass("displayNone");$("bulkPaymentBackBtnDisabled").addClass("displayNone")}})};EOL.bulkPayment.cancelPay=function(a){var b="/sf/bulkPayment/cancelPay";var c=new Request({url:b,method:"POST",data:{batchId:a},onSuccess:function(d){},onFailure:function(){}}).send();EOL.bulkPayment.dialog.hide()};EOL.bulkPayment.backToUpload=function(a){EOL.bulkPayment.cancelPay(a);EOL.bulkPayment.showUpload()};EOL.bulkPayment.showConfirm=function(a){var b="/sf/bulkPayment/dialog/showConfirm?batchId="+a;var c=new Request({url:b,method:"GET",onSuccess:function(d){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}EOL.bulkPayment.dialog=new EOL.dialog(d,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show()},onFailure:function(){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}alert("There was an error processing your request. Please refresh and try again.")}}).send()};EOL.bulkPayment.payNow=function(a){var b="/sf/bulkPayment/payNow";var c=new Request({url:b,method:"POST",data:{batchId:a},onSuccess:function(d){EOL.bulkPayment.successUpload()},onFailure:function(){EOL.bulkPayment.failedUpload()}}).send();if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}};EOL.bulkPayment.successUpload=function(){var a="/sf/bulkPayment/dialog/successUpload";var b=new Request({url:a,method:"GET",onSuccess:function(c){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}EOL.bulkPayment.dialog=new EOL.dialog(c,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show()}}).send()};EOL.bulkPayment.failedUpload=function(){var a="/sf/bulkPayment/dialog/failedUpload";var b=new Request({url:a,method:"GET",onSuccess:function(c){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}EOL.bulkPayment.dialog=new EOL.dialog(c,{position:"fixed",modal:true,width:600,close:true,className:"eol-popup-dialog"});EOL.bulkPayment.dialog.show()}}).send()};EOL.bulkPayment.close=function(){if(EOL.bulkPayment.dialog){EOL.bulkPayment.dialog.hide()}};
window.Modernizr=function(Z,Y,X){function F(b){R.cssText=b}function E(d,c){return F(prefixes.join(d+";")+(c||""))}function D(d,c){return typeof d===c}function C(d,c){return !!~(""+d).indexOf(c)}function B(g,c,j){for(var i in g){var h=c[g[i]];if(h!==X){return j===!1?g[i]:D(h,"function")?h.bind(j||c):h}}return !1}var W="2.6.1",V={},U=Y.documentElement,T="modernizr",S=Y.createElement(T),R=S.style,Q,P={}.toString,O={},N={},M={},L=[],K=L.slice,J,I=function(){function c(h,g){g=g||Y.createElement(b[h]||"div"),h="on"+h;var a=h in g;return a||(g.setAttribute||(g=Y.createElement("div")),g.setAttribute&&g.removeAttribute&&(g.setAttribute(h,""),a=D(g[h],"function"),D(g[h],"undefined")||(g[h]=X),g.removeAttribute(h))),g=null,a}var b={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return c}(),H={}.hasOwnProperty,G;!D(H,"undefined")&&!D(H.call,"undefined")?G=function(d,c){return H.call(d,c)}:G=function(d,c){return c in d&&D(d.constructor.prototype[c],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(a){var h=this;if(typeof h!="function"){throw new TypeError}var g=K.call(arguments,1),f=function(){if(this instanceof f){var b=function(){};b.prototype=h.prototype;var d=new b,c=h.apply(d,g.concat(K.call(arguments)));return Object(c)===c?c:d}return h.apply(a,g.concat(K.call(arguments)))};return f}),O.draganddrop=function(){var b=Y.createElement("div");return"draggable" in b||"ondragstart" in b&&"ondrop" in b};for(var A in O){G(O,A)&&(J=A.toLowerCase(),V[J]=O[A](),L.push((V[J]?"":"no-")+J))}return V.addTest=function(e,c){if(typeof e=="object"){for(var f in e){G(e,f)&&V.addTest(f,e[f])}}else{e=e.toLowerCase();if(V[e]!==X){return V}c=typeof c=="function"?c():c,enableClasses&&(U.className+=" "+(c?"":"no-")+e),V[e]=c}return V},F(""),S=Q=null,V._version=W,V.hasEvent=I,V}(this,this.document);